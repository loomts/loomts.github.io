<?xml version="1.0" encoding="utf-8"?><rss xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title>loomt</title><link>https://loomt.top/</link><description>ËÆ∞ÂΩïÁîüÊ¥ª‰∏écoding</description><generator>Hugo 0.92.2 https://gohugo.io/</generator><language>zh-CN</language><managingEditor>loomt_@outlook.com (loomt)</managingEditor><webMaster>loomt_@outlook.com (loomt)</webMaster><copyright>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh)</copyright><lastBuildDate>Fri, 23 Jun 2023 09:40:51 +0000</lastBuildDate><atom:link rel="self" type="application/rss+xml" href="https://loomt.top/rss.xml"/><item><title>Redis Cluster ÂÖ¨ÁΩëÈÉ®ÁΩ≤</title><link>https://loomt.top/posts/redis-cluster%E5%85%AC%E7%BD%91%E9%83%A8%E7%BD%B2/</link><guid isPermaLink="true">https://loomt.top/posts/redis-cluster%E5%85%AC%E7%BD%91%E9%83%A8%E7%BD%B2/</guid><pubDate>Wed, 10 May 2023 19:52:12 +0800</pubDate><author>loomt_@outlook.com (loomt)</author><copyright>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh)</copyright><description>&lt;p>RTÔºåÂ¶ÇÊûúË¶ÅÂÖ¨ÁΩëËÆøÈóÆÊúçÂä°Âô®ÁöÑ RedisÔºåË¶ÅÂ∞Ü redis-cluster ÈÉ®ÁΩ≤Âú®ÂÖ¨ÁΩë‰∏äÔºà‰ºº‰πéÊòØÂ∫üËØùÔºå‰ΩÜÊòØÂ¶ÇÊûú Redis ÊúçÂä°ÂèëÁé∞Á´ØÂè£ÊòØÊú¨Âú∞ÁöÑËØùÔºåÂ∞±Ê≤°Ê≥ïÂÖ¨ÁΩëËÆøÈóÆÔºâ„ÄÇ&lt;/p>
&lt;p>config ‰∏≠ÊúâÂá†‰∏™ÂæàÈáçË¶ÅÁöÑÂèÇÊï∞Ôºö&lt;/p>
&lt;pre tabindex="0">&lt;code># redis-cluster.conf
cluster-announce-ip 116.205.130.21 # ÂÖ¨ÁΩëip
cluster-announce-port 8003 # redis service Êö¥Èú≤ÁªôÂ§ñÈÉ®ÁöÑÁ´ØÂè£
cluster-announce-bus-port 18003 # redis ÈõÜÁæ§ÊÄªÁ∫øÁ´ØÂè£
&lt;/code>&lt;/pre>&lt;p>ÂÖ∂‰ªñÂ∞±‰∏çËØ¥‰∫ÜÔºå‰∏ªË¶ÅÊòØÊÄªÁ∫øÁ´ØÂè£ÔºåÂÆÉÊòØ cluster ÊúçÂä°ÂèëÁé∞ÁöÑÁ´ØÂè£ÔºåÂ¶ÇÊûúÂ°´ÁöÑÊòØÂ±ÄÂüüÁΩë ipÔºà192.168.xxx.xxxÔºâÈÇ£‰πàÂ∞±Êó†Ê≥ïË¢´Â§ñÈÉ®ËÆøÈóÆÔºåÂõ†‰∏∫Âú® Redis ÂØπ key ËøõË°å hash ÁöÑÊó∂ÂÄôÔºåÂ¶ÇÊûúÂ§ÑÁêÜ key ÂàÜÁâá‰∏çÊòØÊú¨ Redis ÊúçÂä°Âô®ÁöÑËØùÔºå‰ºöÊèêÁ§∫&lt;code>Redirected to slot [5798] located at 192.168.xxx.xxx:$xxx&lt;/code>ÔºàÈáçÂÆöÂêëÂà∞ÂÖ∂‰ªñ Redis ÊúçÂä°Âô®ÔºâÔºåÊó†Ê≥ïË¢´ÂÖ¨ÁΩëËÆøÈóÆ„ÄÇ
ÊâÄ‰ª•Ë¶ÅÂ∞Ü cluster ÊúçÂä°ÂèëÁé∞ÁöÑ ip ËÆæ‰∏∫ÂÖ¨ÁΩë ipÔºåËøòË¶ÅËÆ∞ÂæóÂú®ÊúçÂä°Âô®‰∏äÊö¥Èú≤ÊúçÂä° ip ÂíåÊúçÂä°ÂèëÁé∞ ip ‰ª•ÂèäÂÖ≥Èó≠ÂØπÂ∫îÁöÑÈò≤ÁÅ´Â¢ô„ÄÇ&lt;/p>
&lt;pre tabindex="0">&lt;code class="language-conf" data-lang="conf"># 8000/redis-cluster.conf
protected-mode no
port 8000
tcp-backlog 511
timeout 0
tcp-keepalive 300
daemonize no
supervised no
pidfile /var/run/redis_8000.pid
loglevel notice
logfile &amp;quot;&amp;quot;
databases 16
always-show-logo yes
save 900 1
save 300 10
save 60 10000
stop-writes-on-bgsave-error yes
rdbcompression yes
rdbchecksum yes
dbfilename dump8000.rdb
rdb-del-sync-files no
dir ./
replica-serve-stale-data yes
replica-read-only yes
repl-diskless-sync no
repl-diskless-sync-delay 5
repl-diskless-load disabled
repl-disable-tcp-nodelay no
replica-priority 100
acllog-max-len 128
lazyfree-lazy-eviction no
lazyfree-lazy-expire no
lazyfree-lazy-server-del no
replica-lazy-flush no
lazyfree-lazy-user-del no
appendonly yes
appendfilename &amp;quot;appendonly8000.aof&amp;quot;
appendfsync everysec
no-appendfsync-on-rewrite no
auto-aof-rewrite-percentage 100
auto-aof-rewrite-min-size 64mb
aof-load-truncated yes
aof-use-rdb-preamble yes
lua-time-limit 5000
cluster-enabled yes
cluster-config-file nodes-8000.conf
cluster-node-timeout 15000
cluster-announce-ip 116.205.130.21
cluster-announce-port 8000
cluster-announce-bus-port 18000
slowlog-log-slower-than 10000
slowlog-max-len 128
latency-monitor-threshold 0
notify-keyspace-events &amp;quot;&amp;quot;
hash-max-ziplist-entries 512
hash-max-ziplist-value 64
list-max-ziplist-size -2
list-compress-depth 0
set-max-intset-entries 512
zset-max-ziplist-entries 128
zset-max-ziplist-value 64
hll-sparse-max-bytes 3000
stream-node-max-bytes 4096
stream-node-max-entries 100
activerehashing yes
client-output-buffer-limit normal 0 0 0
client-output-buffer-limit replica 256mb 64mb 60
client-output-buffer-limit pubsub 32mb 8mb 60
hz 10
dynamic-hz yes
aof-rewrite-incremental-fsync yes
rdb-save-incremental-fsync yes
jemalloc-bg-thread yes
&lt;/code>&lt;/pre>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;span class="lnt">44
&lt;/span>&lt;span class="lnt">45
&lt;/span>&lt;span class="lnt">46
&lt;/span>&lt;span class="lnt">47
&lt;/span>&lt;span class="lnt">48
&lt;/span>&lt;span class="lnt">49
&lt;/span>&lt;span class="lnt">50
&lt;/span>&lt;span class="lnt">51
&lt;/span>&lt;span class="lnt">52
&lt;/span>&lt;span class="lnt">53
&lt;/span>&lt;span class="lnt">54
&lt;/span>&lt;span class="lnt">55
&lt;/span>&lt;span class="lnt">56
&lt;/span>&lt;span class="lnt">57
&lt;/span>&lt;span class="lnt">58
&lt;/span>&lt;span class="lnt">59
&lt;/span>&lt;span class="lnt">60
&lt;/span>&lt;span class="lnt">61
&lt;/span>&lt;span class="lnt">62
&lt;/span>&lt;span class="lnt">63
&lt;/span>&lt;span class="lnt">64
&lt;/span>&lt;span class="lnt">65
&lt;/span>&lt;span class="lnt">66
&lt;/span>&lt;span class="lnt">67
&lt;/span>&lt;span class="lnt">68
&lt;/span>&lt;span class="lnt">69
&lt;/span>&lt;span class="lnt">70
&lt;/span>&lt;span class="lnt">71
&lt;/span>&lt;span class="lnt">72
&lt;/span>&lt;span class="lnt">73
&lt;/span>&lt;span class="lnt">74
&lt;/span>&lt;span class="lnt">75
&lt;/span>&lt;span class="lnt">76
&lt;/span>&lt;span class="lnt">77
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yml" data-lang="yml">&lt;span class="nt">version&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s1">&amp;#39;3.3&amp;#39;&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">&lt;/span>&lt;span class="nt">services&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">redis-cluster&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">image&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">redis:latest&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">command&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">redis-cli --cluster create 116.205.130.21:8000 116.205.130.21:8001 116.205.130.21:8002 116.205.130.21:8003 116.205.130.21:8004 116.205.130.21:8005 --cluster-replicas 1 --cluster-yes&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">depends_on&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="l">redis-8000&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="l">redis-8001&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="l">redis-8002&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="l">redis-8003&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="l">redis-8004&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="l">redis-8005&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">redis-8000&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c"># ÊúçÂä°ÂêçÁß∞&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">image&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">redis:latest&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c"># ÂàõÂª∫ÂÆπÂô®Êó∂ÊâÄÈúÄÁöÑÈïúÂÉè&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">container_name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">redis-8000&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c"># ÂÆπÂô®ÂêçÁß∞&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">ports&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="m">8000&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="m">8000&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="m">18000&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="m">18000&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">volumes&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c"># Êï∞ÊçÆÂç∑ÔºåÁõÆÂΩïÊåÇËΩΩ&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="l">./8000/redis-cluster.conf:/usr/local/etc/redis/redis.conf&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="l">./8000/data:/data&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">command&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">redis-server /usr/local/etc/redis/redis.conf&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c"># Ë¶ÜÁõñÂÆπÂô®ÂêØÂä®ÂêéÈªòËÆ§ÊâßË°åÁöÑÂëΩ‰ª§&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">redis-8001&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">image&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">redis:latest&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">container_name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">redis-8001&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">ports&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="m">8001&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="m">8001&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="m">18001&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="m">18001&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">volumes&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="l">./8001/redis-cluster.conf:/usr/local/etc/redis/redis.conf&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="l">./8001/data:/data&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">command&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">redis-server /usr/local/etc/redis/redis.conf&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">redis-8002&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">image&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">redis:latest&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">container_name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">redis-8002&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">ports&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="m">8002&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="m">8002&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="m">18002&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="m">18002&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">volumes&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="l">./8002/redis-cluster.conf:/usr/local/etc/redis/redis.conf&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="l">./8002/data:/data&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">command&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">redis-server /usr/local/etc/redis/redis.conf&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">redis-8003&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">image&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">redis:latest&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">container_name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">redis-8003&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">ports&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="m">8003&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="m">8003&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="m">18003&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="m">18003&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">volumes&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="l">./8003/redis-cluster.conf:/usr/local/etc/redis/redis.conf&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="l">./8003/data:/data&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">command&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">redis-server /usr/local/etc/redis/redis.conf&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">redis-8004&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">image&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">redis:latest&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">container_name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">redis-8004&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">ports&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="m">8004&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="m">8004&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="m">18004&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="m">18004&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">volumes&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="l">./8004/redis-cluster.conf:/usr/local/etc/redis/redis.conf&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="l">./8004/data:/data&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">command&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">redis-server /usr/local/etc/redis/redis.conf&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">redis-8005&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">image&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">redis:latest&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">container_name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">redis-8005&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">ports&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="m">8005&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="m">8005&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="m">18005&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="m">18005&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">volumes&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="l">./8005/redis-cluster.conf:/usr/local/etc/redis/redis.conf&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="l">./8005/data:/data&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">command&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">redis-server /usr/local/etc/redis/redis.conf&lt;/span>&lt;span class="w">
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description><category domain="https://loomt.top/posts/">posts</category></item><item><title>6.824 Lab4</title><link>https://loomt.top/posts/6.824-lab4/</link><guid isPermaLink="true">https://loomt.top/posts/6.824-lab4/</guid><pubDate>Thu, 09 Mar 2023 02:02:35 +0800</pubDate><author>loomt_@outlook.com (loomt)</author><copyright>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh)</copyright><description>&lt;blockquote>
&lt;p>Áª∑‰∏ç‰Ωè‰∫ÜÔºåÂú®ÂÜô lab4B ÁöÑÊó∂ÂÄôÔºåÊàë commit ‰∫Ü shardKVÔºà4BÔºâÁöÑÊñá‰ª∂Ôºå‰ΩÜÂÜôÂ•ΩÁöÑ shardctrlerÔºà4AÔºâÊ≤°Êúâ commitÔºåÁÑ∂ÂêéÊàë reset-hard ‰∫ÜÊï¥‰∏™È°πÁõÆÔºåÂÜôÂÆåÁöÑ shardctrler Â∞±‰∏çËßÅ‰∫ÜÔºå-2hüò≠&lt;/p>
&lt;/blockquote>
&lt;h1 id="task">Task&lt;/h1>
&lt;p>ÂÆåÊàê Multi-Raft&lt;/p>
&lt;ul>
&lt;li>
&lt;p>lab4AÔºöÂÆåÊàê Multi-Raft ÊéßÂà∂‰∏≠ÂøÉÔºàÂíå lab3 ÂÜÖÂÆπÂ∑Æ‰∏çÂ§öÔºå‰∏ÄÂè•ËØùÂ∞±ÊòØ shardctrler ÊòØ‰∏Ä‰∏™Â∞Ü Config ‰Ωú‰∏∫Êó•ÂøóËøõË°åÁª¥Êä§ÁöÑÂçï Raft ÈõÜÁæ§ÔºåÂπ∂‰∏î‰∏çÈúÄË¶ÅÂÆûÁé∞Âø´ÁÖßÂíåÊåÅ‰πÖÂåñÔºâ
ÈúÄË¶ÅÊ≥®ÊÑèÁöÑÂú∞ÊñπÊòØ Join Âíå Leave Êìç‰Ωú shards Â∫îËØ•ÊÄé‰πàÂπ≥Âùá‰∏îÊúâÂ∫èÂú∞ÂàÜÈÖçÁªô gidsÔºàÊ≥®ÊÑèÂú® Leave Êìç‰Ωú‰∏≠ÔºåGroup ÈáåÈù¢ÂèØËÉΩÊúâÂ§ö‰ΩôÁöÑ gidÔºåÊ≠§Êó∂ÈúÄË¶ÅÊ≥®ÊÑèÂ∞ÜÂÖ∂ÁÆóÂú® gids ÈáåÈù¢ÔºâÔºå‰∏ªË¶ÅÈÄªËæëÂíå lab3 Â∑Æ‰∏çÂ§öÔºåÊØîËæÉÁÆÄÂçï„ÄÇ&lt;/p>
&lt;/li>
&lt;li>
&lt;p>lab4BÔºöÂÆûÁé∞‰∏Ä‰∏™Êã•ÊúâÂàÜÁâáÂäüËÉΩÔºåËÉΩÂ§üÈöèÊó∂Âä†ÂÖ•ÈÄÄÂá∫ÊàêÂëòÔºåÂèØ‰ª•Ê†πÊçÆÈÖçÁΩÆÂêåÊ≠•ËøÅÁßªÊï∞ÊçÆÔºåÊîØÊåÅÊñ≠Á∫øÈáçËøûÊó•ÂøóÂø´ÈÄüËøΩËµ∂ÂíåÂø´ÁÖßÂäüËÉΩÂπ∂‰∏îËÉΩÂ§ü‰øùËØÅÁ∫øÊÄß‰∏ÄËá¥ÊÄßÁöÑ kv Êï∞ÊçÆÂ∫ì„ÄÇ
ËôΩÁÑ∂Âè†‰∫ÜÂæàÂ§ö buffÔºå‰ΩÜÂæàÂ§öÂú∞ÊñπÊàë‰ª¨‰πãÂâçÂ∑≤ÁªèÂÆûÁé∞‰∫ÜÔºåÊØîÂ¶ÇÂä†ÂÖ•ÈÄÄÂá∫ÊàêÂëòÂíåÊó•ÂøóÂêåÊ≠•Âú® lab4AÔºõÊñ≠Á∫øÈáçËøûÂíåÊó•ÂøóÂø´ÈÄüËøΩËµ∂Âú® lab2ÔºõÁ∫øÊÄß‰∏ÄËá¥ÊÄßÁöÑ kv Êï∞ÊçÆÂ∫ìÂú® lab3„ÄÇ&lt;/p>
&lt;/li>
&lt;/ul>
&lt;p>ÊâÄ‰ª•Êàë‰ª¨Âú® lab4B ÁöÑ‰∏ªË¶Å‰ªªÂä°ÊòØÊ†πÊçÆÊúÄÊñ∞ÈÖçÁΩÆÊù•ÂÆûÁé∞ÂàÜÁâáÁöÑÂ§ÑÁêÜÔºåËøõË°åÂàÜÁâáÂ§ÑÁêÜÂíåÂõûÂ§çÂÆ¢Êà∑Á´ØÁöÑËØ∑Ê±ÇÈÉΩÈúÄË¶ÅÈÄöËøá Raft Â±ÇÂÆûÁé∞‰∏ÄËá¥ÊÄßÔºåÊâÄ‰ª•ÈÉΩË¶ÅË∞ÉÁî®&lt;code>kv.rf.Start()&lt;/code>Âπ∂ÂêØÂä®‰∏Ä‰∏™ go routine Â§ÑÁêÜ Raft Â±ÇÂõûË∞ÉÁöÑ applyCh„ÄÇ&lt;/p>
&lt;p>È¶ñÂÖàÊòØ shardÔºåÊàë‰ª¨ÈúÄË¶ÅÂ∞Ü Client ÁöÑ PUT„ÄÅGET„ÄÅAPPEND ËØ∑Ê±ÇÈÄöËøá key ÂÄºÁöÑ hash ÂàÜÈÖçÁªô‰∏çÂêåÁöÑ shardÔºåshard2gid Êï∞ÁªÑÂèØ‰ª•ÈÄöËøáËØªÂèñÈÖçÁΩÆËé∑Âèñ„ÄÇ‰∏∫‰∫ÜÈò≤Ê≠¢ÈáçÂ§ç applyÔºåÊàë‰ª¨Ë¶ÅÂú® shard ÁªìÊûÑÂä†‰∏äÂéªÈáçË°®„ÄÇÊâÄ‰ª•ÊàëÂÆûÁé∞ÁöÑ shard ÁªìÊûÑ‰ΩìÂ¶Ç‰∏ãÔºö&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="kd">type&lt;/span> &lt;span class="nx">Shard&lt;/span> &lt;span class="kd">struct&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">Log&lt;/span> &lt;span class="kd">map&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="kt">string&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="kt">string&lt;/span>
&lt;span class="nx">LastCommand&lt;/span> &lt;span class="kd">map&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="kt">int64&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="kt">int&lt;/span>
&lt;span class="nx">Status&lt;/span> &lt;span class="kt">int&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ËÄÉËôëÊõ¥Êñ∞ configÔºåleader ÈúÄË¶ÅÂè¶Ëµ∑‰∏Ä‰∏™ go routine ‰∏çÊñ≠ËØªÂèñÊñ∞ÈÖçÁΩÆÔºåÂú®Êõ¥Êñ∞ÈÖçÁΩÆ‰πãÂâçÊàë‰ª¨ÈúÄË¶ÅÂà§Êñ≠ÂΩìÂâç gid ÊòØÂê¶ÈúÄË¶Å pull Êàñ pushÔºàÂ≠ò‰∏ã lastcfgÔºåÁî®Êù•‰∏éÂΩìÂâç cfg ‰ΩúÊØîËæÉÔºâ„ÄÇ&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="kd">func&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">kv&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">ShardKV&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nf">allSentL&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="kt">bool&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">for&lt;/span> &lt;span class="nx">shard&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">gid&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="k">range&lt;/span> &lt;span class="nx">kv&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">lastcfg&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Shards&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="nx">gid&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="nx">kv&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">gid&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="nx">kv&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">cfg&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Shards&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">shard&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="nx">kv&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">gid&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="nx">kv&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">stateMachine&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">shard&lt;/span>&lt;span class="p">].&lt;/span>&lt;span class="nx">Status&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="nx">Serving&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="kc">false&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="kc">true&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="kd">func&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">kv&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">ShardKV&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nf">allReceivedL&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="kt">bool&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">for&lt;/span> &lt;span class="nx">shard&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">gid&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="k">range&lt;/span> &lt;span class="nx">kv&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">lastcfg&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Shards&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="nx">gid&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="nx">kv&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">gid&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="nx">kv&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">cfg&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Shards&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">shard&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="nx">kv&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">gid&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="nx">kv&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">stateMachine&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">shard&lt;/span>&lt;span class="p">].&lt;/span>&lt;span class="nx">Status&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="nx">Serving&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="kc">false&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="kc">true&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Ëã•ÈúÄË¶ÅÔºåÂàôÁ≠âÂæÖ&lt;strong>Áõ∏ÂÖ≥ shards&lt;/strong>Â§ÑÁêÜÂÆåÊØïÂÜçÊü•ËØ¢Êñ∞‰∏Ä‰∏™ configÔºàÂõ†‰∏∫Ê≠•Â≠ê‰∏çËÉΩËøàÂæóÂ§™Â§ßÔºåÈúÄË¶Å‰∏Ä‰∏™‰∏™ config Âú∞ËøõË°åÁä∂ÊÄÅÊú∫ÁöÑÊõ¥Êñ∞ÔºåÂéüÂõ†‰πã‰∏ÄÊòØÊõ¥Êñ∞ËøáÁ®ã‰ºöÊ∂âÂèäÂà∞ shard ÁöÑÂàáÊç¢Ôºâ„ÄÇ&lt;/p>
&lt;p>Ëã•Êúâ‰∏Ä‰∏™ gid ÈúÄË¶Å pushÔºåÂàôÂè¶‰∏Ä‰∏™Â∞±ÂøÖÁÑ∂ÈúÄË¶Å pull„ÄÇÊó†ËÆ∫ÊòØÁî® push ËøòÊòØÁî® pull Â§ÑÁêÜÈÉΩÊòØÂèØ‰ª•ÁöÑ„ÄÇËÄÉËôëÂà∞ Challenge ‰ªªÂä°ÈúÄË¶ÅÂú® push ‰πãÂêéÂà†Èô§Â∫üÂºÉ shard ÈáäÊîæÂÜÖÂ≠ò„ÄÇpush Ëá≥Â∞ëÊØî pull Â∞ë‰∏Ä‰∏™ RPC ËØ∑Ê±ÇÔºåÊâÄ‰ª•ÊàëÈÄâÊã©‰∫Ü push„ÄÇ&lt;/p>
&lt;p>push ‰∏ªË¶ÅÊòØÈúÄË¶ÅÂèëÈÄÅ RPC ÁªôÂØπÂ∫î status ‰∏∫ pulling ÁöÑ shardÔºåÂπ∂Á≠âÂæÖ receiver Êé•ÂèóÂπ∂ apply ÂõûÂ§ç OK ÂêéËøõË°å delete„ÄÇ&lt;/p>
&lt;p>ËøòË¶ÅËÆ∞ÂæóÂú®‰∏Ä‰∏™ËäÇÁÇπÂàöÊàê‰∏∫ leader ÁöÑÊó∂ÂÄôÂèëÈÄÅÁ©∫Êó•Âøó‰ª• apply ÊóßÁöÑÊó•Âøó„ÄÇ&lt;/p>
&lt;h2 id="tips">tipsÔºö&lt;/h2>
&lt;ol>
&lt;li>TestConcurrent2 ÊµãÁöÑÊòØÂÆïÊú∫ÂÜçÈáçÂêØ Service Â±Ç‰∏çÂÄüÂä© snapshotÔºåÁî® raft Â±ÇÁöÑÊó•ÂøóÂø´ÈÄüËøΩËµ∂ÔºåÁÑ∂ÂêéÊàëÁöÑ Get ÁªìÊûúÊÄªÊòØ‰∏éÊ≠£Á°ÆÁ≠îÊ°à‰∏ç‰∏ÄËá¥ÔºåË°®Áé∞Âú®ÂâçÈù¢Ê≠£Á°ÆÔºåÂêéÈù¢Ê≠£Á°ÆÔºå‰∏≠Èó¥Áº∫Â§±„ÄÇÂéüÊù•ÊòØÂú® shardkv ÂàùÂßãÂåñÁöÑÊó∂ÂÄôÔºåcfg ‰∏çËÉΩÂàùÂßãÂåñ‰∏∫&lt;code>kv.sc.Query(-1)&lt;/code>ÔºåÂõ†‰∏∫ÊàëÂ∞Ü cfg ÂàùÂßãÂåñ‰∏∫ÊúÄÊñ∞ÂÄºÔºåË¢´ Raft Â±ÇÊé®Âà∞ Service Â±ÇÁöÑÊó•ÂøóÂú®Â∫îÁî®Âú®Áä∂ÊÄÅÊú∫ÁöÑÊó∂ÂÄôÂõ†‰∏∫ cfgNum ‰∏çÁ≠â‰∫éÂΩìÂâçÁöÑ cfgÔºåÊâÄ‰ª•Ëá™Âä®Â±èËîΩÊéâ‰∫ÜÔºàÂÖ∂ÂÆûËøô‰∏™ÈóÆÈ¢òÂ∫îËØ•‰∏çÈöæÂèëÁé∞Ôºå‰ΩÜÊàëÂú®Êâì log ÁöÑÊó∂ÂÄôÊ≤°ÊúâÂ∞Ü cfgNum ‰Ωú‰∏∫ log Â§¥ÔºåÂ∞±Ê≤°ÊÄé‰πàÊ≥®ÊÑèÂà∞ÔºåÊâæ‰∫ÜÂ•Ω‰πÖ„ÄÇ&lt;/li>
&lt;li>ÈúÄË¶ÅÊÄùËÄÉÊÄé‰πàÂÅöÂà∞ Multi-Raft ÁöÑÂπÇÁ≠âÂíåÁ∫øÊÄß‰∏ÄËá¥ÊÄß„ÄÇ&lt;/li>
&lt;/ol></description><category domain="https://loomt.top/posts/">posts</category><category domain="https://loomt.top/tags/raft/">Raft</category><category domain="https://loomt.top/tags/%E5%88%86%E5%B8%83%E5%BC%8F/">ÂàÜÂ∏ÉÂºè</category><category domain="https://loomt.top/tags/6.824/">6.824</category></item><item><title>6.824 Lab3</title><link>https://loomt.top/posts/6.824-lab3/</link><guid isPermaLink="true">https://loomt.top/posts/6.824-lab3/</guid><pubDate>Tue, 07 Mar 2023 18:51:52 +0800</pubDate><author>loomt_@outlook.com (loomt)</author><copyright>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh)</copyright><description>&lt;h1 id="task">Task&lt;/h1>
&lt;p>Âú® raft Ê°ÜÊû∂ÁöÑÂü∫Á°Ä‰∏äÂª∫Á´ã‰∏Ä‰∏™ÂÆπÈîôÁöÑ KV Êï∞ÊçÆÂ∫ì„ÄÇÈáçÁÇπÂú®‰∫éÁêÜËß£ Service Â±ÇÂíå Raft Â±ÇÁöÑ‰∫§‰∫íÔºå‰ª£Á†ÅÊñπÈù¢ËæÉ‰∏∫ÁÆÄÂçïÔºåÊïÖ‰∏çËøõË°åËµòËø∞„ÄÇ&lt;/p>
&lt;h2 id="step">Step&lt;/h2>
&lt;ol>
&lt;li>Âú® client Âíå service ‰∏§Â±ÇÂÆåÊàê Get(), Append(), Put()&lt;/li>
&lt;li>ÂØπÈáçÂ§çÁöÑ Append Êàñ Put ËøõË°åÂéªÈáç&lt;/li>
&lt;li>service Â±ÇÁöÑÂø´ÁÖß‰∏éÊåÅ‰πÖÂåñÔºàÂø´ÁÖßÂ≠òÂÇ®ÁöÑÊòØ Key/Value Á≠âÂÖÉÊï∞ÊçÆÔºâ
&lt;img src="https://loomt.top/img/824lab3.png" alt="lab3">&lt;/li>
&lt;/ol>
&lt;h2 id="tips">tipsÔºö&lt;/h2>
&lt;p>ÂÄºÂæó‰∏ÄÊèêÁöÑÊòØÂú®ÂÜôÂÆå lab3 ÁöÑÂ§ßÊ¶ÇÊ°ÜÊû∂ÂêéÔºåTestSpeed3A ‰∏ÄÁõ¥‰∏çÈÄöËøáÔºåÂõ†‰∏∫Ë¶ÅÊ±ÇÊòØÂπ≥Âùá 33ms ‰∏Ä‰∏™ commitÔºå‰ΩÜÊ≠£Â∏∏Êù•ËØ¥ commit Êó∂Èó¥Â∫îËØ•Âíå heartbeat timeout Â∑Æ‰∏çÂ§öÔºåÈÅÇ‰øÆÊîπ Start() ÂáΩÊï∞ÔºåÂú® command Ë¢´ Service ÈÄÅÊù•ÁöÑÊó∂ÂÄôÂèëËµ∑‰∏ÄÊ¨°ÂøÉË∑≥ÔºåËøõË°åÊó•ÂøóÂêåÊ≠•„ÄÇ&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="kd">func&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">rf&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">Raft&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nf">Start&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">command&lt;/span> &lt;span class="kd">interface&lt;/span>&lt;span class="p">{})&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">bool&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">mu&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Lock&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="k">defer&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">mu&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Unlock&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">state&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="nx">Leader&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="nx">NULL&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">NULL&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kc">false&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="nx">index&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">term&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">getLastLogL&lt;/span>&lt;span class="p">().&lt;/span>&lt;span class="nx">Index&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">currentTerm&lt;/span>
&lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">log&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">append&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">log&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">Entry&lt;/span>&lt;span class="p">{&lt;/span>
&lt;span class="nx">Command&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">command&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="nx">Term&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">term&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="nx">Index&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">index&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="p">})&lt;/span>
&lt;span class="nf">DPrintf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">dInfo&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;S%v &amp;lt;- %vst command %v&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">me&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">index&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">command&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">persist&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">startHeartbeatL&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kc">false&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">heartbeatTimer&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Reset&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nf">getHeartbeatDuration&lt;/span>&lt;span class="p">())&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="nx">index&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">term&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kc">true&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Êàë‰ª¨ËøòÂèØ‰ª•ËøõË°å‰∏ÄÁÇπ‰ºòÂåñÔºöÂΩì Leader ÂèëÈÄÅÂøÉË∑≥Êó∂ÔºåÂä†‰∏ä‰∏Ä‰∏™ boolÔºåË°®Êòé Leader ÁúüÁöÑÂè™ÊòØÂèëÈÄÅÂøÉË∑≥ÔºåÊàñËÄÖÊòØ‰∏∫‰∫ÜÂø´ÈÄüÂêåÊ≠•Êó•ÂøóÔºåÂ¶ÇÊûúÊòØÂêéËÄÖÔºåËøòÈúÄË¶ÅÂà§Êñ≠ÊØè‰∏Ä‰∏™ Follower ÁöÑ nextIndex ÊòØÂê¶ÈúÄË¶ÅÂêåÊ≠•ÔºåÂ¶ÇÊûú‰∏çÊª°Ë∂≥ &lt;code>(rf.getLastLogL().Index &amp;gt; rf.nextIndex[i])&lt;/code>ÔºåÂàô‰∏çÂÜçÂêåÊ≠•Êó•Âøó„ÄÇ&lt;/p>
&lt;p>Ê≠£Â∏∏Êù•ËØ¥Âà∞Ëøô‰∏ÄÊ≠•Â∞±Ê≤°ÈóÆÈ¢ò‰∫ÜÔºå‰ΩÜÊòØÊàëÂèàÂèëÁé∞‰∫Ü lab2 ÁöÑ‰∏Ä‰∏™ÈÅóÁïô bugÔºåÂΩì commit È¢ëÁéáÂèòÂæóÂæàÂø´Êó∂ Leader Â∞±‰ºöÊö¥ÊØôÔºà‰πãÂâçÁöÑÊµãËØï‰ªÖ‰ªÖÈÄöËøá heartbeat timeout ÂêåÊ≠•Êó•ÂøóÔºåÈ¢ëÁéáËæÉ‰ΩéÔºåÂü∫Êú¨Ê≤°ÊúâÂá∫Áé∞Ëøô‰∏™ÈóÆÈ¢òÔºâ„ÄÇÈÄöËøáÊâì logÔºåÂèëÁé∞ commit ÊòØÈÄöËøáÂçïÁã¨ÁöÑ go routine Êé•Êî∂ channel ÁöÑ‰ø°Âè∑ÂÆûÁé∞ÁöÑÔºåÂõ†‰∏∫ channel ÂàùÂßãÂåñ‰∏∫&lt;code>make(chan int,1)&lt;/code>ÔºåÂú® Leader ËøûÁª≠ commit Êó∂ÂÆπÊòìÂ†µÂ°ûÔºåÂÖ∂ÂÆûÁêÜËÆ∫‰∏ä‰ºöÁºìÊÖ¢ÈÄöËøáÔºå‰ΩÜËøòÊòØÊö¥ÊØô‰∫ÜÔºåÂ±û‰∫éÊòØ‰∏Ä‰∏™ÂæàÁéÑÂ≠¶ÁöÑ bug„ÄÇÊúÄÂêéÂ∞Ü channel Êâ©ÂÆπÊàê 100 Â∞±ËΩªÊùæËøá‰∫Ü:)&lt;/p></description><category domain="https://loomt.top/posts/">posts</category><category domain="https://loomt.top/tags/raft/">Raft</category><category domain="https://loomt.top/tags/%E5%88%86%E5%B8%83%E5%BC%8F/">ÂàÜÂ∏ÉÂºè</category><category domain="https://loomt.top/tags/6.824/">6.824</category></item><item><title>6.824 Lab2D</title><link>https://loomt.top/posts/6.824-lab2d/</link><guid isPermaLink="true">https://loomt.top/posts/6.824-lab2d/</guid><pubDate>Fri, 03 Mar 2023 14:57:30 +0800</pubDate><author>loomt_@outlook.com (loomt)</author><copyright>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh)</copyright><description>&lt;blockquote>
&lt;p>&lt;a href="https://loomt.top/posts/6.824-lab2">ÂâçÁΩÆËäùÂ£´&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;h1 id="task">Task&lt;/h1>
&lt;p>ÂÆåÊàê Raft ÁöÑÂø´ÁÖßÂäüËÉΩÔºàÊ∂âÂèäÂà∞ËæÉÂ§öÁöÑ‰∏é Service Â±ÇÁöÑ‰∫§‰∫í„ÄÇ&lt;/p>
&lt;ul>
&lt;li>‰∏∫‰ªÄ‰πàË¶ÅÊúâ snapshot?
&lt;ol>
&lt;li>snapshot ÂèØ‰ª•Â∞Ü log ÂéãÁº©ÔºåÊØîÂ¶ÇÂ∞Ü 10 ‰∏™ log ÂéãÁº©Êàê 9 ‰∏™ÔºàÂΩì‰∏§‰∏™ log ‰øÆÊîπÁöÑ key ÂÄº‰∏ÄÊ†∑Êó∂Ôºâ„ÄÇ&lt;/li>
&lt;li>snapshot ÂèØ‰ª•ÂáèÂ∞ë Raft Â±Ç log ÁöÑÈïøÂ∫¶ÔºåÂ∏ÆÂä©ËøõÂ∫¶ËæÉÊÖ¢ÁöÑ Raft ËäÇÁÇπÂø´ÈÄüÊÅ¢Â§çÁä∂ÊÄÅÊú∫ÔºàÂáèÁü≠ raft ‰∏≠ log ÁöÑÈïøÂ∫¶Ôºâ„ÄÇsnapshot Âå∫Âà´‰∫éÊåÅ‰πÖÂåñ logÔºåÂêéËÄÖ‰∏ªË¶ÅÊòØ‰∏çËÆ©ÂÆïÊú∫ÁöÑ raft ‰∏¢Â§±Â§™Â§öÊó•Âøó„ÄÇ&lt;/li>
&lt;/ol>
&lt;/li>
&lt;li>Âú® 2D ‰∏≠Ôºåsnapshot ‰ºöÊ∂âÂèäÂà∞ raft Â±Ç‰∏é service Â±ÇÁöÑÂ§öÊ¨°‰∫§‰∫íÔºåÁúãËøô‰∏™ &lt;a href="https://pdos.csail.mit.edu/6.824/notes/raft_diagram.pdf">diagram of Raft interactions&lt;/a>¬† ÊàñËÆ∏ÂèØ‰ª•Â∏ÆÂä©ÁêÜËß£ Raft ÂçèËÆÆ‰∏çÂêåÂ±ÇÊ¨°ÁöÑÂäüËÉΩ‰∏éÁâπÊÄß„ÄÇ&lt;/li>
&lt;li>snapshot ‰ΩúÁî®‰∫éÊØè‰∏Ä‰∏™ Raft ËäÇÁÇπÔºåÊàë‰ª¨ÈúÄË¶ÅËÆ∞ÂΩï snapshot ÊúÄÂêé‰∏Ä‰∏™ index Âíå termÔºåÁî®‰∫é‰∏ÄËá¥ÊÄßÊ£ÄÊü•„ÄÇ&lt;/li>
&lt;/ul>
&lt;h2 id="step">Step&lt;/h2>
&lt;ol>
&lt;li>Snapshot() Ë¢´ service Â±ÇË∞ÉÁî®ÔºåÁ∫¶Ëé´ 10 Ê¨° commit Ë∞ÉÁî®‰∏ÄÊ¨°ÔºåÁî®‰∫é‰øùÂ≠òÂø´ÁÖß„ÄÇÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÂø´ÁÖßÊòØ service ‰º†Áªô raft Â±ÇÁöÑÔºåËÄå‰∏çÊòØÊàë‰ª¨Âú® raft Â±ÇÂÜôÂÖ•Êó•ÂøóÂàõÂª∫ÁöÑÔºåÊàë‰ª¨‰∏çÈúÄË¶ÅÂàõÂª∫Âø´ÁÖßÔºå‰ªÖÈúÄË¶ÅÂ§ÑÁêÜ Service Â±Ç‰º†ËøõÊù•ÁöÑ snapshotÔºåËøõË°åÊó•ÂøóÊà™Êñ≠ÂíåÂø´ÁÖßÊåÅ‰πÖÂåñ„ÄÇ&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="kd">func&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">rf&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">Raft&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nf">Snapshot&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">index&lt;/span> &lt;span class="kt">int&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">snapshot&lt;/span> &lt;span class="p">[]&lt;/span>&lt;span class="kt">byte&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">mu&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Lock&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="k">defer&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">mu&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Unlock&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">lastIncludedIndex&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="o">&amp;gt;=&lt;/span> &lt;span class="nx">index&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">return&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="nx">term&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">logAt&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">index&lt;/span>&lt;span class="p">).&lt;/span>&lt;span class="nx">Term&lt;/span>
&lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">log&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">log&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">index&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">lastIncludedIndex&lt;/span>&lt;span class="p">():]&lt;/span>
&lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">setLastIncludedIndex&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">index&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">setLastIncludedTerm&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">term&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">persister&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">SaveStateAndSnapshot&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">getEncodeStateL&lt;/span>&lt;span class="p">(),&lt;/span> &lt;span class="nx">snapshot&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="nf">DPrintf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">dSnap&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;S%v last: %v&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">me&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">index&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://loomt.top/img/snapshot.png" alt="snapshot">
2. InstallSnapshotÔºö&lt;/p>
&lt;ol>
&lt;li>
&lt;p>Leader ÊñπÈù¢ÔºåÂΩì$nextIndex[Follower] \leq Leader.lastIncludeIndex$ÁöÑÊó∂ÂÄôÔºåÁî±‰∫é Leader Â∑≤ÁªèÊ≤°ÊúâËøôÈÉ®ÂàÜÁöÑÊó•ÂøóÔºåLeader ‰ºöÂèëÈÄÅ InstallSnapshot RPC Áªô FollowerÔºåËØ∑Ê±Ç Follower ÂÆâË£ÖÂø´ÁÖßÔºàÂø´ÈÄüËøΩËµ∂ÔºâÔºåÂπ∂‰∏îÂú®ÊàêÂäüÊî∂Âà∞ËøîÂõûÂÄºÂêéÔºåLeader ‰ºöÊõ¥Êñ∞ nextIndex Âíå matchIndex&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Follower ÊñπÈù¢ÔºåÂ¶ÇÊûú Follower Êî∂Âà∞ Leader ÁöÑ‰ªªÊúüÊ≤°ÊúâËøáÊúüÁöÑËØùÔºåÂè™ËÉΩÊâßË°å„ÄÇ‰∏éËÆ∫Êñá‰∏çÂêåÁöÑÊòØÔºö‰∏çÈúÄË¶ÅËÄÉËôëÂàÜÂùóÂèëÈÄÅ snapshotÔºåÊâÄ‰ª•&lt;code>offset&lt;/code> Âíå&lt;code>done&lt;/code>ÈÉΩ‰∏çÈúÄË¶ÅËÄÉËôëÔºåÁõ∏Â∫îÁöÑÔºåÂú®ÂÆûÁé∞ÁöÑÊó∂ÂÄô‰πü‰∏çÈúÄË¶ÅËÄÉËôëÁ¨¨ 2,3,4 ÁÇπ implementation„ÄÇÊúÄÂêéÂè¶Ëµ∑‰∏Ä‰∏™ go routine ‰º† snapshot ‰ª•ÂèäÂÖ∂‰ªñÂøÖË¶ÅÂèÇÊï∞Áªô applyCh ËÆ© service Êõ¥Êñ∞Áä∂ÊÄÅÊú∫ÔºàÂèëÈÄÅÁªô service Âêé service ‰∏ç‰ºöÁ´ãÂàªÊãø snapshot Êõ¥Êñ∞Áä∂ÊÄÅÊú∫Ôºå‰ºöÂÖàË∞ÉÁî® CondInstallsnapshot Êù•ËØ¢ÈóÆ Follower Âú®ËøôÊúüÈó¥ÊúâÊ≤°Êúâ commitÔºåËã•Ê≤°ÊúâÔºåÊâç‰ºöÁî® snapshot Êõ¥Êñ∞Áä∂ÊÄÅÊú∫„ÄÇ&lt;/p>
&lt;/li>
&lt;/ol>
&lt;p>&lt;img src="https://loomt.top/img/installSnapshotRPC.png" alt="snapshotRPC">&lt;/p>
&lt;ul>
&lt;li>CondInstallSnapshotÔºöËã• $lastIncludedIndex\leq commitIndex$ ÔºåÂàôËøîÂõû&lt;code>false&lt;/code>ÔºåÊ≠§Êó∂ service ‰∏ç‰ºöÂ∫îÁî® snapshotÔºõÂê¶ÂàôÂâ™Áü≠Ëá™Â∑±ÁöÑ logÔºåÂπ∂Êõ¥Êñ∞ snapshot„ÄÅlastIncludedTerm Âíå lastIncludedIndexÔºåÂπ∂ËøõË°åÊåÅ‰πÖÂåñ„ÄÇ&lt;/li>
&lt;/ul>
&lt;h2 id="tips">tipsÔºö&lt;/h2>
&lt;ol>
&lt;li>
&lt;p>Âú®ÊåÅ‰πÖÂåñÁöÑÊó∂ÂÄôËÄÉËôë lastIncludedIndex Âíå lastIncludedTermÔºåÂπ∂Â∫îÁî®Âà∞ commitIndex Âíå lastApplied„ÄÇ&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Âõ†‰∏∫Êàë‰ª¨Ë¶ÅÂà†ÊéâÂ∑≤ÁªèË¢´ snapshot ÁöÑ logÔºåÊâÄ‰ª•ÈúÄË¶ÅÊîπÂèò log ÁöÑÁ¥¢ÂºïÊñπÂºè„ÄÇ&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ÂØπ condInstallsnapshot ÁöÑËß£ÈáäÔºöFollower Êî∂Âà∞ InstallSnapshotÔºåÂêëÊúçÂä°Âô®ËØ∑Ê±ÇÂ∫îÁî® snapshot ÁöÑÊó∂ÂÄôÔºåÂ¶ÇÊûúÊúçÂä°Âô®ÂèëÈÄÅ condInstallSnapshot ÁöÑÈÇ£‰∏ÄÂàª lastCommit ËøòÊ≤°Ë¢´‰øÆÊîπÁöÑËØùÔºåÂ∞±‰øùËØÅ‰∫ÜÂéüÂ≠êÊìç‰Ωú„ÄÇ‰∏∫‰ªÄ‰πàÈúÄË¶Å‰øùËØÅÂéüÂ≠êÊìç‰ΩúÔºüÂõ†‰∏∫ËäÇÁÇπÈÄöËøá applychan Âêë service ÈÄö‰ø°ÁöÑÊÉÖÂÜµÊúâ‰∏§ÁßçÔºå‰∏ÄÁßçÊòØ commit Âà∞Áä∂ÊÄÅÊú∫ÔºåÂè¶‰∏ÄÁßçÊòØ snapshot Âà∞Áä∂ÊÄÅÊú∫Ôºå‰∏§ËÄÖÊòØÂπ∂Ë°åÁöÑÔºå‰∫í‰∏çÂπ≤Êâ∞„ÄÇÂè™Ë¶Å raft ËäÇÁÇπÂú®ÂèëÈÄÅ snapshot channel Âà∞ service Êé•Êî∂Âà∞Ëøô‰∏™ channel ‰πãÈó¥Êúâ commit channelÔºå‰πüÂ∞±ÊòØÂΩì $lastIncludedIndex\leq commitIndex$ ÁöÑÊó∂ÂÄôÔºåsnapshot ÂèëÈÄÅÁöÑ log Â∞±ÂæàÊúâÂèØËÉΩË¢´Â∫îÁî®Âà∞Áä∂ÊÄÅÊú∫‰∫Ü„ÄÇ&lt;/p>
&lt;/li>
&lt;/ol></description><category domain="https://loomt.top/posts/">posts</category><category domain="https://loomt.top/tags/raft/">Raft</category><category domain="https://loomt.top/tags/%E5%88%86%E5%B8%83%E5%BC%8F/">ÂàÜÂ∏ÉÂºè</category><category domain="https://loomt.top/tags/6.824/">6.824</category></item><item><title>6.824 Lab2C</title><link>https://loomt.top/posts/6.824-lab2c/</link><guid isPermaLink="true">https://loomt.top/posts/6.824-lab2c/</guid><pubDate>Fri, 03 Mar 2023 14:57:20 +0800</pubDate><author>loomt_@outlook.com (loomt)</author><copyright>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh)</copyright><description>&lt;blockquote>
&lt;p>&lt;a href="https://loomt.top/posts/6.824-lab2">ÂâçÁΩÆËäùÂ£´&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;h1 id="task">Task&lt;/h1>
&lt;p>ÂÆåÊàê Raft ÁöÑÊåÅ‰πÖÂåñ„ÄÇ&lt;/p>
&lt;h2 id="step">Step&lt;/h2>
&lt;p>Â¶ÇÊûúÂâçÈù¢ÂÅöÂæóÂ•ΩÔºåÂè™ÈúÄË¶ÅÂÆåÊàêÊåÅ‰πÖÂåñ„ÄÇ&lt;/p>
&lt;ol>
&lt;li>ÊåÅ‰πÖÂåñËá≥ Service Â±Ç&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="nf">persist&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ol start="2">
&lt;li>Crash Âêé‰ªé Service Â±ÇÊÅ¢Â§ç&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="nf">readPersist&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">data&lt;/span> &lt;span class="p">[]&lt;/span>&lt;span class="kt">byte&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ol start="3">
&lt;li>Â¶ÇÊûúÂíåÊàë‰∏ÄÊ†∑ÂâçÈù¢Â∑ÆÁÇπÊÑèÊÄùÔºåÂ∞±Ë¶ÅÂ∞è‰øÆ‰∏Ä‰∏ã
&lt;a href="https://thesquareplanet.com/blog/students-guide-to-raft/#an-aside-on-optimizations">guide&lt;/a>&lt;/li>
&lt;/ol>
&lt;ul>
&lt;li>AppendEntries Handler ‰∏≠ÔºåFollower ÂºïÂÖ• XTerm Âíå XIndex Êù•Âø´ÈÄüË∞ÉÊï¥ nextIndex„ÄÇ&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="k">if&lt;/span> &lt;span class="nx">args&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">PrevLogIndex&lt;/span> &lt;span class="p">&amp;gt;&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">getLastLogL&lt;/span>&lt;span class="p">().&lt;/span>&lt;span class="nx">Index&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">reply&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Success&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">reply&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Term&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="kc">false&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">currentTerm&lt;/span>
&lt;span class="nx">reply&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">XIndex&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">getLastLogL&lt;/span>&lt;span class="p">().&lt;/span>&lt;span class="nx">Index&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="c1">// Follower&amp;#39;s nextIndex
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="k">return&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="c1">// entry logAt prevLogIndex whose term doesn&amp;#39;t match prevLogTerm
&lt;/span>&lt;span class="c1">&lt;/span>&lt;span class="nf">DPrintf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">dInfo&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;S%v prevLogTerm:%v, prevLogIndex:%v,log[prevLogIndex].Term:%v&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">me&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">args&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">PrevLogTerm&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">args&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">PrevLogIndex&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">logAt&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">args&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">PrevLogIndex&lt;/span>&lt;span class="p">).&lt;/span>&lt;span class="nx">Term&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="nx">args&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">PrevLogTerm&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">logAt&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">args&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">PrevLogIndex&lt;/span>&lt;span class="p">).&lt;/span>&lt;span class="nx">Term&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">reply&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Success&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">reply&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Term&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="kc">false&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">currentTerm&lt;/span>
&lt;span class="nx">reply&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">XIndex&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">reply&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">XTerm&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">commitIndex&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">logAt&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">args&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">PrevLogIndex&lt;/span>&lt;span class="p">).&lt;/span>&lt;span class="nx">Term&lt;/span>
&lt;span class="k">for&lt;/span> &lt;span class="nx">i&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">args&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">PrevLogIndex&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">i&lt;/span> &lt;span class="p">&amp;gt;&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">commitIndex&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">i&lt;/span>&lt;span class="o">--&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="nx">reply&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">XTerm&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">logAt&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">i&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">).&lt;/span>&lt;span class="nx">Term&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">reply&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">XIndex&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">i&lt;/span>
&lt;span class="k">return&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="nf">DPrintf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">dInfo&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;S%v XIndex = %v&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">me&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">commitIndex&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">return&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>Leader ÂØπ XTerm Âíå XIndex ÁöÑÂ§ÑÁêÜ&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="k">if&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">sendAppendEntries&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">peer&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">args&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="nx">reply&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">mu&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Lock&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="k">defer&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">mu&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Unlock&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="nx">reply&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Term&lt;/span> &lt;span class="p">&amp;gt;&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">currentTerm&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="c1">//changeState but not update election timer
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="p">}&lt;/span> &lt;span class="k">else&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="nx">args&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Term&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">currentTerm&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="nx">reply&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Success&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="c1">// update nextIndex, matchIndex &amp;amp; commit
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="p">}&lt;/span> &lt;span class="k">else&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="nx">reply&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Term&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">currentTerm&lt;/span>&lt;span class="p">{&lt;/span>
&lt;span class="c1">// adjust nextIndex
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="nx">reply&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">XIndex&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="nx">NULL&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nf">DPrintf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">dHeart&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;S%v &amp;lt;- S%v heartbeat XIndex:%v, XTerm:%v&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">me&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">peer&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">reply&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">XIndex&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">reply&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">XTerm&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="nx">reply&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">XTerm&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="nx">NULL&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">nextIndex&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">peer&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">reply&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">XIndex&lt;/span>
&lt;span class="p">}&lt;/span> &lt;span class="k">else&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">ok&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="kc">false&lt;/span>
&lt;span class="k">for&lt;/span> &lt;span class="nx">i&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">nextIndex&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">peer&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">i&lt;/span> &lt;span class="p">&amp;gt;&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">lastIncludedIndex&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="nx">reply&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">XTerm&lt;/span> &lt;span class="o">&amp;lt;=&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">logAt&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">i&lt;/span>&lt;span class="p">).&lt;/span>&lt;span class="nx">Term&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">i&lt;/span>&lt;span class="o">--&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">logAt&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">i&lt;/span>&lt;span class="p">).&lt;/span>&lt;span class="nx">Term&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="nx">reply&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">XTerm&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">ok&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="kc">true&lt;/span>
&lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">nextIndex&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">peer&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">i&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="mi">1&lt;/span>
&lt;span class="k">break&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="p">!&lt;/span>&lt;span class="nx">ok&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">nextIndex&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">peer&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">reply&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">XIndex&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>electionTimer ‰∏çËÉΩÂú®ÊØèÊ¨°ÂèòÊàê Follower ÁöÑÊó∂ÂÄôÈáçÁΩÆ„ÄÇ&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;p>If election timeout elapses without receiving AppendEntries RPC from current Leader or granting vote to Candidate: convert to Candidate.&lt;/p>
&lt;/blockquote>
&lt;blockquote>
&lt;p>The distinction turns out to matter a lot, as the former implementation can result in significantly reduced liveness in certain situations.&lt;/p>
&lt;/blockquote>
&lt;p>electionTimer ÈáçÁΩÆ‰ªÖÂú®‰ª•‰∏ãÊÉÖÂÜµÂèëÁîüÔºö&lt;/p>
&lt;ul>
&lt;li>ÂàöÊàê‰∏∫ Candidate„ÄÇ&lt;/li>
&lt;li>ÁªôÂà´‰∫∫ÊäïÁ•®Âêé„ÄÇ&lt;/li>
&lt;li>Follower Êî∂Âà∞ AppendEntries ÊàñËÄÖ InstallSnapshotÔºåÂπ∂‰∏î args.Term Á≠â‰∫éËá™Â∑±ÂΩìÂâçÁöÑ termÔºàÂú®&lt;a href="https://loomt.top/posts/6.824-lab2B">ÂâçÁΩÆËäùÂ£´&lt;/a>ÊúâË∞àÂà∞ÔºåÂÖ∂ÂÆûËøô‰∏™ bug ÊòØÊàëÂú® 2C ÁöÑÊó∂ÂÄôÊâç‰øÆÁöÑÔºâ„ÄÇ&lt;/li>
&lt;/ul>
&lt;p>ÊàëÂú® Follower Êî∂Âà∞ AppendEntries ÊàñËÄÖ InstallSnapshotÔºåÂπ∂‰∏î args.Term Â§ß‰∫é currentTerm ÁöÑÊó∂ÂÄô‰πüÈáçÁΩÆ‰∫Ü electionTimer„ÄÇÊîπ‰∏∫‰∏çÈáçÁΩÆÂêéÔºåÁõ¥ËßÇÁöÑÁªìÊûúÊòØË∑ë 2C ÁöÑ test Âπ≥ÂùáÂø´‰∫Ü 15sÔºåÂπ∂‰∏î‰∏ç‰ºöÂá∫Áé∞&lt;code>fail to reach agreement&lt;/code>‰∫Ü„ÄÇ&lt;/p></description><category domain="https://loomt.top/posts/">posts</category><category domain="https://loomt.top/tags/raft/">Raft</category><category domain="https://loomt.top/tags/%E5%88%86%E5%B8%83%E5%BC%8F/">ÂàÜÂ∏ÉÂºè</category><category domain="https://loomt.top/tags/6.824/">6.824</category></item><item><title>6.824 Lab2B</title><link>https://loomt.top/posts/6.824-lab2b/</link><guid isPermaLink="true">https://loomt.top/posts/6.824-lab2b/</guid><pubDate>Fri, 03 Mar 2023 14:57:17 +0800</pubDate><author>loomt_@outlook.com (loomt)</author><copyright>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh)</copyright><description>&lt;blockquote>
&lt;p>&lt;a href="https://loomt.top/posts/6.824-lab2">ÂâçÁΩÆËäùÂ£´&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;h1 id="task">Task&lt;/h1>
&lt;p>Â§ÑÁêÜÊó•ÂøóÔºåÂÖ∑‰ΩìÊù•ËØ¥ÊòØÊé•Êî∂ Service Â±ÇÂèëÊù•ÁöÑÊó•ÂøóÔºåÊó•ÂøóÂ§çÂà∂ÔºåÂ∫îÁî®Êó•Âøó„ÄÇ&lt;/p>
&lt;p>Ê∂âÂèäÂà∞‰∏ÄÁÇπ Raft Â±Ç‰∏é Service Â±ÇÁöÑ‰∫§‰∫íÔºåÊØîÂ¶Ç Leader Êé•Âèó command Âπ∂‰øùÂ≠ò‰∏∫Êó•ÂøóÔºõApply Êó•ÂøóÂà∞ Service Â±Ç„ÄÇ&lt;/p>
&lt;h2 id="step">Step&lt;/h2>
&lt;ol>
&lt;li>ÈÄâ‰∏æÁöÑÊó∂ÂÄôÈúÄË¶ÅÈ¢ùÂ§ñÊ≥®ÊÑè‰∏Ä‰∏™ÈôêÂà∂ÔºöÂè™ÊäïÁ•®Áªô log ÊØîËá™Â∑±Êñ∞ÁöÑ Candidate„ÄÇ&lt;/li>
&lt;li>Leader Êé•Âèó commandÔºåappend Ëøõ logÔºåËøîÂõûÊ≠§ command ÁöÑ‰∏ãÊ†áÔºåÊ≠§Êó∂ log Âú®Áä∂ÊÄÅÊú∫‰∏≠ËøòÊ≤°Ë¢´Â∫îÁî®„ÄÇ&lt;/li>
&lt;li>ÂøÉË∑≥Êó∂È°∫‰æøÂèëÈÄÅÊó•ÂøóÁªô FollowerÔºà‰πüÂèØ‰ª•ÂàÜÂºÄÔºâ„ÄÇ&lt;/li>
&lt;/ol>
&lt;ul>
&lt;li>AppendEntries RPC ÂèÇÊï∞‰∏≠ÁöÑ log ÈúÄË¶ÅÊ∑±Êã∑Ë¥ùÊâçËÉΩÂÖçÈÅ≠ data race„ÄÇ&lt;/li>
&lt;li>ÂèëÈÄÅÁöÑ log Âπ∂‰∏çÊòØ‰ªéÂ§¥ÂºÄÂßãÔºåËÄåÊòØ‰ªé nextIndex ÂºÄÂßã„ÄÇ&lt;/li>
&lt;li>Âú®‰∏çÂèØÈù†ÁΩëÁªú‰∏≠ÔºåÊî∂Âà∞ RPC ÁªìÊûúÁöÑÊó∂ÂÄôÂèØËÉΩÂ∑≤ÁªèËøá‰∫ÜÂá†‰∏™‰ªªÊúüÔºåÊ≠§Êó∂ÈúÄË¶ÅÂÖàÊ£ÄÊü•‰∏Ä‰∏ã args.Term ËøòÁ≠â‰∏çÁ≠â‰∫é currentTermÔºå‰ΩÜÂú®Ê≠§‰πãÂâçÔºåÂ¶ÇÊûúËøîÂõûÁöÑ‰ªªÊúüÊØî currentTerm ËøòË¶ÅÂ§ßÔºåÈÇ£‰πàÊó†ËÆ∫ÊòØ‰∏çÊòØ‰∏çÂèØÈù†ÁΩëÁªúÔºåËøô‰∏™ Leader ÈÉΩË¶ÅËΩ¨‰∏∫ FollowerÔºàÂêåÊ†∑ÁöÑÔºåÂõ†‰∏∫‰∏çÁ°ÆÂÆö‰ªñÊúâÊ≤°ÊúâËµÑÊ†ºÊàê‰∏∫ CandidateÔºåÊâÄ‰ª•Ê≤°ÊúâÂøÖË¶ÅÂ∞ÜÂÖ∂ËΩ¨‰∏∫ CandidateÔºåÂèçÊ≠£‰ªªÊúüÂ¢ûÂä†ÂêéÊÄª‰ºöÊúâ Candidate ‰∫ßÁîüÔºâÔºõÂ¶ÇÊûúËøîÂõûÁöÑ‰ªªÊúüÂ∞è‰∫éÁ≠â‰∫é currentTermÔºåÈÇ£‰πà Leader Âè™ÈúÄË¶ÅÊ≠£Â∏∏Â§ÑÁêÜ„ÄÇ&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="k">if&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">sendAppendEntries&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">peer&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">args&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="nx">reply&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">mu&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Lock&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="k">defer&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">mu&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Unlock&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="nx">reply&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Term&lt;/span> &lt;span class="p">&amp;gt;&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">currentTerm&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="c1">//changeState but not update election timer
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="p">}&lt;/span> &lt;span class="k">else&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="nx">args&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Term&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">currentTerm&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="nx">reply&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Success&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="c1">// update nextIndex, matchIndex &amp;amp; commit
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="p">}&lt;/span> &lt;span class="k">else&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="nx">reply&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Term&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">currentTerm&lt;/span>&lt;span class="p">{&lt;/span>
&lt;span class="c1">// adjust nextIndex
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">nextIndex&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">peer&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nf">max&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">nextIndex&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">peer&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ol start="4">
&lt;li>Follower ËøõË°åÊó•ÂøóÂ§çÂà∂ÔºàÈúÄ‰∏•Ê†ºÊåâÁÖßËÆ∫ÊñáÔºâ„ÄÇ&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="nx">prevLogIndex&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">nextIndex&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">i&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="mi">1&lt;/span>
&lt;span class="nx">prevLogTerm&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">logAt&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">prevLogIndex&lt;/span>&lt;span class="p">).&lt;/span>&lt;span class="nx">Term&lt;/span>
&lt;span class="nx">args&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="nx">AppendEntriesArgs&lt;/span>&lt;span class="p">{&lt;/span>
&lt;span class="nx">Term&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">currentTerm&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="nx">LeaderId&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">me&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="nx">PrevLogIndex&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">prevLogIndex&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="nx">PrevLogTerm&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">prevLogTerm&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="nx">Entries&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">make&lt;/span>&lt;span class="p">([]&lt;/span>&lt;span class="nx">Entry&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">getLastLogL&lt;/span>&lt;span class="p">().&lt;/span>&lt;span class="nx">Index&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">prevLogIndex&lt;/span>&lt;span class="p">),&lt;/span>
&lt;span class="nx">LeaderCommit&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">commitIndex&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="c1">// ÂøÖÈ°ªË¶ÅÂ§çÂà∂‰∏ÄÈÅçÊâçËÉΩÂÖçÈÅ≠ data race
&lt;/span>&lt;span class="c1">&lt;/span>&lt;span class="nb">copy&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">args&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Entries&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">log&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">prevLogIndex&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">lastIncludedIndex&lt;/span>&lt;span class="p">():])&lt;/span>
&lt;span class="k">go&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">foraHeartbeat&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">i&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">args&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ol start="5">
&lt;li>AppendEntries RPC ÂõûÂ§çÂêéÂ∫îÂ¶Ç‰ΩïÊîπÂèòËá™Ë∫´Áä∂ÊÄÅ„ÄÇ&lt;/li>
&lt;/ol>
&lt;ul>
&lt;li>ÂÖàËøõË°å‰∏Ä‰∏™ term ÁöÑÂ§ÑÁêÜ&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="k">if&lt;/span> &lt;span class="nx">args&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Term&lt;/span> &lt;span class="p">&amp;lt;&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">currentTerm&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">reply&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Term&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">reply&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Success&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">currentTerm&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kc">false&lt;/span>
&lt;span class="k">return&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="nx">args&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Term&lt;/span> &lt;span class="p">&amp;gt;&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">currentTerm&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">changeStateL&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">Follower&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">args&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Term&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">NULL&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span> &lt;span class="k">else&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">changeStateL&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">Follower&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">currentTerm&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">votedFor&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">electionTimer&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Reset&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nf">getElectionDuration&lt;/span>&lt;span class="p">())&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>ÂÜçÁúãÁúãËá™Â∑±ÁöÑ log ‰∏é RPC ‰º†Êù•ÁöÑ entries ÊúâÊ≤°ÊúâÂÜ≤Á™ÅÔºåÊúâÁöÑËØù‰ª• Leader ‰∏∫ÂáÜÔºõËøîÂõûÂèÇÊï∞Ë∞ÉÊï¥Ëá™Â∑±Âú® Leader ÈÇ£ËæπÁöÑ nextIndexÔºåÁõ¥Âà∞Âíå Leader prevLogIndex ÁöÑ term ‰∏ÄËá¥‰∏∫Ê≠¢ÔºåÊâçËÉΩÁúüÊ≠£ append entries„ÄÇ&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="c1">// last log index is too small
&lt;/span>&lt;span class="c1">// entry logAt prevLogIndex whose term doesn&amp;#39;t match prevLogTerm
&lt;/span>&lt;span class="c1">&lt;/span>&lt;span class="k">if&lt;/span> &lt;span class="nx">args&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">PrevLogIndex&lt;/span> &lt;span class="p">&amp;gt;&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">getLastLogL&lt;/span>&lt;span class="p">().&lt;/span>&lt;span class="nx">Index&lt;/span> &lt;span class="o">||&lt;/span> &lt;span class="nx">args&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">PrevLogTerm&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">logAt&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">args&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">PrevLogIndex&lt;/span>&lt;span class="p">).&lt;/span>&lt;span class="nx">Term&lt;/span>&lt;span class="p">{&lt;/span>
&lt;span class="nx">reply&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Success&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">reply&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Term&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="kc">false&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">currentTerm&lt;/span>
&lt;span class="k">return&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="c1">// log ÊØî Leader Áü≠ || log ÊØî Leader ÈïøÂπ∂‰∏îÂ≠òÂú®‰∏çÂåπÈÖç -&amp;gt; Êà™Êñ≠Âπ∂Ë°•‰∏ä
&lt;/span>&lt;span class="c1">&lt;/span>&lt;span class="nx">needReplace&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">getLastLogL&lt;/span>&lt;span class="p">().&lt;/span>&lt;span class="nx">Index&lt;/span> &lt;span class="o">&amp;lt;=&lt;/span> &lt;span class="nx">args&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">PrevLogIndex&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="nb">len&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">args&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Entries&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="nb">len&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">args&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Entries&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">&amp;gt;&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">for&lt;/span> &lt;span class="nx">i&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">args&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">PrevLogIndex&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">i&lt;/span> &lt;span class="o">&amp;lt;=&lt;/span> &lt;span class="nx">args&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">PrevLogIndex&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="nb">len&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">args&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Entries&lt;/span>&lt;span class="p">);&lt;/span> &lt;span class="nx">i&lt;/span>&lt;span class="o">++&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="c1">// idx and term can identify a log
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">getLastLogL&lt;/span>&lt;span class="p">().&lt;/span>&lt;span class="nx">Index&lt;/span> &lt;span class="o">&amp;gt;=&lt;/span> &lt;span class="nx">i&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">logAt&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">i&lt;/span>&lt;span class="p">).&lt;/span>&lt;span class="nx">Term&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="nx">args&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Entries&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">i&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">args&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">PrevLogIndex&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">].&lt;/span>&lt;span class="nx">Term&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">needReplace&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="kc">true&lt;/span>
&lt;span class="k">break&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="nx">needReplace&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">log&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">append&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">log&lt;/span>&lt;span class="p">[:&lt;/span>&lt;span class="nx">args&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">PrevLogIndex&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">lastIncludedIndex&lt;/span>&lt;span class="p">()],&lt;/span> &lt;span class="nx">args&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Entries&lt;/span>&lt;span class="o">...&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>commit Ëá™Â∑±ÁöÑÊó•Âøó„ÄÇ&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="k">if&lt;/span> &lt;span class="nx">args&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">LeaderCommit&lt;/span> &lt;span class="p">&amp;gt;&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">commitIndex&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">commitIndex&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">args&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">LeaderCommit&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="nb">len&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">args&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Entries&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">&amp;gt;&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">commitIndex&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nf">min&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">commitIndex&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">args&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Entries&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nb">len&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">args&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Entries&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">].&lt;/span>&lt;span class="nx">Index&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="nf">DPrintf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">dInfo&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;S%v lastIndex:%v, commIndex:%v, lastApplied:%v&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">me&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">getLastLogL&lt;/span>&lt;span class="p">().&lt;/span>&lt;span class="nx">Index&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">commitIndex&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">lastApplied&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">commitIndex&lt;/span> &lt;span class="p">&amp;gt;&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">lastApplied&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">applyWaker&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="mi">1&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="nx">reply&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Term&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">reply&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Success&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">currentTerm&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kc">true&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ol start="6">
&lt;li>Leader ÊñπÈù¢ÔºåÂè™ÊúâÂΩìÂ§ßÈÉ®ÂàÜ Follower ÁöÑ matchIndex Êõ¥Êñ∞Ôºàlog Â≠òÂà∞ FollowerÔºâ‰∫ÜÔºåLeader ÁöÑ commitIndex ÊâçËÉΩÂêåÊ≠•Êõ¥Êñ∞„ÄÇËøôÈÉ®ÂàÜÊàëÁõ¥Êé•‰ªéÂêéÂæÄÂâçÈÅçÂéÜÔºåÂõ†‰∏∫Êó•ÂøóÁöÑ‰ªªÊúüÊòØÊåâÈ°∫Â∫èÂ¢ûÈïøÁöÑÔºåÊâÄ‰ª•Â¶ÇÊûúÈÅáÂà∞Êó•Âøó‰ªªÊúüÂ∞è‰∫éÂΩìÂâç‰ªªÊúüÁõ¥Êé• breakÔºåÂõ†‰∏∫ Leader Âè™ËÉΩÂ∞ÜËá™Â∑±‰ªªÊúüÁöÑÊó•Âøó commitÔºåÂØπ‰∫éÂÖ∂‰ªñ‰ªªÊúüÁöÑÊó•ÂøóÔºåÂè™ËÉΩË¢´Âä® commit„ÄÇÂú® lab ‰∏≠ÔºåÊ≤°ÊúâÈúÄË¶Å Leader&lt;strong>ÂèäÊó∂&lt;/strong>Êõ¥Êñ∞Êóß commit ÁöÑÊÉÖÂÜµÔºåÊâÄ‰ª•‰∏çÂÅöÁâπÊÆäÂ§ÑÁêÜÔºàÂú®Êàê‰∏∫ Leader ÁöÑÊó∂ÂÄôÂèë‰∏Ä‰∏™Á©∫Êó•ÂøóÔºâ„ÄÇ&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="k">for&lt;/span> &lt;span class="nx">i&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">getLastLogL&lt;/span>&lt;span class="p">().&lt;/span>&lt;span class="nx">Index&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">i&lt;/span> &lt;span class="p">&amp;gt;&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">commitIndex&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">i&lt;/span>&lt;span class="o">--&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">logAt&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">i&lt;/span>&lt;span class="p">).&lt;/span>&lt;span class="nx">Term&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">currentTerm&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">break&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="nx">cnt&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="mi">1&lt;/span>
&lt;span class="k">for&lt;/span> &lt;span class="nx">p&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="k">range&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">peers&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="nx">p&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">me&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">matchIndex&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">p&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">&amp;gt;=&lt;/span> &lt;span class="nx">i&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">cnt&lt;/span>&lt;span class="o">++&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="nx">cnt&lt;/span> &lt;span class="p">&amp;gt;&lt;/span> &lt;span class="nb">len&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">peers&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">2&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">commitIndex&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">i&lt;/span>
&lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">applyWaker&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="mi">1&lt;/span>
&lt;span class="k">break&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="tips">Tips&lt;/h2>
&lt;ol>
&lt;li>Âú® currentTerm &amp;lt; args.Term ÁöÑÊó∂ÂÄôÔºåÊàë‰ª¨ÂÖ∂ÂÆûÊòØ‰∏çÈúÄË¶ÅÈáçÁΩÆÈÄâ‰∏æÊó∂Èó¥ÁöÑÔºåÂõ†‰∏∫Â¶ÇÊûúÂá∫Áé∞‰∫Ü‰∏Ä‰∏™ Leader ÊØîËá™Â∑±‰ªªÊúüÂ§ßÔºåËØ¥ÊòéËá™Â∑±Ê≤°ÊúâÁªô‰ªñÊäïËøáÁ•®Ôºå‰ΩÜ‰ªñÂæóÂà∞‰∫ÜÂçäÊï∞ËäÇÁÇπÁöÑÊîØÊåÅÔºåËØ¥ÊòéËá≥Â∞ëÂçäÊï∞ËäÇÁÇπÊúâÊàê‰∏∫ Candidate ÁöÑÊΩúË¥®ÔºåÂπ∂‰∏îÂ¶ÇÊûúËá™Â∑±ÁúüÁöÑÂºÄÂßãÈÄâ‰∏æÁöÑËØùÔºå‰ºöÂèëÈÄÅÊó†Áî®ÁöÑ RPCÔºåÈôç‰Ωé Raft ÁöÑËøêË°åÊïàÁéá„ÄÇ&lt;/li>
&lt;/ol>
&lt;blockquote>
&lt;p>If you follow the rule from Figure 2, the servers with the more up-to-date logs won‚Äôt be interrupted by outdated servers‚Äô elections, and so are more likely to complete the election and become the Leader.&lt;/p>
&lt;/blockquote>
&lt;ol start="2">
&lt;li>ÂèëÈÄÅ heartbeat ÁöÑÊó∂ÂÄôÈúÄË¶ÅÊ≥®ÊÑèËá™Â∑±ËøòÊòØ‰∏çÊòØ Leader„ÄÇ&lt;/li>
&lt;/ol>
&lt;p>Âõ†‰∏∫ÊàëÂøΩÁï•‰∫ÜËøô‰∏™ÁÇπÔºåÂØºËá¥ Leader crash ÂÜçÊÅ¢Â§çÁöÑÊó∂ÂÄôÊúâÂæàÂ∞èÁöÑÊ¶ÇÁéáÂá∫Áé∞‰∏Ä‰∏™ÊúâÁÇπÊÄ™ÁöÑ bugÔºöÊÅ¢Â§çÁöÑ‰∏ÄÁû¨Èó¥ÔºåLeader ÊÉ≥Â∞ÜËá™Â∑±ÁßØÁ¥ØÂ∑≤‰πÖÁöÑÊó•ÂøóÂèëÁªôÂÖ∂‰ªñËäÇÁÇπÔºåË¢´ÊãíÊî∂ÂêéÂèëÁé∞Ëá™Â∑±ÁöÑ term ËøáÊúü‰∫ÜÔºå‰∫éÊòØÂ∞ÜËá™Â∑±ËΩ¨‰∏∫ Follower‚Ä¶‚Ä¶ Â•ΩÂÉèÊ≤°‰ªÄ‰πàÈóÆÈ¢òÔºå‰ΩÜÊó†Ê≥ïÂÆåÊàê‰∏ÄËá¥ÊÄßÊ£ÄÈ™åÔºåÈÄöËøáÊâì log ÂèëÁé∞ Leader Âú®ËΩ¨‰∏∫ Follower ÂêéÁöÑ‰∏ÄÁû¨Èó¥ÂèëÈÄÅ‰∫ÜÊúÄÂêé‰∏ÄÊ≥¢ÂøÉË∑≥Ôºå‰∫éÊòØÊ£ÄÊü•‰ª£Á†ÅÔºåÂèëÁé∞ÊàëÂú®ÂèëÈÄÅÂøÉË∑≥Áªô‰∏çÂêåÁöÑ peer ÁöÑÊó∂ÂÄôÁî®ÁöÑÊòØ go routine Â•ó go routineÔºå&lt;strong>Êú™ËÉΩ‰øùËØÅÂéüÂ≠êÊìç‰Ωú&lt;/strong>ÔºåÂú®Â∞ÜË¶ÅÂèëÈÄÅÂøÉË∑≥ÁöÑÊó∂ÂÄôÔºåLeader Â∑≤Áªè‰∏çÂÜçÊòØ Leader ‰∫ÜÔºå‰ΩÜËøòÊòØÂÅöÂá∫‰∫Ü Leader ÁöÑË°å‰∏∫ÔºåÊâÄ‰ª•ÈúÄË¶ÅÂú®ÂèëÈÄÅÂâçÊ†∏È™åËá™Â∑±ÁöÑ Leader Ë∫´‰ªΩ„ÄÇ&lt;/p>
&lt;ol start="3">
&lt;li>Âú® updateCommit ÁöÑÊó∂ÂÄôÊàëÊÉ≥Áõ¥Êé•Âà§Êñ≠ÊàêÂäüËøîÂõû AppendEntries RPC ÁöÑ Follower Êï∞ÈáèÔºåÂ¶ÇÊûúË∂ÖËøá‰∏ÄÂçäÂ∞±Êõ¥Êñ∞ Leader commitIndex = lastLog.indexÔºå‰ΩÜÂõ†‰∏∫ÂèëÈÄÅÂíåÊé•Âèó RPC Âπ∂ÈùûÂéüÂ≠êÔºåÂèØËÉΩ‰ºöÂ≠òÂú®ÂâçÈù¢ÁöÑ Follower Êú™ÂåÖÂê´ÂêéÈù¢Êñ∞Â¢ûÁöÑ log ÁöÑÊÉÖÂÜµ„ÄÇ&lt;/li>
&lt;/ol>
&lt;blockquote>
&lt;p>If there exists an N such that N &amp;gt; commitIndex, a majority of matchIndex[i] ‚â• N, and log[N].term == currentTerm: set commitIndex = N (¬ß5.3, ¬ß5.4).&lt;/p>
&lt;/blockquote></description><category domain="https://loomt.top/posts/">posts</category><category domain="https://loomt.top/tags/raft/">Raft</category><category domain="https://loomt.top/tags/%E5%88%86%E5%B8%83%E5%BC%8F/">ÂàÜÂ∏ÉÂºè</category><category domain="https://loomt.top/tags/6.824/">6.824</category></item><item><title>6.824 Lab2A</title><link>https://loomt.top/posts/6.824-lab2a/</link><guid isPermaLink="true">https://loomt.top/posts/6.824-lab2a/</guid><pubDate>Fri, 03 Mar 2023 14:57:12 +0800</pubDate><author>loomt_@outlook.com (loomt)</author><copyright>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh)</copyright><description>&lt;h1 id="task">Task&lt;/h1>
&lt;p>ÂÆåÊàêÂêÑÁßçÊÉÖÂÜµÁöÑÈ¢ÜÂØº‰∫∫ÈÄâ‰∏æ„ÄÇ&lt;/p>
&lt;p>Êàë‰ª¨È¶ñÂÖàÈúÄË¶ÅÁÜüÊÇâ‰∏Ä‰∏ã Raft ÁöÑÂ∑•‰ΩúÂéüÁêÜÔºåÂª∫ËÆÆÂÖàËøá‰∏ÄÈÅç &lt;a href="https://loomt.top/posts/6.824-lab2">ÂâçÁΩÆËäùÂ£´&lt;/a>„ÄÇ&lt;/p>
&lt;h2 id="step">Step&lt;/h2>
&lt;ol>
&lt;li>ÂÖàÂÆåÂñÑ Raft ÁªìÊûÑÂíå Make ÂáΩÊï∞ÔºåÂÜçÁªìÂêà &lt;a href="http://thesecretlivesofdata.com/raft/">Gif&lt;/a> ÊÄùËÄÉÂçï‰∏™ËäÇÁÇπÁöÑÁä∂ÊÄÅ„ÄÇ&lt;/li>
&lt;li>ËäÇÁÇπÂºÄÂßãÊó∂ÁöÑÁä∂ÊÄÅÊòØ FollowerÔºåelection timeout ÂêéÔºåÁä∂ÊÄÅ‰ºöÊîπ‰∏∫ Candidate„ÄÇÊàë‰ª¨Â∫îËØ•Â¶Ç‰ΩïËÆæËÆ°ÈÄâ‰∏æË∂ÖÊó∂ÔºåÂΩìÁÑ∂ÊòØÂºÄ‰∏Ä‰∏™ go routine&lt;code>rf.ticker()&lt;/code> ÂØπË∂ÖÊó∂ËøõË°åÊ£ÄÊµã„ÄÇÈÇ£‰πàÊòØÁî®&lt;code>time.Sleep&lt;/code>ËøòÊòØ&lt;code>time.Timer&lt;/code>ÂÆûÁé∞Âë¢ÔºüÂÆòÊñπÁöÑÂª∫ËÆÆÊòØÁî® sleepÔºå‰ΩÜÊàëÁî®ÁöÑÊòØ timerÔºå‰πüËÉΩÂ§üÊ≠£Â∏∏ÂÆûÁé∞ÔºåÂπ∂‰∏îÊàëËøòÂÆûÁé∞‰∫Ü sleep ÁöÑÁâàÊú¨ÔºåÊÑüËßâÈÄüÂ∫¶‰∏äÁõ∏Â∑ÆÊó†Âá†„ÄÇ&lt;/li>
&lt;/ol>
&lt;ul>
&lt;li>ticker&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="kd">func&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">rf&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">Raft&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nf">ticker&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">for&lt;/span> &lt;span class="p">!&lt;/span>&lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">killed&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">select&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">case&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span>&lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">heartbeatTimer&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">C&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">mu&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Lock&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">state&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="nx">Leader&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">startHeartbeatL&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kc">true&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">heartbeatTimer&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Reset&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nf">getHeartbeatDuration&lt;/span>&lt;span class="p">())&lt;/span>
&lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">electionTimer&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Reset&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nf">getElectionDuration&lt;/span>&lt;span class="p">())&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">mu&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Unlock&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="k">case&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span>&lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">electionTimer&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">C&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">mu&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Lock&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">startElectionL&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">electionTimer&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Reset&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nf">getElectionDuration&lt;/span>&lt;span class="p">())&lt;/span>
&lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">mu&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Unlock&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ol start="3">
&lt;li>ËäÇÁÇπÊàê‰∏∫ Candidate ÂêéÂπ∂ÂèëÂèëÈÄÅ RequestVote RPCÔºåËá™Â∑±Â¶Ç‰ΩïÂ§ÑÁêÜ RPC ËøîÂõûÁöÑÁªìÊûúÔºåÂ¶Ç‰ΩïÂà§Êñ≠ÊäïÁªôËá™Â∑±ÁöÑËäÇÁÇπÊï∞ÈáèÊòØÂê¶Ë∂ÖËøáÂçäÊï∞Ôºü&lt;/li>
&lt;/ol>
&lt;ul>
&lt;li>Leader election&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">
&lt;span class="kd">func&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">rf&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">Raft&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nf">foraVote&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">peer&lt;/span> &lt;span class="kt">int&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">args&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">RequestVoteArgs&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">cnt&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="kt">int&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">reply&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">RequestVoteReply&lt;/span>&lt;span class="p">{}&lt;/span>
&lt;span class="nf">DPrintf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">dVote&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;S%v -&amp;gt; S%v send vote&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">me&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">peer&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">sendRequestVote&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">peer&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">args&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="nx">reply&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">mu&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Lock&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="k">defer&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">mu&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Unlock&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="nx">args&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Term&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">currentTerm&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">state&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="nx">Candidate&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="nx">reply&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">VoteGranted&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nf">DPrintf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">dVote&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;S%v &amp;lt;- S%v voted&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">me&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">peer&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="o">*&lt;/span>&lt;span class="nx">cnt&lt;/span>&lt;span class="o">++&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">cnt&lt;/span> &lt;span class="p">&amp;gt;&lt;/span> &lt;span class="nb">len&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">peers&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">2&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">for&lt;/span> &lt;span class="nx">i&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="k">range&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">peers&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">nextIndex&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">i&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">getLastLogL&lt;/span>&lt;span class="p">().&lt;/span>&lt;span class="nx">Index&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="mi">1&lt;/span>
&lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">matchIndex&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">i&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mi">0&lt;/span>
&lt;span class="nf">DPrintf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">dHeart&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;S%v &amp;lt;- S%v nextIndex:%v&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">me&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">i&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">nextIndex&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">i&lt;/span>&lt;span class="p">])&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">changeStateL&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">Leader&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span> &lt;span class="k">else&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="nx">reply&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Term&lt;/span> &lt;span class="p">&amp;gt;&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">currentTerm&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nf">DPrintf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">dVote&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;S%v &amp;lt;- S%v ~voted&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">me&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">peer&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">changeStateL&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">Follower&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">reply&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Term&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">NULL&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">persist&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ol start="4">
&lt;li>peer ËäÇÁÇπ‰ªéÂì™‰∫õÊñπÈù¢Â§ÑÁêÜÊäïÁ•®ÈÄªËæëÔºå‰ªªÊúüÔºüÊó•ÂøóÊÉÖÂÜµÔºà2BÔºâÔºü&lt;/li>
&lt;/ol>
&lt;ul>
&lt;li>Follower RequestVote RPC handler&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="kd">func&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">rf&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">Raft&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nf">RequestVote&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">args&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">RequestVoteArgs&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">reply&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">RequestVoteReply&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">mu&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Lock&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="k">defer&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">mu&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Unlock&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="k">defer&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">persist&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="c1">// currTerm higher || voted
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">currentTerm&lt;/span> &lt;span class="p">&amp;gt;&lt;/span> &lt;span class="nx">args&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Term&lt;/span> &lt;span class="o">||&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">votedFor&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="nx">NULL&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">currentTerm&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="nx">args&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Term&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">reply&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Term&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">reply&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">VoteGranted&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">currentTerm&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kc">false&lt;/span>
&lt;span class="k">return&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">currentTerm&lt;/span> &lt;span class="p">&amp;lt;&lt;/span> &lt;span class="nx">args&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Term&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">changeStateL&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">Follower&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">args&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Term&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">NULL&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="c1">// check log leader
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="c1">// candidate lastLogTerm to short || (lastLogTerm=rf.lastLogTerm &amp;amp;&amp;amp; candidate lastLogIndex to short)
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">getLastLogL&lt;/span>&lt;span class="p">().&lt;/span>&lt;span class="nx">Term&lt;/span> &lt;span class="p">&amp;gt;&lt;/span> &lt;span class="nx">args&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">LastLogTerm&lt;/span> &lt;span class="o">||&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">getLastLogL&lt;/span>&lt;span class="p">().&lt;/span>&lt;span class="nx">Term&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="nx">args&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">LastLogTerm&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">getLastLogL&lt;/span>&lt;span class="p">().&lt;/span>&lt;span class="nx">Index&lt;/span> &lt;span class="p">&amp;gt;&lt;/span> &lt;span class="nx">args&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">LastLogIndex&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">reply&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Term&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">reply&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">VoteGranted&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">currentTerm&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kc">false&lt;/span>
&lt;span class="k">return&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">changeStateL&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">Follower&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">args&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Term&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">args&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">CandidateId&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">electionTimer&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Reset&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nf">getElectionDuration&lt;/span>&lt;span class="p">())&lt;/span>
&lt;span class="nx">reply&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Term&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">reply&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">VoteGranted&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">currentTerm&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kc">true&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="tips">Tips&lt;/h2>
&lt;ol>
&lt;li>
&lt;p>Candidate ÈÄâ‰∏æÂâçË¶ÅÂÖàËá™Â¢û &lt;code>currentTerm&lt;/code>„ÄÇ&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Âú® 2A ‰∏≠ÔºåÊàë‰ª¨Â§ÑÁêÜ RequestVote Handler ÁöÑÊó∂ÂÄôËøò‰∏çÈúÄË¶ÅÂÖ≥Ê≥®Êó•ÂøóÁöÑÊñ∞ÊóßÔºà2BÔºâÔºårf.persist() ‰πüËøò‰∏çÈúÄË¶ÅÂÖ≥Ê≥®Ôºà2CÔºâÔºå‰ªÖÈúÄË¶ÅÊÄùËÄÉ‰ªªÊúüÂ∫îËØ•Â¶Ç‰ΩïÂ§ÑÁêÜ„ÄÇ&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Âõ†‰∏∫Â§ÑÁêÜÊäïÁ•® RPC ÁöÑËøîÂõûÊó∂ÈúÄË¶ÅÂä†ÈîÅ‰øùËØÅ rf ÁªìÊûÑÁöÑÂéüÂ≠êËØªÂèñÂíåÂÜôÂÖ•ÔºåÈ°∫‰æøÂ∞±ÂèØ‰ª•ËøõË°åÊäïÁ•®Êï∞ÈáèÁöÑËÆ°Êï∞„ÄÇ&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Candidate Êàê‰∏∫ Leader Êó∂ÔºåÈúÄË¶ÅÂèäÊó∂ÂèëÈÄÅ heartbeatÔºåÂëäËØâÂà´‰∫∫Ëá™Â∑±ÊòØËÄÅÂ§ßÔºåÈòªÊ≠¢‰ªñ‰ª¨ÁöÑÈÄâ‰∏æ„ÄÇ&lt;/p>
&lt;/li>
&lt;li>
&lt;p>heartbeat È¢ëÁéá‰∏çËÉΩÂ§™È´òÔºåÊéßÂà∂Âú®ÊØèÁßí 10 Ê¨°‰ª•ÂÜÖÔºåÂê¶Âàô‰ºöÁ™ÅÁÑ∂ÂÆïÊú∫Ôºà‰ΩÜÂÖ∂ÂÆûÊàë‰∫≤Êµã heartbeatTimeout ËÆæ‰∏∫ 60msÔºåelection ËÆæ‰∏∫ rand(180)+180Ôºåtest ‰∫Ü 1k Ê¨°Ê≤°‰∏ÄÊ¨°ÊòØ fail ÁöÑÔºâ„ÄÇ&lt;/p>
&lt;blockquote>
&lt;p>The paper&amp;rsquo;s Section 5.2 mentions election timeouts in the range of 150 to 300 milliseconds. Such a range only makes sense if the Leader sends heartbeats considerably more often than once per 150 milliseconds (e.g., once per 10 milliseconds). Because the tester limits you tens of heartbeats per second, you will have to use an election timeout larger than the paper&amp;rsquo;s 150 to 300 milliseconds, but not too large, because then you may fail to elect a Leader within five seconds.&lt;/p>
&lt;/blockquote>
&lt;/li>
&lt;/ol></description><category domain="https://loomt.top/posts/">posts</category><category domain="https://loomt.top/tags/raft/">Raft</category><category domain="https://loomt.top/tags/%E5%88%86%E5%B8%83%E5%BC%8F/">ÂàÜÂ∏ÉÂºè</category><category domain="https://loomt.top/tags/6.824/">6.824</category></item><item><title>6.824 Lab2</title><link>https://loomt.top/posts/6.824-lab2/</link><guid isPermaLink="true">https://loomt.top/posts/6.824-lab2/</guid><pubDate>Sat, 04 Feb 2023 18:09:59 +0800</pubDate><author>loomt_@outlook.com (loomt)</author><copyright>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh)</copyright><description>&lt;h1 id="raft">Raft&lt;/h1>
&lt;p>Raft ÊòØ‰∏Ä‰∏™ÂÆûÁé∞ÂàÜÂ∏ÉÂºèÂÖ±ËØÜÁöÑÂçèËÆÆÔºå‰∏ªË¶ÅËß£ÂÜ≥ÁöÑÊòØÂàÜÂ∏ÉÂºè‰∏ÄËá¥ÊÄßÁöÑÈóÆÈ¢ò„ÄÇ&lt;/p>
&lt;h2 id="overview">Overview&lt;/h2>
&lt;p>ÂÅáËÆæÁé∞Âú®Êúâ‰∏Ä‰∏™ Raft Êû∂ÊûÑÁöÑÊúçÂä°„ÄÇÊàë‰ª¨Â∞ÜËøô‰∏™ÊúçÂä°ÂàÜ‰∏∫‰∏âÂ±ÇÔºåClientÔºåServiceÔºåRaft„ÄÇClient Â±ÇÈ¶ñÂÖàÂèëÈÄÅËØ∑Ê±ÇÁªô Service Â±ÇÔºåÁÑ∂Âêé Service Â±ÇËß£ÊûêËØ∑Ê±Ç‰∏∫&lt;code>command&lt;/code>ÔºåÂ∞Ü&lt;code>command&lt;/code>ÂèëÈÄÅÁªô Raft Â±ÇÁöÑ Leader„ÄÇLeader Âú®‰∏ÄÂÆöÊó∂Èó¥ÂÜÖÈÄöÁü• Service Â±Ç &amp;ldquo;apply&amp;rdquo; ÂåÖÂê´Ëøô‰∏™&lt;code>command&lt;/code>ÁöÑÊó•ÂøóÔºåService Â±ÇÊâçÂèØ‰ª•Â∞ÜËøôÊù°Êó•Âøó‰øùÂ≠òÂà∞Áä∂ÊÄÅÊú∫ÔºåËøõËÄåËøîÂõûÂØπÂ∫îÁöÑÁªìÊûúÁªô Client Â±Ç„ÄÇÂπ∂‰∏îÂõ†‰∏∫ Raft Â±Ç‰∏çÂ∫îËØ•Â≠òÂÇ®ËøáÂ§öÁöÑ logÔºåÊâÄ‰ª• Service Â±ÇËøò‰ºöÂ∞Ü applied ÁöÑ log ÂéãÁº©ÊàêÂø´ÁÖßÔºå‰ª•‰æøÂø´ÈÄüÂ∫îÁî®„ÄÇ&lt;/p>
&lt;p>Êàë‰ª¨ÁöÑ‰ªªÂä°Â∞±ÊòØÁî® go ÂÆûÁé∞Âü∫Á°ÄÁöÑ Raft Â±ÇÊû∂ÊûÑ„ÄÇ&lt;/p>
&lt;ul>
&lt;li>È¢ÜÂØº‰∫∫ÈÄâ‰∏æ&lt;/li>
&lt;/ul>
&lt;ol>
&lt;li>ÊúÄÂàùÔºåÊâÄÊúâ Raft ËäÇÁÇπÈÉΩÊòØ FollowerÔºåÂ¶ÇÊûúÂú®&lt;code>election timeout&lt;/code>ÂÜÖÊú™Êî∂Âà∞ÂΩìÂâç&lt;code>term&lt;/code>ÁöÑ&lt;code>heartbeat&lt;/code>ÔºåÂ∞±‰ºöËΩ¨‰∏∫ Candidate„ÄÇ
&lt;ul>
&lt;li>&lt;code>election timeout&lt;/code>: ÈÄâ‰∏æË∂ÖÊó∂Êó∂Èó¥„ÄÇÂ§ßÊ¶ÇÊòØ&lt;code>heartbeat timeout&lt;/code>ÁöÑ 3 ÂÄç„ÄÇ&lt;/li>
&lt;li>&lt;code>term&lt;/code>Ôºö‰ªªÊúü„ÄÇÊØè‰∏™Áî®‰∫éÂÆûÁé∞‰∏ÄËá¥ÊÄßÂÖ±ËØÜ„ÄÇ&lt;/li>
&lt;li>&lt;code>heartbeat&lt;/code>ÔºöÂøÉË∑≥„ÄÇRaft ËäÇÁÇπÊúâ‰∏âÁßçÁä∂ÊÄÅÔºöFollowerÔºåCandidateÔºåLeader„ÄÇLeader ‰∏∫‰∫ÜÁª¥ÊåÅËá™Â∑±ÁöÑÈ¢ÜÂØºÔºåÈúÄË¶ÅÊØèÈöî‰∏ÄÊÆµÊó∂Èó¥ÂèëÈÄÅ‰∏ÄÊ¨°ÂøÉË∑≥„ÄÇ&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>ËΩ¨‰∏∫ Candidate ‰πãÂêéÔºå&lt;code>term++&lt;/code>ÔºåÁªôËá™Â∑±ÊäïÁ•®ÔºåÂπ∂ÂèëÈÄÅËØ∑Ê±ÇÊäïÁ•®ÁöÑ RPC Áªô peer ËäÇÁÇπ„ÄÇ&lt;/li>
&lt;li>Êî∂Âà∞ËØ∑Ê±Ç RPC ÁöÑ peer Êª°Ë∂≥‰ª•‰∏ã‰∏§‰∏™Êù°‰ª∂ÊâçÂèØ‰ª•ÊäïÁ•®Ôºö
&lt;ul>
&lt;li>peer ‰ªªÊúüÂ∞è‰∫é Candidate ÁöÑ‰ªªÊúüÊàñËÄÖ peer ‰ªªÊúüÁ≠â‰∫é Candidate Âπ∂‰∏îÂΩìÂâç‰ªªÊúüÊ≤°ÊäïËøá„ÄÇ&lt;/li>
&lt;li>peer ÁöÑ log Ê≤°Êúâ Candidate Êñ∞„ÄÇ&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Candidate ÂæóÂà∞ÁöÑÁ•®Êï∞Ë∂ÖËøáÂçäÊï∞ÁöÑ peer Â∞±ÂèØ‰ª•Êàê‰∏∫ LeaderÔºåÂõ†‰∏∫‰∏äËø∞ÈôêÂà∂Ôºå‰∏Ä‰∏™ÈõÜÁæ§Âêå‰∏Ä‰∏™&lt;code>term&lt;/code>Âè™‰ºöÈÄâÂá∫‰∏Ä‰∏™ Leader„ÄÇ&lt;/li>
&lt;li>Leader ÊØèÈöî‰∏ÄÊ¨°&lt;code>heartbeat timeout&lt;/code>Â∞±ÂèëÈÄÅ‰∏ÄÊ¨°ÂåÖÂê´ snapshot Êàñ log ÁöÑ heartbeatÔºåÂèëÈÄÅÂø´ÁÖßËøòÊòØÊó•ÂøóÊ†πÊçÆ peer ÁöÑ &lt;code>nextIndex&lt;/code> ËÄåÂÆö„ÄÇ
&lt;ul>
&lt;li>&lt;code>nextIndex&lt;/code> ÊòØ Leader ÂØπ peer Êó•ÂøóÈïøÂ∫¶ÁöÑ‰πêËßÇÊé®ÊµãÔºåÊàê‰∏∫ Leader Âêé‰ºöÂØπÊâÄÊúâ peer ÁöÑ &lt;code>nextIndex&lt;/code> ËµãÂÄº‰∏∫Ëá™Â∑±ÁöÑ &lt;code>lastLogIndex+1&lt;/code>ÔºåËÄåÂêé‰ºöÊ†πÊçÆ heartbeat ÁªìÊûúÊõ¥Êîπ &lt;code>nextIndex&lt;/code>„ÄÇ&lt;/li>
&lt;li>&lt;code>lastIncludeIndex&lt;/code> ÊØè‰∏™ËäÇÁÇπÈÉΩÊúâÔºåË°®Á§∫ snapshot ÂåÖÂê´ÁöÑÊúÄÂêé‰∏Ä‰∏™Êó•ÂøóÁöÑ‰∏ãÊ†áÔºåÂàùÂßã‰∏∫ 0„ÄÇ&lt;/li>
&lt;li>Â¶ÇÊûú $nextIndex \leq lastIncludedIndex$ ÔºåÂèëÈÄÅ InstallSnapshot RPCÔºåÂê¶ÂàôÂèëÈÄÅ AppendEntries RPC„ÄÇ&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Follower ÈúÄË¶ÅÂØπ Leader ÂèëÈÄÅÁöÑÂøÉË∑≥ËøõË°åÂ§ÑÁêÜ„ÄÇ&lt;/li>
&lt;/ol>
&lt;ul>
&lt;li>Êó•ÂøóÂ§çÂà∂&lt;/li>
&lt;/ul>
&lt;ol>
&lt;li>
&lt;p>Service Â±Ç‰ºöÈÄöËøá Start(cmd) ÂèëÈÄÅ command Áªô Leader„ÄÇ&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Leader ÈúÄË¶Å‰øùÂ≠ò command Ëá≥ logÔºåÂπ∂Âú®ÂøÉË∑≥ÁöÑÊó∂ÂÄôÂêë Follower ÂèëÈÄÅ‰ªñÊ≤°ÊúâÁöÑ log„ÄÇ&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Leader Á≠âÂæÖ‰∏ÄÂçä‰ª•‰∏äÁöÑ Follower ÂÜôÂÖ•Ëá™Â∑±ÁöÑÊó•ÂøóÔºåÂÜçËøõË°å commit„ÄÇ&lt;/p>
&lt;ul>
&lt;li>Âà§Êñ≠ Follower ÂÜôÂÖ•Êó•ÂøóÁöÑÊ†áÂáÜÊòØ &lt;code>matchIndex&lt;/code>Ôºå‰∏äÈù¢ÊúâÊèêÂà∞ &lt;code>nextIndex&lt;/code> ÊòØ Leader ÂØπ peer Êó•ÂøóÈïøÂ∫¶ÁöÑ‰πêËßÇÊé®ÊµãÔºå&lt;code>matchIndex&lt;/code> ÂàôÊòØÁõ∏ÂØπÊÇ≤ËßÇÁöÑÊé®ÊµãÔºåÂè™ÊúâÂú® AppendEntries RPC ËøîÂõûÊàêÂäüÂêé Leader Êâç‰ºöÊõ¥Êñ∞Áõ∏Â∫î Follower ÁöÑ &lt;code>matchIndex&lt;/code>„ÄÇ&lt;/li>
&lt;li>Âπ∂‰∏îËÄÉËôë RPC Ë∞ÉÁî®ÁöÑÈùûÁ∫øÊÄßËøîÂõûÔºåÈúÄË¶ÅÂú®‰øÆÊîπ &lt;code>matchIndex&lt;/code> ÁöÑÊó∂ÂÄôÂà§Êñ≠ÈúÄË¶Å‰øÆÊîπÁöÑÂÄºÊòØÂê¶ÁúüÁöÑÂ§ß‰∫éÂΩìÂâçÁöÑ &lt;code>matchIndex&lt;/code> ÁöÑÂÄº„ÄÇ&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>Leader commit Âêé‰øÆÊîπ &lt;code>commitIndex&lt;/code> ÁöÑÂÄºÔºåÂπ∂Âè¶ÂºÄ‰∏Ä‰∏™ go routine Â∞Ü‰ªé&lt;code>lastApplied+1&lt;/code> Âà∞ &lt;code>commitIndex&lt;/code> ÁöÑÂÄºÊé®Âà∞ &lt;code>applyCh&lt;/code>ÔºåÂÜç‰øÆÊîπ&lt;code>lastApplied = commitIndex&lt;/code>„ÄÇ&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Follower Âú® Leader commit Âêé‰πü‰ºö‰ª• Leader ÁöÑ commitIndex ‰Ωú‰∏∫ÈôêÂà∂ commit Ëá™Â∑±ÁöÑ logÔºåÂπ∂Âíå Leader ‰∏ÄÊ†∑ÔºåÂ∞ÜÊó•Âøó‰∫§Áªô service apply„ÄÇ&lt;/p>
&lt;/li>
&lt;/ol>
&lt;ul>
&lt;li>Êó•ÂøóÂéãÁº©&lt;/li>
&lt;/ul>
&lt;ol>
&lt;li>Service Â±ÇÂú®Ëã•Âπ≤ commit ÂêéÔºå‰ºöÂéãÁº©Â∑≤Êèê‰∫§ÁöÑÊó•ÂøóÔºåÂπ∂ÈÄöËøá Snapshot(index,snapshot) ÊèêÈÜí raft Â±Ç„ÄÇ&lt;/li>
&lt;li>raft Â±ÇÂàôÈúÄË¶ÅËøõË°å‰∏Ä‰∫õÂ§ÑÁêÜÔºåÊØîÂ¶ÇÂà†ÊéâË¢´ÂéãÁº©ÁöÑÊó•ÂøóÔºåÊîπÂèòÊó•ÂøóÁöÑÁ¥¢ÂºïÊñπÂºèÔºåÊåÅ‰πÖÂåñ snapshot ÁöÑ‰ø°ÊÅØÔºà‰ΩÜ‰∏çÈúÄË¶Å‰øùÂ≠ò snapshotÔºåsnapshot ‰ªÖÂ≠òÂú® Service Â±ÇÔºâ„ÄÇ&lt;/li>
&lt;li>ÂØπ‰∫é LeaderÔºåÂú® heartbeat Êó∂ÔºåËã•Êª°Ë∂≥ $nextIndex \leq lastIncludedIndex$ ÔºåÂàôÈÄöËøá &lt;code>persister.ReadSnapshot()&lt;/code> ËØªÂèñ snapshot Áªô Follower„ÄÇ&lt;/li>
&lt;li>Â¶ÇÊûú Follower term &amp;lt;= Leader termÔºåÂè™ËÉΩÊé•Âèó snapshotÔºåÂπ∂Âà†ÊéâË¢´ÂéãÁº©ÁöÑÊó•ÂøóÔºåÊîπÂèòÊó•ÂøóÁöÑÁ¥¢ÂºïÊñπÂºèÔºåÊåÅ‰πÖÂåñ snapshot ÁöÑ‰ø°ÊÅØ„ÄÇ&lt;/li>
&lt;/ol>
&lt;h3 id="tips">Tips&lt;/h3>
&lt;ol>
&lt;li>
&lt;p>Ê≥®ÊÑè data raceÔºåÂØπÂ§ßÈÉ®ÂàÜ rf ÁªìÊûÑÁöÑ‰øÆÊîπÂíåËØªÂèñÈÉΩË¶Å‰∏äÈîÅ„ÄÇ&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ÊâÄÊúâ RPC ÈÉΩË¶ÅÊ£ÄÊµã‰ªªÊúüÔºåÂπ∂ÂØπËøáÊúüÁä∂ÊÄÅËøõË°åÂ§ÑÁêÜ„ÄÇ&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Âú® lab2D ‰∏≠ÔºåÈúÄË¶ÅÊîπÂèò‰∏ãÊ†áÁöÑÁ¥¢ÂºïÊñπÂºè„ÄÇ&lt;/p>
&lt;/li>
&lt;/ol>
&lt;blockquote>
&lt;p>Each log entry also has an integer index iden-tifying its position in the log.&lt;/p>
&lt;/blockquote>
&lt;p>‰ΩÜËøô‰∏™ÂÖ∂ÂÆûÂæàÂÆπÊòìÊîπÔºåÊâÄ‰ª•Êé®ËçêÂú® 2D ‰πãÂâç‰∏çË¶ÅÂéªÁÆ°‰∏ãÊ†áÁöÑÈóÆÈ¢òÔºåÁõ¥Êé•Áî® log Êï∞ÁªÑËá™Â∑±ÁöÑ‰∏ãÊ†áÂ∞±ÂèØ‰ª•‰∫Ü„ÄÇ&lt;/p>
&lt;h3 id="struct">struct&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;span class="lnt">44
&lt;/span>&lt;span class="lnt">45
&lt;/span>&lt;span class="lnt">46
&lt;/span>&lt;span class="lnt">47
&lt;/span>&lt;span class="lnt">48
&lt;/span>&lt;span class="lnt">49
&lt;/span>&lt;span class="lnt">50
&lt;/span>&lt;span class="lnt">51
&lt;/span>&lt;span class="lnt">52
&lt;/span>&lt;span class="lnt">53
&lt;/span>&lt;span class="lnt">54
&lt;/span>&lt;span class="lnt">55
&lt;/span>&lt;span class="lnt">56
&lt;/span>&lt;span class="lnt">57
&lt;/span>&lt;span class="lnt">58
&lt;/span>&lt;span class="lnt">59
&lt;/span>&lt;span class="lnt">60
&lt;/span>&lt;span class="lnt">61
&lt;/span>&lt;span class="lnt">62
&lt;/span>&lt;span class="lnt">63
&lt;/span>&lt;span class="lnt">64
&lt;/span>&lt;span class="lnt">65
&lt;/span>&lt;span class="lnt">66
&lt;/span>&lt;span class="lnt">67
&lt;/span>&lt;span class="lnt">68
&lt;/span>&lt;span class="lnt">69
&lt;/span>&lt;span class="lnt">70
&lt;/span>&lt;span class="lnt">71
&lt;/span>&lt;span class="lnt">72
&lt;/span>&lt;span class="lnt">73
&lt;/span>&lt;span class="lnt">74
&lt;/span>&lt;span class="lnt">75
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="kd">const&lt;/span> &lt;span class="nx">NULL&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>
&lt;span class="kd">const&lt;/span> &lt;span class="p">(&lt;/span>
&lt;span class="nx">_&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="kc">iota&lt;/span>
&lt;span class="nx">Follower&lt;/span>
&lt;span class="nx">Candidate&lt;/span>
&lt;span class="nx">Leader&lt;/span>
&lt;span class="p">)&lt;/span>
&lt;span class="kd">type&lt;/span> &lt;span class="nx">ApplyMsg&lt;/span> &lt;span class="kd">struct&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">CommandValid&lt;/span> &lt;span class="kt">bool&lt;/span>
&lt;span class="nx">Command&lt;/span> &lt;span class="kd">interface&lt;/span>&lt;span class="p">{}&lt;/span>
&lt;span class="nx">CommandIndex&lt;/span> &lt;span class="kt">int&lt;/span>
&lt;span class="nx">SnapshotValid&lt;/span> &lt;span class="kt">bool&lt;/span>
&lt;span class="nx">Snapshot&lt;/span> &lt;span class="p">[]&lt;/span>&lt;span class="kt">byte&lt;/span>
&lt;span class="nx">SnapshotTerm&lt;/span> &lt;span class="kt">int&lt;/span>
&lt;span class="nx">SnapshotIndex&lt;/span> &lt;span class="kt">int&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="kd">type&lt;/span> &lt;span class="nx">Entry&lt;/span> &lt;span class="kd">struct&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">Command&lt;/span> &lt;span class="kd">interface&lt;/span>&lt;span class="p">{}&lt;/span> &lt;span class="c1">// Command for state machine
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="nx">Term&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="c1">// Command received Term
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="nx">Index&lt;/span> &lt;span class="kt">int&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="c1">// A Go object implementing a single Raft peer.
&lt;/span>&lt;span class="c1">&lt;/span>&lt;span class="kd">type&lt;/span> &lt;span class="nx">Raft&lt;/span> &lt;span class="kd">struct&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">mu&lt;/span> &lt;span class="nx">sync&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Mutex&lt;/span> &lt;span class="c1">// Lock to protect shared access to this peer&amp;#39;s state
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="nx">peers&lt;/span> &lt;span class="p">[]&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="nx">labrpc&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">ClientEnd&lt;/span> &lt;span class="c1">// RPC end points of all peers
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="nx">persister&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">Persister&lt;/span> &lt;span class="c1">// Object to hold this peer&amp;#39;s persisted state
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="nx">me&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="c1">// this peer&amp;#39;s index into peers[]
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="nx">dead&lt;/span> &lt;span class="kt">int32&lt;/span> &lt;span class="c1">// set by Kill()
&lt;/span>&lt;span class="c1">&lt;/span>
&lt;span class="c1">// Persistent state
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="nx">currentTerm&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="c1">// 0...
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="nx">votedFor&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="c1">// null if none
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="nx">log&lt;/span> &lt;span class="p">[]&lt;/span>&lt;span class="nx">Entry&lt;/span> &lt;span class="c1">// index 1...
&lt;/span>&lt;span class="c1">&lt;/span>
&lt;span class="c1">// Volatile state
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="nx">commitIndex&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="c1">// most of the server has been replicated and durable, 0...
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="nx">lastApplied&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="c1">// highest entry applied to state machine, 0...
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="nx">state&lt;/span> &lt;span class="kt">int&lt;/span>
&lt;span class="nx">heartbeatTimer&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">time&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Timer&lt;/span>
&lt;span class="nx">electionTimer&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">time&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Timer&lt;/span>
&lt;span class="nx">applyCh&lt;/span> &lt;span class="kd">chan&lt;/span> &lt;span class="nx">ApplyMsg&lt;/span>
&lt;span class="nx">applyWaker&lt;/span> &lt;span class="kd">chan&lt;/span> &lt;span class="kt">int&lt;/span>
&lt;span class="c1">// for leader (reinitialized after election)
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="nx">nextIndex&lt;/span> &lt;span class="p">[]&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="c1">// last log index+1...
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="nx">matchIndex&lt;/span> &lt;span class="p">[]&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="c1">// highest log entry be replicated on server, 0..., update: PrevLogIndex+len(Entries)
&lt;/span>&lt;span class="c1">&lt;/span>&lt;span class="p">}&lt;/span>
&lt;span class="kd">func&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">rf&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">Raft&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nf">lastIncludedTerm&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">log&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">].&lt;/span>&lt;span class="nx">Term&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="kd">func&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">rf&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">Raft&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nf">lastIncludedIndex&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">log&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">].&lt;/span>&lt;span class="nx">Index&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="kd">func&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">rf&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">Raft&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nf">setLastIncludedTerm&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">term&lt;/span> &lt;span class="kt">int&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">log&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">].&lt;/span>&lt;span class="nx">Term&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">term&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="kd">func&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">rf&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">Raft&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nf">setLastIncludedIndex&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">index&lt;/span> &lt;span class="kt">int&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">rf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">log&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">].&lt;/span>&lt;span class="nx">Index&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">index&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="kd">func&lt;/span> &lt;span class="nf">getHeartbeatDuration&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="nx">time&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Duration&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="nx">time&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Millisecond&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="mi">60&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="kd">func&lt;/span> &lt;span class="nf">getElectionDuration&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="nx">time&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Duration&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="nx">time&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Millisecond&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="nx">time&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Duration&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">rand&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Int31n&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">180&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="mi">180&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="res">res&lt;/h3>
&lt;p>&lt;img src="https://loomt.top/img/824lab2.png" alt="res">&lt;/p>
&lt;p>&lt;em>&lt;strong>reference&lt;/strong>&lt;/em>&lt;/p>
&lt;p>&lt;a href="https://thesquareplanet.com/blog/students-guide-to-raft/">https://thesquareplanet.com/blog/students-guide-to-raft/&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://pdos.csail.mit.edu/6.824/papers/raft-extended.pdf">https://pdos.csail.mit.edu/6.824/papers/raft-extended.pdf&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://pdos.csail.mit.edu/6.824/notes/raft_diagram.pdf">https://pdos.csail.mit.edu/6.824/notes/raft_diagram.pdf&lt;/a>&lt;/p>
&lt;p>&lt;a href="http://thesecretlivesofdata.com/raft/">http://thesecretlivesofdata.com/raft/&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://pdos.csail.mit.edu/6.824/labs/raft-structure.txt">https://pdos.csail.mit.edu/6.824/labs/raft-structure.txt&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://pdos.csail.mit.edu/6.824/labs/raft-locking.txt">https://pdos.csail.mit.edu/6.824/labs/raft-locking.txt&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://blog.josejg.com/debugging-pretty/">https://blog.josejg.com/debugging-pretty/&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://flaneur2020.github.io/2020/11/07/mit6-824-raft/">https://flaneur2020.github.io/2020/11/07/mit6-824-raft/&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://github.com/OneSizeFitsQuorum/MIT6.824-2021/blob/master/docs/lab2.md">https://github.com/OneSizeFitsQuorum/MIT6.824-2021/blob/master/docs/lab2.md&lt;/a>&lt;/p></description><category domain="https://loomt.top/posts/">posts</category><category domain="https://loomt.top/tags/raft/">Raft</category><category domain="https://loomt.top/tags/%E5%88%86%E5%B8%83%E5%BC%8F/">ÂàÜÂ∏ÉÂºè</category><category domain="https://loomt.top/tags/6.824/">6.824</category></item><item><title>6.824 Lab1</title><link>https://loomt.top/posts/6.824-lab1/</link><guid isPermaLink="true">https://loomt.top/posts/6.824-lab1/</guid><pubDate>Fri, 03 Feb 2023 23:25:54 +0800</pubDate><author>loomt_@outlook.com (loomt)</author><copyright>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh)</copyright><description>&lt;h2 id="lab1-mapreduce">Lab1 MapReduce&lt;/h2>
&lt;h3 id="paper">Paper&lt;/h3>
&lt;p>&lt;a href="https://pdos.csail.mit.edu/6.824/papers/mapreduce.pdf">MapReduce: Simplified Data Processing on Large Clusters&lt;/a>&lt;/p>
&lt;p>MapReduce Â∞ÜÂàÜÂ∏ÉÂºèÁ≥ªÁªüÂ§ÑÁêÜÊï∞ÊçÆÁöÑÁªÜËäÇÔºàÂπ∂Ë°å„ÄÅÂÆπÈîô„ÄÅÂ±ÄÈÉ®ÊÄß‰ºòÂåñ„ÄÅË¥üËΩΩÂùáË°°Á≠âÔºâÈöêËóèËµ∑Êù•ÔºåÊèê‰æõ‰∏ÄÂ•óÁÆÄÂåñÊñπÊ°àÔºåËß£ÂÜ≥‰∫ÜÂú®Â§öÂè∞Êú∫Âô®Â§ÑÁêÜÂ§ßÈáèÈÄªËæëÁÆÄÂçïÁöÑËÆ°ÁÆóÔºàÂàÜÂ∏ÉÂºèËÆ°ÁÆóÔºâÂÆûÁé∞Â§çÊùÇÁöÑÈóÆÈ¢ò„ÄÇ&lt;/p>
&lt;h3 id="ÂÆûÁé∞">ÂÆûÁé∞&lt;/h3>
&lt;p>Êú¨ÂÆûÈ™åÂèØ‰ª•Áî± 1 ‰∏™ coordinator/master Ë∞ÉÂ∫¶Ëã•Âπ≤‰∏™ worker„ÄÇÂÖàÂÆåÊàêÊâÄÊúâ map ‰ªªÂä°ÔºåÁîüÊàê‰∏≠Èó¥ÈîÆÂÄºÂØπÂπ∂Â∞ÜÂÖ∂Â≠òÂú®‰∏≠Èó¥Êñá‰ª∂ÂêéÂÜçËøõË°å reduce ‰ªªÂä°ÔºåÊúÄÂêéÂ∞Ü reduce ‰ªªÂä°ÁöÑÁªìÊûúËæìÂá∫Âà∞ÊñáÊú¨„ÄÇ&lt;/p>
&lt;p>ÈúÄË¶ÅÊàë‰ª¨‰øÆÊîπÁöÑÊñá‰ª∂‰∏∫ &lt;code>mr/*&lt;/code>&lt;/p>
&lt;ol>
&lt;li>worker ÈÄöËøá RPC Âæ™ÁéØËØ∑Ê±Ç‰ªªÂä°„ÄÇ&lt;/li>
&lt;li>coordinator ËØªÂèñ 8 ‰∏™ÁªôÂÆöÁöÑÊñá‰ª∂ÂàÜÁªô‰∏çÂêåÁöÑ worker ËøõË°å map ‰ªªÂä°ÔºåËøôÈÉ®ÂàÜÂ¶ÇÊûúÂñúÊ¨¢‰πüÂèØ‰ª•ÊåâÂõ∫ÂÆö bytes ËøõË°åÂàáÂâ≤&lt;del>‰ΩÜÊàëÊáíÂæóÂ§ÑÁêÜ‰∫Ü&lt;/del>„ÄÇ&lt;/li>
&lt;li>worker ËØªÂèñÊñá‰ª∂Âπ∂ÊâîÁªô&lt;code>fmap&lt;/code>ËøõË°åÂ§ÑÁêÜÔºåÁîüÊàê‰∏≠Èó¥ÈîÆÂÄºÂØπÔºåËÆ°ÁÆóÂ≠óÁ¨¶‰∏≤ÁöÑ hash ÂêéÂ∞Ü&lt;code>key-intermediate_value&lt;/code>Â≠òÂú® &lt;code>mr-taskid-ihash(str)&lt;/code> ÈáåÈù¢„ÄÇ&lt;/li>
&lt;/ol>
&lt;blockquote>
&lt;p>fmap ÂáΩÊï∞ÈÄöËøáÁºñËØëÁîüÊàêÁöÑ *.so Ë∞ÉÁî®&lt;/p>
&lt;/blockquote>
&lt;style type="text/css">.notice{--root-color:#444;--root-background:#eff;--title-color:#fff;--title-background:#7bd;--warning-title:#c33;--warning-content:#fee;--info-title:#fb7;--info-content:#fec;--note-title:#6be;--note-content:#e7f2fa;--tip-title:#5a5;--tip-content:#efe}@media (prefers-color-scheme:dark){.notice{--root-color:#ddd;--root-background:#eff;--title-color:#fff;--title-background:#7bd;--warning-title:#800;--warning-content:#400;--info-title:#a50;--info-content:#420;--note-title:#069;--note-content:#023;--tip-title:#363;--tip-content:#121}}body.dark .notice{--root-color:#ddd;--root-background:#eff;--title-color:#fff;--title-background:#7bd;--warning-title:#800;--warning-content:#400;--info-title:#a50;--info-content:#420;--note-title:#069;--note-content:#023;--tip-title:#363;--tip-content:#121}.notice{padding:18px;line-height:24px;margin-bottom:24px;border-radius:4px;color:var(--root-color);background:var(--root-background)}.notice p:last-child{margin-bottom:0}.notice-title{margin:-18px -18px 12px;padding:4px 18px;border-radius:4px 4px 0 0;font-weight:700;color:var(--title-color);background:var(--title-background)}.notice.warning .notice-title{background:var(--warning-title)}.notice.warning{background:var(--warning-content)}.notice.info .notice-title{background:var(--info-title)}.notice.info{background:var(--info-content)}.notice.note .notice-title{background:var(--note-title)}.notice.note{background:var(--note-content)}.notice.tip .notice-title{background:var(--tip-title)}.notice.tip{background:var(--tip-content)}.icon-notice{display:inline-flex;align-self:center;margin-right:8px}.icon-notice img,.icon-notice svg{height:1em;width:1em;fill:currentColor}.icon-notice img,.icon-notice.baseline svg{top:.125em;position:relative}&lt;/style>
&lt;div>&lt;svg width="0" height="0" display="none" xmlns="http://www.w3.org/2000/svg">&lt;symbol id="tip-notice" viewBox="0 0 512 512" preserveAspectRatio="xMidYMid meet">&lt;path d="M504 256c0 136.967-111.033 248-248 248S8 392.967 8 256 119.033 8 256 8s248 111.033 248 248zM227.314 387.314l184-184c6.248-6.248 6.248-16.379 0-22.627l-22.627-22.627c-6.248-6.249-16.379-6.249-22.628 0L216 308.118l-70.059-70.059c-6.248-6.248-16.379-6.248-22.628 0l-22.627 22.627c-6.248 6.248-6.248 16.379 0 22.627l104 104c6.249 6.249 16.379 6.249 22.628.001z"/>&lt;/symbol>&lt;symbol id="note-notice" viewBox="0 0 512 512" preserveAspectRatio="xMidYMid meet">&lt;path d="M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"/>&lt;/symbol>&lt;symbol id="warning-notice" viewBox="0 0 576 512" preserveAspectRatio="xMidYMid meet">&lt;path d="M569.517 440.013C587.975 472.007 564.806 512 527.94 512H48.054c-36.937 0-59.999-40.055-41.577-71.987L246.423 23.985c18.467-32.009 64.72-31.951 83.154 0l239.94 416.028zM288 354c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"/>&lt;/symbol>&lt;symbol id="info-notice" viewBox="0 0 512 512" preserveAspectRatio="xMidYMid meet">&lt;path d="M256 8C119.043 8 8 119.083 8 256c0 136.997 111.043 248 248 248s248-111.003 248-248C504 119.083 392.957 8 256 8zm0 110c23.196 0 42 18.804 42 42s-18.804 42-42 42-42-18.804-42-42 18.804-42 42-42zm56 254c0 6.627-5.373 12-12 12h-88c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h12v-64h-12c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h64c6.627 0 12 5.373 12 12v100h12c6.627 0 12 5.373 12 12v24z"/>&lt;/symbol>&lt;/svg>&lt;/div>&lt;div class="notice tip" >
&lt;p class="first notice-title">&lt;span class="icon-notice baseline">&lt;svg>&lt;use href="https://loomt.top/posts/6.824-lab1/#tip-notice">&lt;/use>&lt;/svg>&lt;/span>ÊèêÁ§∫&lt;/p>&lt;p>ÁúãÂà∞‰∏Ä‰∫õÂêåÂ≠¶ÊòØÂÖà os.CreateTemp(&amp;quot;&amp;quot;, tmpFileName) Â≠òÂú®‰∏¥Êó∂Êñá‰ª∂ÈáåÈù¢ÔºåÁ≠âÂ§ÑÁêÜÂÆå‰∫ÜÂÜç rename Êàê&lt;code>mr-taskid-ihash(str)&lt;/code>„ÄÇËøôÊ†∑Â∫îËØ•‰ºöÊõ¥Âä†ËßÑËåÉ‰∏Ä‰∫õÔºå‰ΩÜ‰∏çÂàõÂª∫ tempfile Âú® lab1 ÁêÜËÆ∫‰∏äÂ∫îËØ•‰πüÊòØÂèØË°åÁöÑ„ÄÇ&lt;/p>
&lt;p>ÂΩìÊñá‰ª∂Ê≤°ÂÆåÂÖ®ÂÜôÂÆå worker Â∞± crash Êó∂ÔºåËøô‰∏™‰ªªÂä°‰ºöË¢´ coordinator ÂèëÁé∞Âπ∂‰∫§ÁªôÂà´ÁöÑ worker ÈáçÂÅö„ÄÇÂõ†‰∏∫Áî®ÁöÑÊòØ&lt;code>os.Create()&lt;/code>ÔºåÊñá‰ª∂‰ºöË¢´Êñ∞ÁöÑË¶ÜÁõñÔºåÁõ¥Âà∞ worker ÊàêÂäüÂÆåÊàê‰ªªÂä°‰∏∫Ê≠¢„ÄÇ&lt;/p>
&lt;p>Â¶ÇÊûúÈÄªËæëÂÖÅËÆ∏‰∏§‰∏™ worker ÂêåÊó∂Â§ÑÁêÜ‰∏Ä‰∏™‰ªªÂä°ÁöÑËØùÔºåÂ∞±ÈúÄË¶ÅÂàõÂª∫ tempFile ÂÜç rename ÁöÑÊñπÂºèÔºåÂõ†‰∏∫ÈúÄË¶Å‰øùËØÅÂàõÂª∫ÁöÑÔºà‰∏¥Êó∂ÔºâÊñá‰ª∂ÂÜÖÂÆπ‰∏çÈáçÂ§ç„ÄÇ&lt;/p>&lt;/div>
&lt;ol start="4">
&lt;li>map ‰ªªÂä°ÂÖ®ÈÉ®ÂÆåÊàêÂêé coordinator ÂàÜÈÖç NReduce ‰∏™ reduce ‰ªªÂä°Áªô‰∏çÂêåÁöÑ worker Â§ÑÁêÜ„ÄÇ&lt;/li>
&lt;li>worker ËØªÂèñ‰∏≠Èó¥Êñá‰ª∂ÔºåÂπ∂Â∞Ü&lt;code>key-list(intermediate_value)&lt;/code>ÊâîÁªô&lt;code>freduce&lt;/code>Â§ÑÁêÜÊàê&lt;code>key-value&lt;/code> ÂÜôÂÖ•&lt;code>mr-out-ihash(str)&lt;/code>„ÄÇ&lt;/li>
&lt;li>coordinator ÂèëÁé∞‰ªªÂä°ÂÖ®ÈÉΩÂ§ÑÁêÜÂÆåÂêéË∏¢Ëµ∞ workerÔºåÂπ∂Âú®Ëã•Âπ≤ÁßíÂêéÈÄÄÂá∫„ÄÇ&lt;/li>
&lt;/ol>
&lt;h3 id="tips">Tips&lt;/h3>
&lt;ol>
&lt;li>
&lt;p>ÁªìÊûÑ&lt;/p>
&lt;ul>
&lt;li>
&lt;p>go ÂèØ‰ª•Áî® const Âíå iota ‰ª£Êõø enum„ÄÇ&lt;/p>
&lt;/li>
&lt;li>
&lt;p>WorkerInfo Âú®Ëøô‰∏™ÂÆûÈ™åÂèØ‰ª•ÁúÅÁï•Ôºå‰∏çÈúÄË¶Å‰øùÁïô worker ÁöÑÁä∂ÊÄÅÔºå‰ΩÜÊàëÂÜô‰∫ÜÂ∞±‰∏çÊÉ≥Âà†‰∫Ü„ÄÇ&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Êú¨Êù•ËøòÊÉ≥ÂæÄÁªìÊûÑ‰ΩìÂÜÖÁΩÆ‰∏Ä‰∏™ logger ÁöÑÔºå‰ΩÜ RPC Ë∞ÉÁî®ÈúÄË¶Å gob Â∫èÂàóÂåñÔºåËÄå logger ‰∏çÁü•ÈÅì‰∏∫Âï•‰ºöÂ∫èÂàóÂåñÂ§±Ë¥•Ôºå‰∏çÁü•ÈÅìÊòØÂï• bugÔºå‰ª•ÂêéÂÜçÁûÖÁûÖ„ÄÇ&lt;/p>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;span class="lnt">44
&lt;/span>&lt;span class="lnt">45
&lt;/span>&lt;span class="lnt">46
&lt;/span>&lt;span class="lnt">47
&lt;/span>&lt;span class="lnt">48
&lt;/span>&lt;span class="lnt">49
&lt;/span>&lt;span class="lnt">50
&lt;/span>&lt;span class="lnt">51
&lt;/span>&lt;span class="lnt">52
&lt;/span>&lt;span class="lnt">53
&lt;/span>&lt;span class="lnt">54
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="kd">const&lt;/span> &lt;span class="p">(&lt;/span>
&lt;span class="nx">_&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="kc">iota&lt;/span>
&lt;span class="c1">// MAP REDUCE WAIT: Task type
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="nx">MAP&lt;/span>
&lt;span class="nx">REDUCE&lt;/span>
&lt;span class="nx">WAIT&lt;/span>
&lt;span class="c1">// IDLE BUSY DONE: Task status || WorkerInfo status
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="nx">IDLE&lt;/span>
&lt;span class="nx">BUSY&lt;/span>
&lt;span class="nx">DONE&lt;/span>
&lt;span class="p">)&lt;/span>
&lt;span class="kd">type&lt;/span> &lt;span class="nx">Coordinator&lt;/span> &lt;span class="kd">struct&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">NMap&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="c1">// map ‰ªªÂä°ÁöÑ‰∏™Êï∞
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="nx">NReduce&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="c1">// reduce ‰ªªÂä°ÁöÑ‰∏™Êï∞
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="nx">DMap&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="c1">// ËÆ∞ÂΩï map task ÂÆåÊàêÁöÑ‰∏™Êï∞
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="nx">DReduce&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="c1">// ËÆ∞ÂΩï reduce task ÂÆåÊàêÁöÑ‰∏™Êï∞
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="nx">WorkerId&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="c1">// ‰∏∫Êñ∞ÁöÑ worker ÂàÜÈÖç workerIds
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="nx">TaskDone&lt;/span> &lt;span class="kd">map&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="kt">int&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="kt">bool&lt;/span> &lt;span class="c1">// ËÆ∞ÂΩï task ÊòØÂê¶Ë¢´ÂÆåÊàê
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="nx">Map&lt;/span> &lt;span class="kd">chan&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">Task&lt;/span> &lt;span class="c1">// ÂæÖÂèñÂá∫ÁöÑ map task
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="nx">Reduce&lt;/span> &lt;span class="kd">chan&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">Task&lt;/span> &lt;span class="c1">// ÂæÖÂèñÂá∫ÁöÑ reduce task
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="nx">TaskMutex&lt;/span> &lt;span class="nx">sync&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Mutex&lt;/span> &lt;span class="c1">// Áî®‰∫é‰ªªÂä°ÂàÜÂèëÁõ∏ÂÖ≥Êï∞ÊçÆÁöÑ mutex
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="nx">DoneMutex&lt;/span> &lt;span class="nx">sync&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Mutex&lt;/span> &lt;span class="c1">// Áî®‰∫éÂÆåÊàê‰ªªÂä°Áõ∏ÂÖ≥Êï∞ÊçÆÁöÑ mutex
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="nx">Mutex&lt;/span> &lt;span class="nx">sync&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Mutex&lt;/span> &lt;span class="c1">// Áî®‰∫éÂÖ∂‰ªñÁªÜËäÇÁöÑ mutex
&lt;/span>&lt;span class="c1">&lt;/span>&lt;span class="p">}&lt;/span>
&lt;span class="kd">type&lt;/span> &lt;span class="nx">Task&lt;/span> &lt;span class="kd">struct&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">StartTime&lt;/span> &lt;span class="nx">time&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Time&lt;/span>
&lt;span class="nx">NReduce&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="c1">// ‰º†Áªô workerÔºåÁî®‰∫é ihash ÁöÑ mod
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="nx">Type&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="c1">// MAP REDUCE WAIT
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="nx">Status&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="c1">// IDLE BUSY DONE
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="nx">FileName&lt;/span> &lt;span class="kt">string&lt;/span>
&lt;span class="nx">TaskId&lt;/span> &lt;span class="kt">int&lt;/span>
&lt;span class="nx">WorkerId&lt;/span> &lt;span class="kt">int&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="kd">type&lt;/span> &lt;span class="nx">WorkerInfo&lt;/span> &lt;span class="kd">struct&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">WorkerId&lt;/span> &lt;span class="kt">int&lt;/span>
&lt;span class="nx">TaskId&lt;/span> &lt;span class="kt">int&lt;/span>
&lt;span class="nx">Type&lt;/span> &lt;span class="kt">int&lt;/span>
&lt;span class="nx">Status&lt;/span> &lt;span class="kt">int&lt;/span>
&lt;span class="c1">//Lg *log.Logger
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="c1">//Why this error?
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="c1">//gob: type log.Logger has no exported fields
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="c1">//2023/01/31 14:34:13 RPC getWork failed
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="c1">//exit status 1
&lt;/span>&lt;span class="c1">&lt;/span>&lt;span class="p">}&lt;/span>
&lt;span class="c1">// Map functions return a slice of KeyValue.
&lt;/span>&lt;span class="c1">&lt;/span>&lt;span class="kd">type&lt;/span> &lt;span class="nx">KeyValue&lt;/span> &lt;span class="kd">struct&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">Key&lt;/span> &lt;span class="kt">string&lt;/span>
&lt;span class="nx">Value&lt;/span> &lt;span class="kt">string&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ol start="2">
&lt;li>RPC ÂÜôÂÖ• reply ÁöÑÊó∂ÂÄô‰∏çËÉΩÁõ¥Êé•Â∞Ü reply ÊåáÂêë‰∏Ä‰∏™Êñ∞ÁöÑÂú∞ÂùÄÔºåËÄåÊòØË¶Å‰øÆÊîπ reply Âú∞ÂùÄÁöÑÂÄº„ÄÇ&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go"> &lt;span class="c1">//reply = &amp;amp;GetWorkReply{&amp;amp;Task{...}}
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="c1">//‰∏äÈù¢ÁöÑÊñπÊ≥ï‰∏ç‰ºöËøîÂõûÊÉ≥Ë¶ÅÁöÑ replyÔºåÂõ†‰∏∫ reply ÊåáÂêëÁöÑÊòØÊñ∞ÁöÑ GetWorkReply ÂÄºÂú® rpc ÊúçÂä°Âô®ÁöÑÊåáÈíà„ÄÇËøôÈÉ®ÂàÜÂÆ¢Êà∑Á´ØÁöÑÂÜÖÂ≠òÂíåÊúçÂä°Âô®ÁöÑ‰∏ç‰∏ÄÊ†∑ÔºåÊâÄ‰ª•ÂæóÂà∞ÁöÑÊòØÁ©∫ÂÄºÔºõ‰∏ãÈù¢ÁöÑÊñπÊ≥ïÂõ†‰∏∫ reply ÊòØÂÖ±‰∫´ÂÜÖÂ≠òÁöÑÔºåÊâÄ‰ª•ÊúçÂä°Âô®ÂíåÂÆ¢Êà∑Á´ØÈÉΩÂèØ‰ª•ËÆøÈóÆ &amp;amp;reply„ÄÇ
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="c1">//Âú® RPC Ë∞ÉÁî®Êó∂ÔºåË¶ÅÈÅøÂÖç‰º†ÈÄíÊåáÈíàÂèÇÊï∞ÔºåÂ¶ÇÊûú‰º†ÈÄíÁöÑÂèÇÊï∞ÊòØÂÄºÁ±ªÂûãÔºåÈÇ£‰πàËøô‰∏™ÂÄºÂ∞Ü‰ºöË¢´Â§çÂà∂Âà∞Âè¶‰∏Ä‰∏™Âú∞ÂùÄ
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">reply&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">GetWorkReply&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="nx">Task&lt;/span>&lt;span class="p">{&lt;/span>
&lt;span class="nx">StartTime&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">time&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Now&lt;/span>&lt;span class="p">(),&lt;/span>
&lt;span class="nx">Type&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">MAP&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="nx">Status&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">BUSY&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="nx">FileName&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">mapTask&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">FileName&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="nx">NReduce&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">c&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">NReduce&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="nx">WorkerId&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">args&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">WorkerId&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="nx">TaskId&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">mapTask&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">TaskId&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="p">}}&lt;/span> &lt;span class="c1">// equal to reply.Task = &amp;amp;Task{...}
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ol start="3">
&lt;li>clash testÔºåÈúÄË¶Å coordinator Âú® worker ÂÆïÊú∫ 10s Âêé‰∏∫Âêå‰∏Ä‰∏™‰ªªÂä°ÈáçÊñ∞ÂàÜÈÖç workerÔºåËøôÈÉ®ÂàÜÈúÄË¶ÅËÄÉËôë‰∏Ä‰∏ãÊ≥®ÊÑè‰∏Ä‰∏ã data race&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="k">go&lt;/span> &lt;span class="kd">func&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">taskId&lt;/span> &lt;span class="kt">int&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">filename&lt;/span> &lt;span class="kt">string&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">select&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">case&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span>&lt;span class="nx">time&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">After&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">12&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="nx">time&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Second&lt;/span>&lt;span class="p">):&lt;/span>
&lt;span class="nx">c&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Mutex&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Lock&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="p">!&lt;/span>&lt;span class="nx">c&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">TaskDone&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">taskId&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">c&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Mutex&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Unlock&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="nx">dosomething&lt;/span>
&lt;span class="p">}&lt;/span> &lt;span class="k">else&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">c&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Mutex&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Unlock&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="nx">dootherthing&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="c1">// default:{
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="c1">// }
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="c1">// default ‰∏çËÉΩÂÜôÔºåÂ¶ÇÊûúÂÜô‰∫ÜÂ∞±‰ºöÁõ¥Êé•Ë∑≥Âà∞ defaultÔºå‰∏ç‰ºöËøõÂÖ• 12s ÁöÑ case
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="k">return&lt;/span>
&lt;span class="p">}(&lt;/span>&lt;span class="nx">maptask&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">TaskId&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">mapTask&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">FileName&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ol start="4">
&lt;li>Âπ∂ÂèëÁºñÁ®ãÁªÜËäÇ&lt;/li>
&lt;/ol>
&lt;p>Âõ†‰∏∫ MapReduce ÁöÑÁâπÊÄßÔºåmap task ÂèØ‰ª•Âπ∂ÂèëÔºåreduce task ÂèØ‰ª•Âπ∂ÂèëÔºå‰ΩÜ‰∏§Áßç‰ªªÂä°‰∏çËÉΩÂêåÊó∂Âπ∂ÂèëÔºåÊâÄ‰ª•ÈúÄË¶ÅÁ≠âÂà∞ map task Ë∑ëÂÆåÊâçÂèØ‰ª•ËøõË°å reduce task„ÄÇÂ¶ÇÊûúÂêåÊó∂ËØªÂÜôÂêå‰∏Ä‰∏™ÂèòÈáèÔºåÈúÄË¶ÅÂä†ÈîÅ„ÄÇÂÖ∂ÂÆûËøòÂèØ‰ª•Áî® chan ÂÆûÁé∞ lock-freeÔºå‰ª•ÂêéËØïËØïÔºåÂ¶ÇÊûúÊúâÊó∂Èó¥ÁöÑËØù„ÄÇ&lt;/p>
&lt;ol start="5">
&lt;li>ÈöèÊâãÂÜôÁöÑ makefile&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-makefile" data-lang="makefile">&lt;span class="c"># location: src/Makefile
&lt;/span>&lt;span class="c">&lt;/span>&lt;span class="nv">ntest&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="m">50&lt;/span>
&lt;span class="nf">lab1&lt;/span>&lt;span class="o">:&lt;/span>
@cd main&lt;span class="p">;&lt;/span>&lt;span class="se">\
&lt;/span>&lt;span class="se">&lt;/span> &lt;span class="k">for&lt;/span> i in &lt;span class="nv">$$&lt;/span>&lt;span class="o">(&lt;/span>seq &lt;span class="m">1&lt;/span> &lt;span class="k">$(&lt;/span>ntest&lt;span class="k">)&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="p">;&lt;/span> &lt;span class="k">do&lt;/span>&lt;span class="se">\
&lt;/span>&lt;span class="se">&lt;/span> bash test-mr.sh &amp;gt; res&lt;span class="nv">$$&lt;/span>i&lt;span class="p">;&lt;/span>&lt;span class="se">\
&lt;/span>&lt;span class="se">&lt;/span> &lt;span class="k">done&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="se">\
&lt;/span>&lt;span class="se">&lt;/span> &lt;span class="nv">cnt&lt;/span>&lt;span class="o">=&lt;/span>0&lt;span class="p">;&lt;/span>&lt;span class="se">\
&lt;/span>&lt;span class="se">&lt;/span> &lt;span class="k">for&lt;/span> i in &lt;span class="nv">$$&lt;/span>&lt;span class="o">(&lt;/span>seq &lt;span class="m">1&lt;/span> &lt;span class="nv">$$&lt;/span>&lt;span class="o">(&lt;/span>expr &lt;span class="k">$(&lt;/span>ntest&lt;span class="k">)&lt;/span> - 1&lt;span class="o">))&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="k">do&lt;/span>&lt;span class="se">\
&lt;/span>&lt;span class="se">&lt;/span> &lt;span class="k">if&lt;/span> cmp res&lt;span class="nv">$$&lt;/span>i res&lt;span class="nv">$$&lt;/span>&lt;span class="o">(&lt;/span>expr &lt;span class="nv">$$&lt;/span>i + 1&lt;span class="o">)&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="k">then&lt;/span> &lt;span class="se">\
&lt;/span>&lt;span class="se">&lt;/span> &lt;span class="nv">cnt&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nv">$$&lt;/span>&lt;span class="o">(&lt;/span>expr &lt;span class="nv">$$&lt;/span>cnt + 1&lt;span class="o">)&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="se">\
&lt;/span>&lt;span class="se">&lt;/span> &lt;span class="k">fi&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="se">\
&lt;/span>&lt;span class="se">&lt;/span> &lt;span class="k">done&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="se">\
&lt;/span>&lt;span class="se">&lt;/span> &lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;same file num:&amp;#34;&lt;/span>&lt;span class="nv">$$&lt;/span>&lt;span class="o">(&lt;/span>expr &lt;span class="nv">$$&lt;/span>cnt + 1&lt;span class="o">)&lt;/span> &lt;span class="p">;&lt;/span>&lt;span class="se">\
&lt;/span>&lt;span class="se">&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="o">[&lt;/span> &lt;span class="nv">$$&lt;/span>cnt -eq &lt;span class="nv">$$&lt;/span>&lt;span class="o">(&lt;/span>expr &lt;span class="k">$(&lt;/span>ntest&lt;span class="k">)&lt;/span> - 1&lt;span class="o">)&lt;/span> &lt;span class="o">]&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="k">then&lt;/span> &lt;span class="se">\
&lt;/span>&lt;span class="se">&lt;/span> &lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;****************************************************************&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="se">\
&lt;/span>&lt;span class="se">&lt;/span> &lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;all res is the same!&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="se">\
&lt;/span>&lt;span class="se">&lt;/span> &lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;result content as follow.&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="se">\
&lt;/span>&lt;span class="se">&lt;/span> &lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;****************************************************************&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="se">\
&lt;/span>&lt;span class="se">&lt;/span> cat main/res1&lt;span class="p">;&lt;/span>&lt;span class="se">\
&lt;/span>&lt;span class="se">&lt;/span> &lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;****************************************************************&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="se">\
&lt;/span>&lt;span class="se">&lt;/span> &lt;span class="k">fi&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ol start="6">
&lt;li>result&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-zsh" data-lang="zsh">same file num:50
****************************************************************
all res is the same!
result content as follow.
****************************************************************
*** Starting wc test.
--- wc test: PASS
*** Starting indexer test.
--- indexer test: PASS
*** Starting map parallelism test.
--- map parallelism test: PASS
*** Starting reduce parallelism test.
--- reduce parallelism test: PASS
*** Starting job count test.
--- job count test: PASS
*** Starting early &lt;span class="nb">exit&lt;/span> test.
--- early &lt;span class="nb">exit&lt;/span> test: PASS
*** Starting crash test.
--- crash test: PASS
*** PASSED ALL TESTS
****************************************************************
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description><category domain="https://loomt.top/posts/">posts</category><category domain="https://loomt.top/tags/raft/">Raft</category><category domain="https://loomt.top/tags/%E5%88%86%E5%B8%83%E5%BC%8F/">ÂàÜÂ∏ÉÂºè</category><category domain="https://loomt.top/tags/6.824/">6.824</category></item><item><title>6.824</title><link>https://loomt.top/posts/6.824/</link><guid isPermaLink="true">https://loomt.top/posts/6.824/</guid><pubDate>Tue, 17 Jan 2023 23:11:57 +0800</pubDate><author>loomt_@outlook.com (loomt)</author><copyright>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh)</copyright><description>&lt;h1 id="mit-6824Áé∞Âú®Â•ΩÂÉèÂèòÊàê‰∫Ü-65840">MIT 6.824ÔºàÁé∞Âú®Â•ΩÂÉèÂèòÊàê‰∫Ü 6.5840&lt;/h1>
&lt;p>&lt;a href="https://pdos.csail.mit.edu/6.824/schedule.html">schedule&lt;/a>
&lt;a href="https://www.youtube.com/watch?v=IdCbMO0Ey9I">go Âπ∂ÂèëÁºñÁ®ã&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://www.loomt.top/posts/6.824-lab1">lab1 solution&lt;/a>&lt;/p>
&lt;h2 id="efficient-debug-and-test">Efficient debug and test&lt;/h2>
&lt;p>&lt;a href="https://blog.josejg.com/debugging-pretty/">Debugging by Pretty Printing&lt;/a>&lt;/p>
&lt;blockquote>
&lt;p>Humans are visual creatures so it‚Äôs a good idea to make use of visual tools like colors or columns to encode different types of information.&lt;/p>
&lt;/blockquote>
&lt;ol>
&lt;li>dslogs.py -&amp;gt; build pretty printer for logs&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt"> 10
&lt;/span>&lt;span class="lnt"> 11
&lt;/span>&lt;span class="lnt"> 12
&lt;/span>&lt;span class="lnt"> 13
&lt;/span>&lt;span class="lnt"> 14
&lt;/span>&lt;span class="lnt"> 15
&lt;/span>&lt;span class="lnt"> 16
&lt;/span>&lt;span class="lnt"> 17
&lt;/span>&lt;span class="lnt"> 18
&lt;/span>&lt;span class="lnt"> 19
&lt;/span>&lt;span class="lnt"> 20
&lt;/span>&lt;span class="lnt"> 21
&lt;/span>&lt;span class="lnt"> 22
&lt;/span>&lt;span class="lnt"> 23
&lt;/span>&lt;span class="lnt"> 24
&lt;/span>&lt;span class="lnt"> 25
&lt;/span>&lt;span class="lnt"> 26
&lt;/span>&lt;span class="lnt"> 27
&lt;/span>&lt;span class="lnt"> 28
&lt;/span>&lt;span class="lnt"> 29
&lt;/span>&lt;span class="lnt"> 30
&lt;/span>&lt;span class="lnt"> 31
&lt;/span>&lt;span class="lnt"> 32
&lt;/span>&lt;span class="lnt"> 33
&lt;/span>&lt;span class="lnt"> 34
&lt;/span>&lt;span class="lnt"> 35
&lt;/span>&lt;span class="lnt"> 36
&lt;/span>&lt;span class="lnt"> 37
&lt;/span>&lt;span class="lnt"> 38
&lt;/span>&lt;span class="lnt"> 39
&lt;/span>&lt;span class="lnt"> 40
&lt;/span>&lt;span class="lnt"> 41
&lt;/span>&lt;span class="lnt"> 42
&lt;/span>&lt;span class="lnt"> 43
&lt;/span>&lt;span class="lnt"> 44
&lt;/span>&lt;span class="lnt"> 45
&lt;/span>&lt;span class="lnt"> 46
&lt;/span>&lt;span class="lnt"> 47
&lt;/span>&lt;span class="lnt"> 48
&lt;/span>&lt;span class="lnt"> 49
&lt;/span>&lt;span class="lnt"> 50
&lt;/span>&lt;span class="lnt"> 51
&lt;/span>&lt;span class="lnt"> 52
&lt;/span>&lt;span class="lnt"> 53
&lt;/span>&lt;span class="lnt"> 54
&lt;/span>&lt;span class="lnt"> 55
&lt;/span>&lt;span class="lnt"> 56
&lt;/span>&lt;span class="lnt"> 57
&lt;/span>&lt;span class="lnt"> 58
&lt;/span>&lt;span class="lnt"> 59
&lt;/span>&lt;span class="lnt"> 60
&lt;/span>&lt;span class="lnt"> 61
&lt;/span>&lt;span class="lnt"> 62
&lt;/span>&lt;span class="lnt"> 63
&lt;/span>&lt;span class="lnt"> 64
&lt;/span>&lt;span class="lnt"> 65
&lt;/span>&lt;span class="lnt"> 66
&lt;/span>&lt;span class="lnt"> 67
&lt;/span>&lt;span class="lnt"> 68
&lt;/span>&lt;span class="lnt"> 69
&lt;/span>&lt;span class="lnt"> 70
&lt;/span>&lt;span class="lnt"> 71
&lt;/span>&lt;span class="lnt"> 72
&lt;/span>&lt;span class="lnt"> 73
&lt;/span>&lt;span class="lnt"> 74
&lt;/span>&lt;span class="lnt"> 75
&lt;/span>&lt;span class="lnt"> 76
&lt;/span>&lt;span class="lnt"> 77
&lt;/span>&lt;span class="lnt"> 78
&lt;/span>&lt;span class="lnt"> 79
&lt;/span>&lt;span class="lnt"> 80
&lt;/span>&lt;span class="lnt"> 81
&lt;/span>&lt;span class="lnt"> 82
&lt;/span>&lt;span class="lnt"> 83
&lt;/span>&lt;span class="lnt"> 84
&lt;/span>&lt;span class="lnt"> 85
&lt;/span>&lt;span class="lnt"> 86
&lt;/span>&lt;span class="lnt"> 87
&lt;/span>&lt;span class="lnt"> 88
&lt;/span>&lt;span class="lnt"> 89
&lt;/span>&lt;span class="lnt"> 90
&lt;/span>&lt;span class="lnt"> 91
&lt;/span>&lt;span class="lnt"> 92
&lt;/span>&lt;span class="lnt"> 93
&lt;/span>&lt;span class="lnt"> 94
&lt;/span>&lt;span class="lnt"> 95
&lt;/span>&lt;span class="lnt"> 96
&lt;/span>&lt;span class="lnt"> 97
&lt;/span>&lt;span class="lnt"> 98
&lt;/span>&lt;span class="lnt"> 99
&lt;/span>&lt;span class="lnt">100
&lt;/span>&lt;span class="lnt">101
&lt;/span>&lt;span class="lnt">102
&lt;/span>&lt;span class="lnt">103
&lt;/span>&lt;span class="lnt">104
&lt;/span>&lt;span class="lnt">105
&lt;/span>&lt;span class="lnt">106
&lt;/span>&lt;span class="lnt">107
&lt;/span>&lt;span class="lnt">108
&lt;/span>&lt;span class="lnt">109
&lt;/span>&lt;span class="lnt">110
&lt;/span>&lt;span class="lnt">111
&lt;/span>&lt;span class="lnt">112
&lt;/span>&lt;span class="lnt">113
&lt;/span>&lt;span class="lnt">114
&lt;/span>&lt;span class="lnt">115
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="ch">#!/usr/bin/env python&lt;/span>
&lt;span class="kn">import&lt;/span> &lt;span class="nn">sys&lt;/span>
&lt;span class="kn">import&lt;/span> &lt;span class="nn">shutil&lt;/span>
&lt;span class="kn">from&lt;/span> &lt;span class="nn">typing&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">Optional&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">List&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">Tuple&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">Dict&lt;/span>
&lt;span class="kn">import&lt;/span> &lt;span class="nn">typer&lt;/span>
&lt;span class="kn">from&lt;/span> &lt;span class="nn">rich&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="nb">print&lt;/span>
&lt;span class="kn">from&lt;/span> &lt;span class="nn">rich.columns&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">Columns&lt;/span>
&lt;span class="kn">from&lt;/span> &lt;span class="nn">rich.console&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">Console&lt;/span>
&lt;span class="kn">from&lt;/span> &lt;span class="nn">rich.traceback&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">install&lt;/span>
&lt;span class="c1"># fmt: off&lt;/span>
&lt;span class="c1"># Mapping from topics to colors&lt;/span>
&lt;span class="n">TOPICS&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="s2">&amp;#34;TIMR&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;#9a9a99&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="s2">&amp;#34;VOTE&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;#67a0b2&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="s2">&amp;#34;LEAD&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;#d0b343&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="s2">&amp;#34;TERM&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;#70c43f&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="s2">&amp;#34;LOG1&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;#4878bc&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="s2">&amp;#34;LOG2&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;#398280&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="s2">&amp;#34;CMIT&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;#98719f&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="s2">&amp;#34;PERS&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;#d08341&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="s2">&amp;#34;SNAP&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;#FD971F&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="s2">&amp;#34;DROP&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;#ff615c&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="s2">&amp;#34;CLNT&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;#00813c&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="s2">&amp;#34;TEST&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;#fe2c79&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="s2">&amp;#34;INFO&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;#ffffff&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="s2">&amp;#34;WARN&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;#d08341&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="s2">&amp;#34;ERRO&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;#fe2626&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="s2">&amp;#34;TRCE&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;#fe2626&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="s2">&amp;#34;FORC&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;#3571a4&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="s2">&amp;#34;HEAR&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;#ffcf3e&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="s2">&amp;#34;STAT&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;#cf5fb4&amp;#34;&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="c1"># fmt: on&lt;/span>
&lt;span class="k">def&lt;/span> &lt;span class="nf">list_topics&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">value&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">Optional&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nb">str&lt;/span>&lt;span class="p">]):&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="n">value&lt;/span> &lt;span class="ow">is&lt;/span> &lt;span class="kc">None&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="n">value&lt;/span>
&lt;span class="n">topics&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">value&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">split&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;,&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">for&lt;/span> &lt;span class="n">topic&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="n">topics&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="n">topic&lt;/span> &lt;span class="ow">not&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="n">TOPICS&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="k">raise&lt;/span> &lt;span class="n">typer&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">BadParameter&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="sa">f&lt;/span>&lt;span class="s2">&amp;#34;topic &lt;/span>&lt;span class="si">{&lt;/span>&lt;span class="n">topic&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2"> not recognized&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="n">topics&lt;/span>
&lt;span class="k">def&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">(&lt;/span>
&lt;span class="n">file&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">typer&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">FileText&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">typer&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Argument&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kc">None&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">help&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;File to read, stdin otherwise&amp;#34;&lt;/span>&lt;span class="p">),&lt;/span>
&lt;span class="n">colorize&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">bool&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">typer&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Option&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kc">True&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;--no-color&amp;#34;&lt;/span>&lt;span class="p">),&lt;/span>
&lt;span class="n">n_columns&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">Optional&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nb">int&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">typer&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Option&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kc">None&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;--columns&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;-c&amp;#34;&lt;/span>&lt;span class="p">),&lt;/span>
&lt;span class="n">ignore&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">Optional&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nb">str&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">typer&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Option&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kc">None&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;--ignore&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;-i&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">callback&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">list_topics&lt;/span>&lt;span class="p">),&lt;/span>
&lt;span class="n">just&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">Optional&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nb">str&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">typer&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Option&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kc">None&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;--just&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;-j&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">callback&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">list_topics&lt;/span>&lt;span class="p">),&lt;/span>
&lt;span class="p">):&lt;/span>
&lt;span class="n">topics&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nb">list&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">TOPICS&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="c1"># We can take input from a stdin (pipes) or from a file&lt;/span>
&lt;span class="n">input_&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">file&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="n">file&lt;/span> &lt;span class="k">else&lt;/span> &lt;span class="n">sys&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">stdin&lt;/span>
&lt;span class="c1"># Print just some topics or exclude some topics (good for avoiding verbose ones)&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="n">just&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="n">topics&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">just&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="n">ignore&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="n">topics&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="n">lvl&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="n">lvl&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="n">topics&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="n">lvl&lt;/span> &lt;span class="ow">not&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="nb">set&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">ignore&lt;/span>&lt;span class="p">)]&lt;/span>
&lt;span class="n">topics&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nb">set&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">topics&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="n">console&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">Console&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="n">width&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">console&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">size&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">width&lt;/span>
&lt;span class="n">panic&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="kc">False&lt;/span>
&lt;span class="k">for&lt;/span> &lt;span class="n">line&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="n">input_&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="k">try&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="n">time&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">topic&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">msg&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">line&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">strip&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">split&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34; &amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="c1"># To ignore some topics&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="n">topic&lt;/span> &lt;span class="ow">not&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="n">topics&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="k">continue&lt;/span>
&lt;span class="n">msg&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34; &amp;#34;&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">join&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">msg&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="c1"># Debug calls from the test suite aren&amp;#39;t associated with&lt;/span>
&lt;span class="c1"># any particular peer. Otherwise we can treat second column&lt;/span>
&lt;span class="c1"># as peer id&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="n">topic&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="s2">&amp;#34;TEST&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="n">i&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nb">int&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">msg&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">])&lt;/span>
&lt;span class="c1"># Colorize output by using rich syntax when needed&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="n">colorize&lt;/span> &lt;span class="ow">and&lt;/span> &lt;span class="n">topic&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="n">TOPICS&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="n">color&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">TOPICS&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">topic&lt;/span>&lt;span class="p">]&lt;/span>
&lt;span class="n">msg&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="sa">f&lt;/span>&lt;span class="s2">&amp;#34;[&lt;/span>&lt;span class="si">{&lt;/span>&lt;span class="n">color&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">]&lt;/span>&lt;span class="si">{&lt;/span>&lt;span class="n">msg&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">[/&lt;/span>&lt;span class="si">{&lt;/span>&lt;span class="n">color&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">]&amp;#34;&lt;/span>
&lt;span class="c1"># Single column printing. Always the case for debug stmts in tests&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="n">n_columns&lt;/span> &lt;span class="ow">is&lt;/span> &lt;span class="kc">None&lt;/span> &lt;span class="ow">or&lt;/span> &lt;span class="n">topic&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="s2">&amp;#34;TEST&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="nb">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">time&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">msg&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="c1"># Multi column printing, timing is dropped to maximize horizontal&lt;/span>
&lt;span class="c1"># space. Heavylifting is done through rich.column.Columns object&lt;/span>
&lt;span class="k">else&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="n">cols&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;&amp;#34;&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="n">_&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="nb">range&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">n_columns&lt;/span>&lt;span class="p">)]&lt;/span>
&lt;span class="n">msg&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;&amp;#34;&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="n">msg&lt;/span>
&lt;span class="n">cols&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">msg&lt;/span>
&lt;span class="n">col_width&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nb">int&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">width&lt;/span> &lt;span class="o">/&lt;/span> &lt;span class="n">n_columns&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="n">cols&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">Columns&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">cols&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">width&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">col_width&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">equal&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="kc">True&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">expand&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="kc">True&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="nb">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">cols&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">except&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="c1"># Code from tests or panics does not follow format&lt;/span>
&lt;span class="c1"># so we print it as is&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="n">line&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">startswith&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;panic&amp;#34;&lt;/span>&lt;span class="p">):&lt;/span>
&lt;span class="n">panic&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="kc">True&lt;/span>
&lt;span class="c1"># Output from tests is usually important so add a&lt;/span>
&lt;span class="c1"># horizontal line with hashes to make it more obvious&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="ow">not&lt;/span> &lt;span class="n">panic&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="nb">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;#&amp;#34;&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="n">console&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">width&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="nb">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">line&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">end&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="vm">__name__&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="s2">&amp;#34;__main__&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="n">typer&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">run&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">main&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ol start="2">
&lt;li>dstest.py -&amp;gt; concurrency test&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt"> 10
&lt;/span>&lt;span class="lnt"> 11
&lt;/span>&lt;span class="lnt"> 12
&lt;/span>&lt;span class="lnt"> 13
&lt;/span>&lt;span class="lnt"> 14
&lt;/span>&lt;span class="lnt"> 15
&lt;/span>&lt;span class="lnt"> 16
&lt;/span>&lt;span class="lnt"> 17
&lt;/span>&lt;span class="lnt"> 18
&lt;/span>&lt;span class="lnt"> 19
&lt;/span>&lt;span class="lnt"> 20
&lt;/span>&lt;span class="lnt"> 21
&lt;/span>&lt;span class="lnt"> 22
&lt;/span>&lt;span class="lnt"> 23
&lt;/span>&lt;span class="lnt"> 24
&lt;/span>&lt;span class="lnt"> 25
&lt;/span>&lt;span class="lnt"> 26
&lt;/span>&lt;span class="lnt"> 27
&lt;/span>&lt;span class="lnt"> 28
&lt;/span>&lt;span class="lnt"> 29
&lt;/span>&lt;span class="lnt"> 30
&lt;/span>&lt;span class="lnt"> 31
&lt;/span>&lt;span class="lnt"> 32
&lt;/span>&lt;span class="lnt"> 33
&lt;/span>&lt;span class="lnt"> 34
&lt;/span>&lt;span class="lnt"> 35
&lt;/span>&lt;span class="lnt"> 36
&lt;/span>&lt;span class="lnt"> 37
&lt;/span>&lt;span class="lnt"> 38
&lt;/span>&lt;span class="lnt"> 39
&lt;/span>&lt;span class="lnt"> 40
&lt;/span>&lt;span class="lnt"> 41
&lt;/span>&lt;span class="lnt"> 42
&lt;/span>&lt;span class="lnt"> 43
&lt;/span>&lt;span class="lnt"> 44
&lt;/span>&lt;span class="lnt"> 45
&lt;/span>&lt;span class="lnt"> 46
&lt;/span>&lt;span class="lnt"> 47
&lt;/span>&lt;span class="lnt"> 48
&lt;/span>&lt;span class="lnt"> 49
&lt;/span>&lt;span class="lnt"> 50
&lt;/span>&lt;span class="lnt"> 51
&lt;/span>&lt;span class="lnt"> 52
&lt;/span>&lt;span class="lnt"> 53
&lt;/span>&lt;span class="lnt"> 54
&lt;/span>&lt;span class="lnt"> 55
&lt;/span>&lt;span class="lnt"> 56
&lt;/span>&lt;span class="lnt"> 57
&lt;/span>&lt;span class="lnt"> 58
&lt;/span>&lt;span class="lnt"> 59
&lt;/span>&lt;span class="lnt"> 60
&lt;/span>&lt;span class="lnt"> 61
&lt;/span>&lt;span class="lnt"> 62
&lt;/span>&lt;span class="lnt"> 63
&lt;/span>&lt;span class="lnt"> 64
&lt;/span>&lt;span class="lnt"> 65
&lt;/span>&lt;span class="lnt"> 66
&lt;/span>&lt;span class="lnt"> 67
&lt;/span>&lt;span class="lnt"> 68
&lt;/span>&lt;span class="lnt"> 69
&lt;/span>&lt;span class="lnt"> 70
&lt;/span>&lt;span class="lnt"> 71
&lt;/span>&lt;span class="lnt"> 72
&lt;/span>&lt;span class="lnt"> 73
&lt;/span>&lt;span class="lnt"> 74
&lt;/span>&lt;span class="lnt"> 75
&lt;/span>&lt;span class="lnt"> 76
&lt;/span>&lt;span class="lnt"> 77
&lt;/span>&lt;span class="lnt"> 78
&lt;/span>&lt;span class="lnt"> 79
&lt;/span>&lt;span class="lnt"> 80
&lt;/span>&lt;span class="lnt"> 81
&lt;/span>&lt;span class="lnt"> 82
&lt;/span>&lt;span class="lnt"> 83
&lt;/span>&lt;span class="lnt"> 84
&lt;/span>&lt;span class="lnt"> 85
&lt;/span>&lt;span class="lnt"> 86
&lt;/span>&lt;span class="lnt"> 87
&lt;/span>&lt;span class="lnt"> 88
&lt;/span>&lt;span class="lnt"> 89
&lt;/span>&lt;span class="lnt"> 90
&lt;/span>&lt;span class="lnt"> 91
&lt;/span>&lt;span class="lnt"> 92
&lt;/span>&lt;span class="lnt"> 93
&lt;/span>&lt;span class="lnt"> 94
&lt;/span>&lt;span class="lnt"> 95
&lt;/span>&lt;span class="lnt"> 96
&lt;/span>&lt;span class="lnt"> 97
&lt;/span>&lt;span class="lnt"> 98
&lt;/span>&lt;span class="lnt"> 99
&lt;/span>&lt;span class="lnt">100
&lt;/span>&lt;span class="lnt">101
&lt;/span>&lt;span class="lnt">102
&lt;/span>&lt;span class="lnt">103
&lt;/span>&lt;span class="lnt">104
&lt;/span>&lt;span class="lnt">105
&lt;/span>&lt;span class="lnt">106
&lt;/span>&lt;span class="lnt">107
&lt;/span>&lt;span class="lnt">108
&lt;/span>&lt;span class="lnt">109
&lt;/span>&lt;span class="lnt">110
&lt;/span>&lt;span class="lnt">111
&lt;/span>&lt;span class="lnt">112
&lt;/span>&lt;span class="lnt">113
&lt;/span>&lt;span class="lnt">114
&lt;/span>&lt;span class="lnt">115
&lt;/span>&lt;span class="lnt">116
&lt;/span>&lt;span class="lnt">117
&lt;/span>&lt;span class="lnt">118
&lt;/span>&lt;span class="lnt">119
&lt;/span>&lt;span class="lnt">120
&lt;/span>&lt;span class="lnt">121
&lt;/span>&lt;span class="lnt">122
&lt;/span>&lt;span class="lnt">123
&lt;/span>&lt;span class="lnt">124
&lt;/span>&lt;span class="lnt">125
&lt;/span>&lt;span class="lnt">126
&lt;/span>&lt;span class="lnt">127
&lt;/span>&lt;span class="lnt">128
&lt;/span>&lt;span class="lnt">129
&lt;/span>&lt;span class="lnt">130
&lt;/span>&lt;span class="lnt">131
&lt;/span>&lt;span class="lnt">132
&lt;/span>&lt;span class="lnt">133
&lt;/span>&lt;span class="lnt">134
&lt;/span>&lt;span class="lnt">135
&lt;/span>&lt;span class="lnt">136
&lt;/span>&lt;span class="lnt">137
&lt;/span>&lt;span class="lnt">138
&lt;/span>&lt;span class="lnt">139
&lt;/span>&lt;span class="lnt">140
&lt;/span>&lt;span class="lnt">141
&lt;/span>&lt;span class="lnt">142
&lt;/span>&lt;span class="lnt">143
&lt;/span>&lt;span class="lnt">144
&lt;/span>&lt;span class="lnt">145
&lt;/span>&lt;span class="lnt">146
&lt;/span>&lt;span class="lnt">147
&lt;/span>&lt;span class="lnt">148
&lt;/span>&lt;span class="lnt">149
&lt;/span>&lt;span class="lnt">150
&lt;/span>&lt;span class="lnt">151
&lt;/span>&lt;span class="lnt">152
&lt;/span>&lt;span class="lnt">153
&lt;/span>&lt;span class="lnt">154
&lt;/span>&lt;span class="lnt">155
&lt;/span>&lt;span class="lnt">156
&lt;/span>&lt;span class="lnt">157
&lt;/span>&lt;span class="lnt">158
&lt;/span>&lt;span class="lnt">159
&lt;/span>&lt;span class="lnt">160
&lt;/span>&lt;span class="lnt">161
&lt;/span>&lt;span class="lnt">162
&lt;/span>&lt;span class="lnt">163
&lt;/span>&lt;span class="lnt">164
&lt;/span>&lt;span class="lnt">165
&lt;/span>&lt;span class="lnt">166
&lt;/span>&lt;span class="lnt">167
&lt;/span>&lt;span class="lnt">168
&lt;/span>&lt;span class="lnt">169
&lt;/span>&lt;span class="lnt">170
&lt;/span>&lt;span class="lnt">171
&lt;/span>&lt;span class="lnt">172
&lt;/span>&lt;span class="lnt">173
&lt;/span>&lt;span class="lnt">174
&lt;/span>&lt;span class="lnt">175
&lt;/span>&lt;span class="lnt">176
&lt;/span>&lt;span class="lnt">177
&lt;/span>&lt;span class="lnt">178
&lt;/span>&lt;span class="lnt">179
&lt;/span>&lt;span class="lnt">180
&lt;/span>&lt;span class="lnt">181
&lt;/span>&lt;span class="lnt">182
&lt;/span>&lt;span class="lnt">183
&lt;/span>&lt;span class="lnt">184
&lt;/span>&lt;span class="lnt">185
&lt;/span>&lt;span class="lnt">186
&lt;/span>&lt;span class="lnt">187
&lt;/span>&lt;span class="lnt">188
&lt;/span>&lt;span class="lnt">189
&lt;/span>&lt;span class="lnt">190
&lt;/span>&lt;span class="lnt">191
&lt;/span>&lt;span class="lnt">192
&lt;/span>&lt;span class="lnt">193
&lt;/span>&lt;span class="lnt">194
&lt;/span>&lt;span class="lnt">195
&lt;/span>&lt;span class="lnt">196
&lt;/span>&lt;span class="lnt">197
&lt;/span>&lt;span class="lnt">198
&lt;/span>&lt;span class="lnt">199
&lt;/span>&lt;span class="lnt">200
&lt;/span>&lt;span class="lnt">201
&lt;/span>&lt;span class="lnt">202
&lt;/span>&lt;span class="lnt">203
&lt;/span>&lt;span class="lnt">204
&lt;/span>&lt;span class="lnt">205
&lt;/span>&lt;span class="lnt">206
&lt;/span>&lt;span class="lnt">207
&lt;/span>&lt;span class="lnt">208
&lt;/span>&lt;span class="lnt">209
&lt;/span>&lt;span class="lnt">210
&lt;/span>&lt;span class="lnt">211
&lt;/span>&lt;span class="lnt">212
&lt;/span>&lt;span class="lnt">213
&lt;/span>&lt;span class="lnt">214
&lt;/span>&lt;span class="lnt">215
&lt;/span>&lt;span class="lnt">216
&lt;/span>&lt;span class="lnt">217
&lt;/span>&lt;span class="lnt">218
&lt;/span>&lt;span class="lnt">219
&lt;/span>&lt;span class="lnt">220
&lt;/span>&lt;span class="lnt">221
&lt;/span>&lt;span class="lnt">222
&lt;/span>&lt;span class="lnt">223
&lt;/span>&lt;span class="lnt">224
&lt;/span>&lt;span class="lnt">225
&lt;/span>&lt;span class="lnt">226
&lt;/span>&lt;span class="lnt">227
&lt;/span>&lt;span class="lnt">228
&lt;/span>&lt;span class="lnt">229
&lt;/span>&lt;span class="lnt">230
&lt;/span>&lt;span class="lnt">231
&lt;/span>&lt;span class="lnt">232
&lt;/span>&lt;span class="lnt">233
&lt;/span>&lt;span class="lnt">234
&lt;/span>&lt;span class="lnt">235
&lt;/span>&lt;span class="lnt">236
&lt;/span>&lt;span class="lnt">237
&lt;/span>&lt;span class="lnt">238
&lt;/span>&lt;span class="lnt">239
&lt;/span>&lt;span class="lnt">240
&lt;/span>&lt;span class="lnt">241
&lt;/span>&lt;span class="lnt">242
&lt;/span>&lt;span class="lnt">243
&lt;/span>&lt;span class="lnt">244
&lt;/span>&lt;span class="lnt">245
&lt;/span>&lt;span class="lnt">246
&lt;/span>&lt;span class="lnt">247
&lt;/span>&lt;span class="lnt">248
&lt;/span>&lt;span class="lnt">249
&lt;/span>&lt;span class="lnt">250
&lt;/span>&lt;span class="lnt">251
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="ch">#!/usr/bin/env python&lt;/span>
&lt;span class="kn">import&lt;/span> &lt;span class="nn">itertools&lt;/span>
&lt;span class="kn">import&lt;/span> &lt;span class="nn">math&lt;/span>
&lt;span class="kn">import&lt;/span> &lt;span class="nn">signal&lt;/span>
&lt;span class="kn">import&lt;/span> &lt;span class="nn">subprocess&lt;/span>
&lt;span class="kn">import&lt;/span> &lt;span class="nn">tempfile&lt;/span>
&lt;span class="kn">import&lt;/span> &lt;span class="nn">shutil&lt;/span>
&lt;span class="kn">import&lt;/span> &lt;span class="nn">time&lt;/span>
&lt;span class="kn">import&lt;/span> &lt;span class="nn">os&lt;/span>
&lt;span class="kn">import&lt;/span> &lt;span class="nn">sys&lt;/span>
&lt;span class="kn">import&lt;/span> &lt;span class="nn">datetime&lt;/span>
&lt;span class="kn">from&lt;/span> &lt;span class="nn">collections&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">defaultdict&lt;/span>
&lt;span class="kn">from&lt;/span> &lt;span class="nn">concurrent.futures&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">ThreadPoolExecutor&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">wait&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">FIRST_COMPLETED&lt;/span>
&lt;span class="kn">from&lt;/span> &lt;span class="nn">dataclasses&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">dataclass&lt;/span>
&lt;span class="kn">from&lt;/span> &lt;span class="nn">pathlib&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">Path&lt;/span>
&lt;span class="kn">from&lt;/span> &lt;span class="nn">typing&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">List&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">Optional&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">Dict&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">DefaultDict&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">Tuple&lt;/span>
&lt;span class="kn">import&lt;/span> &lt;span class="nn">typer&lt;/span>
&lt;span class="kn">import&lt;/span> &lt;span class="nn">rich&lt;/span>
&lt;span class="kn">from&lt;/span> &lt;span class="nn">rich&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="nb">print&lt;/span>
&lt;span class="kn">from&lt;/span> &lt;span class="nn">rich.table&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">Table&lt;/span>
&lt;span class="kn">from&lt;/span> &lt;span class="nn">rich.progress&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="p">(&lt;/span>
&lt;span class="n">Progress&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="n">TimeElapsedColumn&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="n">TimeRemainingColumn&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="n">TextColumn&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="n">BarColumn&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="n">SpinnerColumn&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="p">)&lt;/span>
&lt;span class="kn">from&lt;/span> &lt;span class="nn">rich.live&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">Live&lt;/span>
&lt;span class="kn">from&lt;/span> &lt;span class="nn">rich.panel&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">Panel&lt;/span>
&lt;span class="kn">from&lt;/span> &lt;span class="nn">rich.traceback&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">install&lt;/span>
&lt;span class="n">install&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">show_locals&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="kc">True&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="nd">@dataclass&lt;/span>
&lt;span class="k">class&lt;/span> &lt;span class="nc">StatsMeter&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="s2">&amp;#34;&amp;#34;&amp;#34;
&lt;/span>&lt;span class="s2"> Auxiliary classs to keep track of online stats including: count, mean, variance
&lt;/span>&lt;span class="s2"> Uses Welford&amp;#39;s algorithm to compute sample mean and sample variance incrementally.
&lt;/span>&lt;span class="s2"> https://en.wikipedia.org/wiki/Algorithms_for_calculating_variance#On-line_algorithm
&lt;/span>&lt;span class="s2"> &amp;#34;&amp;#34;&amp;#34;&lt;/span>
&lt;span class="n">n&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">int&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span>
&lt;span class="n">mean&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">float&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mf">0.0&lt;/span>
&lt;span class="n">S&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">float&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mf">0.0&lt;/span>
&lt;span class="k">def&lt;/span> &lt;span class="nf">add&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">datum&lt;/span>&lt;span class="p">):&lt;/span>
&lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">n&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="mi">1&lt;/span>
&lt;span class="n">delta&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">datum&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">mean&lt;/span>
&lt;span class="c1"># Mk = Mk-1+ (xk ‚Äì Mk-1)/k&lt;/span>
&lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">mean&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="n">delta&lt;/span> &lt;span class="o">/&lt;/span> &lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">n&lt;/span>
&lt;span class="c1"># Sk = Sk-1 + (xk ‚Äì Mk-1)*(xk ‚Äì Mk).&lt;/span>
&lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">S&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="n">delta&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">datum&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">mean&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="nd">@property&lt;/span>
&lt;span class="k">def&lt;/span> &lt;span class="nf">variance&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">):&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">S&lt;/span> &lt;span class="o">/&lt;/span> &lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">n&lt;/span>
&lt;span class="nd">@property&lt;/span>
&lt;span class="k">def&lt;/span> &lt;span class="nf">std&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">):&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="n">math&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">sqrt&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">variance&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">def&lt;/span> &lt;span class="nf">print_results&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">results&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">Dict&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nb">str&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">Dict&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nb">str&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">StatsMeter&lt;/span>&lt;span class="p">]],&lt;/span> &lt;span class="n">timing&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="kc">False&lt;/span>&lt;span class="p">):&lt;/span>
&lt;span class="n">table&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">Table&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">show_header&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="kc">True&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">header_style&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;bold&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="n">table&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">add_column&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;Test&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="n">table&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">add_column&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;Failed&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">justify&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;right&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="n">table&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">add_column&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;Total&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">justify&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;right&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="ow">not&lt;/span> &lt;span class="n">timing&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="n">table&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">add_column&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;Time&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">justify&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;right&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">else&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="n">table&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">add_column&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;Real Time&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">justify&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;right&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="n">table&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">add_column&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;User Time&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">justify&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;right&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="n">table&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">add_column&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;System Time&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">justify&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;right&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">for&lt;/span> &lt;span class="n">test&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">stats&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="n">results&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">items&lt;/span>&lt;span class="p">():&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="n">stats&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;completed&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">n&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="k">continue&lt;/span>
&lt;span class="n">color&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;green&amp;#34;&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="n">stats&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;failed&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">n&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="k">else&lt;/span> &lt;span class="s2">&amp;#34;red&amp;#34;&lt;/span>
&lt;span class="n">row&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">[&lt;/span>
&lt;span class="sa">f&lt;/span>&lt;span class="s2">&amp;#34;[&lt;/span>&lt;span class="si">{&lt;/span>&lt;span class="n">color&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">]&lt;/span>&lt;span class="si">{&lt;/span>&lt;span class="n">test&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">[/&lt;/span>&lt;span class="si">{&lt;/span>&lt;span class="n">color&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">]&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="nb">str&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">stats&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;failed&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">n&lt;/span>&lt;span class="p">),&lt;/span>
&lt;span class="nb">str&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">stats&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;completed&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">n&lt;/span>&lt;span class="p">),&lt;/span>
&lt;span class="p">]&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="ow">not&lt;/span> &lt;span class="n">timing&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="n">row&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">append&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="sa">f&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">{&lt;/span>&lt;span class="n">stats&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;time&amp;#39;&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">mean&lt;/span>&lt;span class="si">:&lt;/span>&lt;span class="s2">.2f&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2"> ¬± &lt;/span>&lt;span class="si">{&lt;/span>&lt;span class="n">stats&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;time&amp;#39;&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">std&lt;/span>&lt;span class="si">:&lt;/span>&lt;span class="s2">.2f&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">else&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="n">row&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">extend&lt;/span>&lt;span class="p">(&lt;/span>
&lt;span class="p">[&lt;/span>
&lt;span class="sa">f&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">{&lt;/span>&lt;span class="n">stats&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;real_time&amp;#39;&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">mean&lt;/span>&lt;span class="si">:&lt;/span>&lt;span class="s2">.2f&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2"> ¬± &lt;/span>&lt;span class="si">{&lt;/span>&lt;span class="n">stats&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;real_time&amp;#39;&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">std&lt;/span>&lt;span class="si">:&lt;/span>&lt;span class="s2">.2f&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="sa">f&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">{&lt;/span>&lt;span class="n">stats&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;user_time&amp;#39;&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">mean&lt;/span>&lt;span class="si">:&lt;/span>&lt;span class="s2">.2f&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2"> ¬± &lt;/span>&lt;span class="si">{&lt;/span>&lt;span class="n">stats&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;user_time&amp;#39;&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">std&lt;/span>&lt;span class="si">:&lt;/span>&lt;span class="s2">.2f&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="sa">f&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">{&lt;/span>&lt;span class="n">stats&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;system_time&amp;#39;&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">mean&lt;/span>&lt;span class="si">:&lt;/span>&lt;span class="s2">.2f&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2"> ¬± &lt;/span>&lt;span class="si">{&lt;/span>&lt;span class="n">stats&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;system_time&amp;#39;&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">std&lt;/span>&lt;span class="si">:&lt;/span>&lt;span class="s2">.2f&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="p">]&lt;/span>
&lt;span class="p">)&lt;/span>
&lt;span class="n">table&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">add_row&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="n">row&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="nb">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">table&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">def&lt;/span> &lt;span class="nf">run_test&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">test&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">str&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">race&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">bool&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">timing&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">bool&lt;/span>&lt;span class="p">):&lt;/span>
&lt;span class="n">test_cmd&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;go&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;test&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="sa">f&lt;/span>&lt;span class="s2">&amp;#34;-run=&lt;/span>&lt;span class="si">{&lt;/span>&lt;span class="n">test&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="n">race&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="n">test_cmd&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">append&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;-race&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="n">timing&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="n">test_cmd&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;time&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="n">test_cmd&lt;/span>
&lt;span class="n">f&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">path&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">tempfile&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">mkstemp&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="n">start&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">time&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">time&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="n">proc&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">subprocess&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">run&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">test_cmd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">stdout&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">f&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">stderr&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">f&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="n">runtime&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">time&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">time&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="n">start&lt;/span>
&lt;span class="n">os&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">close&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">f&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="n">test&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">path&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">proc&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">returncode&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">runtime&lt;/span>
&lt;span class="k">def&lt;/span> &lt;span class="nf">last_line&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">file&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">str&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">-&amp;gt;&lt;/span> &lt;span class="nb">str&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="k">with&lt;/span> &lt;span class="nb">open&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">file&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;rb&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="k">as&lt;/span> &lt;span class="n">f&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="n">f&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">seek&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">os&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">SEEK_END&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">while&lt;/span> &lt;span class="n">f&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">read&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="sa">b&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="n">f&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">seek&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">os&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">SEEK_CUR&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="n">line&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">f&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">readline&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">decode&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="n">line&lt;/span>
&lt;span class="c1"># fmt: off&lt;/span>
&lt;span class="k">def&lt;/span> &lt;span class="nf">run_tests&lt;/span>&lt;span class="p">(&lt;/span>
&lt;span class="n">tests&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">List&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nb">str&lt;/span>&lt;span class="p">],&lt;/span>
&lt;span class="n">sequential&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">bool&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">typer&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Option&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kc">False&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;--sequential&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;-s&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">help&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;Run all test of each group in order&amp;#39;&lt;/span>&lt;span class="p">),&lt;/span>
&lt;span class="n">workers&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">int&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">typer&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Option&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;--workers&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;-p&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">help&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;Number of parallel tasks&amp;#39;&lt;/span>&lt;span class="p">),&lt;/span>
&lt;span class="n">iterations&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">int&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">typer&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Option&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">10&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;--iter&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;-n&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">help&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;Number of iterations to run&amp;#39;&lt;/span>&lt;span class="p">),&lt;/span>
&lt;span class="n">output&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">Optional&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">Path&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">typer&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Option&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kc">None&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;--output&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;-o&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">help&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;Output path to use&amp;#39;&lt;/span>&lt;span class="p">),&lt;/span>
&lt;span class="n">verbose&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">int&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">typer&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Option&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;--verbose&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;-v&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">help&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;Verbosity level&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">count&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="kc">True&lt;/span>&lt;span class="p">),&lt;/span>
&lt;span class="n">archive&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">bool&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">typer&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Option&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kc">False&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;--archive&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;-a&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">help&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;Save all logs intead of only failed ones&amp;#39;&lt;/span>&lt;span class="p">),&lt;/span>
&lt;span class="n">race&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">bool&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">typer&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Option&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kc">False&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;--race/--no-race&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;-r/-R&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">help&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;Run with race checker&amp;#39;&lt;/span>&lt;span class="p">),&lt;/span>
&lt;span class="n">loop&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">bool&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">typer&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Option&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kc">False&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;--loop&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;-l&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">help&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;Run continuously&amp;#39;&lt;/span>&lt;span class="p">),&lt;/span>
&lt;span class="n">growth&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">int&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">typer&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Option&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">10&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;--growth&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;-g&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">help&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;Growth ratio of iterations when using --loop&amp;#39;&lt;/span>&lt;span class="p">),&lt;/span>
&lt;span class="n">timing&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">bool&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">typer&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Option&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kc">False&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;--timing&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;-t&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">help&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;Report timing, only works on macOS&amp;#39;&lt;/span>&lt;span class="p">),&lt;/span>
&lt;span class="c1"># fmt: on&lt;/span>
&lt;span class="p">):&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="n">output&lt;/span> &lt;span class="ow">is&lt;/span> &lt;span class="kc">None&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="n">timestamp&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">datetime&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">datetime&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">now&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">strftime&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;%Y%m&lt;/span>&lt;span class="si">%d&lt;/span>&lt;span class="s2">_%H%M%S&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="n">output&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">Path&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">timestamp&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="n">race&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="nb">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;[yellow]Running with the race detector&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s2">[/yellow]&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="n">verbose&lt;/span> &lt;span class="o">&amp;gt;&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="nb">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="sa">f&lt;/span>&lt;span class="s2">&amp;#34;[yellow] Verbosity level set to &lt;/span>&lt;span class="si">{&lt;/span>&lt;span class="n">verbose&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">[/yellow]&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="n">os&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">environ&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;VERBOSE&amp;#39;&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nb">str&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">verbose&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">while&lt;/span> &lt;span class="kc">True&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="n">total&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">iterations&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="nb">len&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">tests&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="n">completed&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span>
&lt;span class="n">results&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">{&lt;/span>&lt;span class="n">test&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">defaultdict&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">StatsMeter&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="n">test&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="n">tests&lt;/span>&lt;span class="p">}&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="n">sequential&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="n">test_instances&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">itertools&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">chain&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">from_iterable&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">itertools&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">repeat&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">test&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">iterations&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="n">test&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="n">tests&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">else&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="n">test_instances&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">itertools&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">chain&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">from_iterable&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">itertools&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">repeat&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">tests&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">iterations&lt;/span>&lt;span class="p">))&lt;/span>
&lt;span class="n">test_instances&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nb">iter&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">test_instances&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="n">total_progress&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">Progress&lt;/span>&lt;span class="p">(&lt;/span>
&lt;span class="s2">&amp;#34;[progress.description]&lt;/span>&lt;span class="si">{task.description}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="n">BarColumn&lt;/span>&lt;span class="p">(),&lt;/span>
&lt;span class="n">TimeRemainingColumn&lt;/span>&lt;span class="p">(),&lt;/span>
&lt;span class="s2">&amp;#34;[progress.percentage]&lt;/span>&lt;span class="si">{task.percentage:&amp;gt;3.0f}&lt;/span>&lt;span class="s2">%&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="n">TimeElapsedColumn&lt;/span>&lt;span class="p">(),&lt;/span>
&lt;span class="p">)&lt;/span>
&lt;span class="n">total_task&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">total_progress&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">add_task&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;[yellow]Tests[/yellow]&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">total&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">total&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="n">task_progress&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">Progress&lt;/span>&lt;span class="p">(&lt;/span>
&lt;span class="s2">&amp;#34;[progress.description]&lt;/span>&lt;span class="si">{task.description}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="n">SpinnerColumn&lt;/span>&lt;span class="p">(),&lt;/span>
&lt;span class="n">BarColumn&lt;/span>&lt;span class="p">(),&lt;/span>
&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">{task.completed}&lt;/span>&lt;span class="s2">/&lt;/span>&lt;span class="si">{task.total}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="p">)&lt;/span>
&lt;span class="n">tasks&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">{&lt;/span>&lt;span class="n">test&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">task_progress&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">add_task&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">test&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">total&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">iterations&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="n">test&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="n">tests&lt;/span>&lt;span class="p">}&lt;/span>
&lt;span class="n">progress_table&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">Table&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">grid&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="n">progress_table&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">add_row&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">total_progress&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="n">progress_table&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">add_row&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">Panel&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">fit&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">task_progress&lt;/span>&lt;span class="p">))&lt;/span>
&lt;span class="k">with&lt;/span> &lt;span class="n">Live&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">progress_table&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">transient&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="kc">True&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="k">as&lt;/span> &lt;span class="n">live&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="k">def&lt;/span> &lt;span class="nf">handler&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">_&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">frame&lt;/span>&lt;span class="p">):&lt;/span>
&lt;span class="n">live&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">stop&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="nb">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s1">&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="n">print_results&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">results&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="n">sys&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">exit&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="n">signal&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">signal&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">signal&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">SIGINT&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">handler&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">with&lt;/span> &lt;span class="n">ThreadPoolExecutor&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">max_workers&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">workers&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="k">as&lt;/span> &lt;span class="n">executor&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="n">futures&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">[]&lt;/span>
&lt;span class="k">while&lt;/span> &lt;span class="n">completed&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="n">total&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="n">n&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nb">len&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">futures&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="n">n&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="n">workers&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="k">for&lt;/span> &lt;span class="n">test&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="n">itertools&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">islice&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">test_instances&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">workers&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">n&lt;/span>&lt;span class="p">):&lt;/span>
&lt;span class="n">futures&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">append&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">executor&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">submit&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">run_test&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">test&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">race&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">timing&lt;/span>&lt;span class="p">))&lt;/span>
&lt;span class="n">done&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">not_done&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">wait&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">futures&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">return_when&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">FIRST_COMPLETED&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">for&lt;/span> &lt;span class="n">future&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="n">done&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="n">test&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">path&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">rc&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">runtime&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">future&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">result&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="n">results&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">test&lt;/span>&lt;span class="p">][&lt;/span>&lt;span class="s1">&amp;#39;completed&amp;#39;&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">add&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="n">results&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">test&lt;/span>&lt;span class="p">][&lt;/span>&lt;span class="s1">&amp;#39;time&amp;#39;&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">add&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">runtime&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="n">task_progress&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">update&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">tasks&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">test&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="n">advance&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="n">dest&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">output&lt;/span> &lt;span class="o">/&lt;/span> &lt;span class="sa">f&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">{&lt;/span>&lt;span class="n">test&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">_&lt;/span>&lt;span class="si">{&lt;/span>&lt;span class="n">completed&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">.log&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">as_posix&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="n">rc&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="nb">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="sa">f&lt;/span>&lt;span class="s2">&amp;#34;Failed test &lt;/span>&lt;span class="si">{&lt;/span>&lt;span class="n">test&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2"> - &lt;/span>&lt;span class="si">{&lt;/span>&lt;span class="n">dest&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="n">task_progress&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">update&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">tasks&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">test&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="n">description&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="sa">f&lt;/span>&lt;span class="s2">&amp;#34;[red]&lt;/span>&lt;span class="si">{&lt;/span>&lt;span class="n">test&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">[/red]&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="n">results&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">test&lt;/span>&lt;span class="p">][&lt;/span>&lt;span class="s1">&amp;#39;failed&amp;#39;&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">add&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">else&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="n">results&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">test&lt;/span>&lt;span class="p">][&lt;/span>&lt;span class="s1">&amp;#39;completed&amp;#39;&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">n&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="n">iterations&lt;/span> &lt;span class="ow">and&lt;/span> &lt;span class="n">results&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">test&lt;/span>&lt;span class="p">][&lt;/span>&lt;span class="s1">&amp;#39;failed&amp;#39;&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">n&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="n">task_progress&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">update&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">tasks&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">test&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="n">description&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="sa">f&lt;/span>&lt;span class="s2">&amp;#34;[green]&lt;/span>&lt;span class="si">{&lt;/span>&lt;span class="n">test&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">[/green]&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="n">rc&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="ow">or&lt;/span> &lt;span class="n">archive&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="n">output&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">mkdir&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">exist_ok&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="kc">True&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">parents&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="kc">True&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="n">shutil&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">copy&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">path&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">dest&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="n">timing&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="n">line&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">last_line&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">path&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="n">real&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">_&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">user&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">_&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">system&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">_&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">line&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">replace&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39; &amp;#39;&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="mi">8&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">split&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39; &amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="n">results&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">test&lt;/span>&lt;span class="p">][&lt;/span>&lt;span class="s1">&amp;#39;real_time&amp;#39;&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">add&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">float&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">real&lt;/span>&lt;span class="p">))&lt;/span>
&lt;span class="n">results&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">test&lt;/span>&lt;span class="p">][&lt;/span>&lt;span class="s1">&amp;#39;user_time&amp;#39;&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">add&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">float&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">user&lt;/span>&lt;span class="p">))&lt;/span>
&lt;span class="n">results&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">test&lt;/span>&lt;span class="p">][&lt;/span>&lt;span class="s1">&amp;#39;system_time&amp;#39;&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">add&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">float&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">system&lt;/span>&lt;span class="p">))&lt;/span>
&lt;span class="n">os&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">remove&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">path&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="n">completed&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="mi">1&lt;/span>
&lt;span class="n">total_progress&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">update&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">total_task&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">advance&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="n">futures&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nb">list&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">not_done&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="n">print_results&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">results&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">timing&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="n">loop&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="n">iterations&lt;/span> &lt;span class="o">*=&lt;/span> &lt;span class="n">growth&lt;/span>
&lt;span class="nb">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="sa">f&lt;/span>&lt;span class="s2">&amp;#34;[yellow]Increasing iterations to &lt;/span>&lt;span class="si">{&lt;/span>&lt;span class="n">iterations&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">[/yellow]&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">else&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="k">break&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="vm">__name__&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="s2">&amp;#34;__main__&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="n">typer&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">run&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">run_tests&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ol start="3">
&lt;li>configuration&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-zsh" data-lang="zsh">&lt;span class="c1"># ~/.zshrc &lt;/span>
&lt;span class="nb">alias&lt;/span> &lt;span class="nv">dslogs&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;python ~/.pyScript/dslogs.py&amp;#34;&lt;/span>
&lt;span class="nb">alias&lt;/span> &lt;span class="nv">dstest&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;python ~/.pyScript/dstest.py&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>dslogs&lt;/li>
&lt;/ul>
&lt;p>&lt;code>VERBOSE=1 go test &amp;gt; out&lt;/code>&lt;/p>
&lt;p>&lt;code>dslog out -c 6&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-zsh" data-lang="zsh">‚ùØ dslogs --help
Usage: dslogs.py &lt;span class="o">[&lt;/span>OPTIONS&lt;span class="o">]&lt;/span> &lt;span class="o">[&lt;/span>FILE&lt;span class="o">]&lt;/span>
‚ï≠‚îÄ Arguments ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
‚îÇ file &lt;span class="o">[&lt;/span>FILE&lt;span class="o">]&lt;/span> File to read, stdin otherwise &lt;span class="o">[&lt;/span>default: None&lt;span class="o">]&lt;/span>
‚ï∞‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
‚ï≠‚îÄ Options ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
‚îÇ --no-color &lt;span class="o">[&lt;/span>default: True&lt;span class="o">]&lt;/span>
‚îÇ --columns -c INTEGER &lt;span class="o">[&lt;/span>default: None&lt;span class="o">]&lt;/span> // &amp;gt;rfÁöÑÊï∞Èáè
‚îÇ --ignore -i TEXT &lt;span class="o">[&lt;/span>default: None&lt;span class="o">]&lt;/span> // ‰∏çÊòæÁ§∫Êüê‰∫õTAG
‚îÇ --just -j TEXT &lt;span class="o">[&lt;/span>default: None&lt;span class="o">]&lt;/span> // ‰ªÖÊòæÁ§∫Êüê‰∫õTAG
‚îÇ --help Show this message and exit.
‚ï∞‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>dstest&lt;/li>
&lt;/ul>
&lt;p>&lt;code>dstest -v 1 -s -p 10 -n 10 -o logs -r 2A&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-zsh" data-lang="zsh">‚ùØ dstest --help
Usage: dstest.py &lt;span class="o">[&lt;/span>OPTIONS&lt;span class="o">]&lt;/span> TESTS...
‚ï≠‚îÄ Arguments ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
‚îÇ * tests TESTS... &lt;span class="o">[&lt;/span>default: None&lt;span class="o">]&lt;/span> &lt;span class="o">[&lt;/span>required&lt;span class="o">]&lt;/span>
‚ï∞‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
‚ï≠‚îÄ Options ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
‚îÇ --sequential -s Run all &lt;span class="nb">test&lt;/span> of each group in order
‚îÇ --workers -p INTEGER Number of parallel tasks &lt;span class="o">[&lt;/span>default: 1&lt;span class="o">]&lt;/span> // Á∫øÁ®ãÊï∞
‚îÇ --iter -n INTEGER Number of iterations to run &lt;span class="o">[&lt;/span>default: 10&lt;span class="o">]&lt;/span> // ÈáçÂ§çËøêË°åÂêå‰∏Ä‰∏™‰ªªÂä°
‚îÇ --output -o PATH Output path to use &lt;span class="o">[&lt;/span>default: None&lt;span class="o">]&lt;/span>
‚îÇ --verbose -v INTEGER Verbosity level &lt;span class="o">[&lt;/span>default: 0&lt;span class="o">]&lt;/span> // ÊòØÂê¶ÊòæÁ§∫DprintfÂÜÖÂÆπ
‚îÇ --archive -a Save all logs intead of only failed ones
‚îÇ --race -r --no-race -R Run with race checker &lt;span class="o">[&lt;/span>default: no-race&lt;span class="o">]&lt;/span>
‚îÇ --loop -l Run continuously // ÊµãÂÆåÂêéÁªßÁª≠Êó†ÈôêÊµãËØï
‚îÇ --growth -g INTEGER Growth ratio of iterations when using --loop &lt;span class="o">[&lt;/span>default: 10&lt;span class="o">]&lt;/span> // ÂíåloopÈÖçÂêà‰ΩøÁî®Ôºåiter*&lt;span class="o">=&lt;/span>growth
‚îÇ --timing -t Report timing, only works on macOS
‚îÇ --help Show this message and exit.
‚ï∞‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description><category domain="https://loomt.top/posts/">posts</category><category domain="https://loomt.top/tags/raft/">Raft</category><category domain="https://loomt.top/tags/%E5%88%86%E5%B8%83%E5%BC%8F/">ÂàÜÂ∏ÉÂºè</category><category domain="https://loomt.top/tags/6.824/">6.824</category></item><item><title>RPC</title><link>https://loomt.top/posts/rpc/</link><guid isPermaLink="true">https://loomt.top/posts/rpc/</guid><pubDate>Sun, 15 Jan 2023 21:47:06 +0800</pubDate><author>loomt_@outlook.com (loomt)</author><copyright>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh)</copyright><description>&lt;h2 id="rpc">RPC&lt;/h2>
&lt;blockquote>
&lt;p>Remote Procedure Call&lt;/p>
&lt;/blockquote>
&lt;h3 id="ÁâπÁÇπ">ÁâπÁÇπ&lt;/h3>
&lt;p>RPC ‰∏é HTTP Âπ∂‰∏çÊòØÂπ∂ÂàóÂÖ≥Á≥ªÔºåRPC Âè™ÊòØ‰∏Ä‰∏™ËøúÁ®ãËøáÁ®ãË∞ÉÁî®ÁöÑËßÑÁ∫¶ÔºåÂèØ‰ª•Áî® HTTP ËøõË°å‰ø°ÊÅØÁöÑ‰º†Ëæì„ÄÇ&lt;/p>
&lt;p>RPC ÁöÑ‰∏ªË¶ÅÁõÆÁöÑÊòØÂÅöÂà∞‰∏çÂêåÊúçÂä°Èó¥Ë∞ÉÁî®ÊñπÊ≥ïÂÉèÂêå‰∏ÄÊúçÂä°Èó¥Ë∞ÉÁî®Êú¨Âú∞ÊñπÊ≥ï‰∏ÄÊ†∑„ÄÇ&lt;/p>
&lt;p>Â§ßËá¥ÊµÅÁ®ãÊòØÁºñÁ†ÅÔºàÂèØ‰ª•Áî® protobufÔºâÔºå‰º†ËæìÔºåÊé•Êî∂ÔºåËß£Á†Å&lt;/p>
&lt;h3 id="‰ºòÁÇπ">‰ºòÁÇπ&lt;/h3>
&lt;ol>
&lt;li>Âçï‰∏ÄË¥£‰ªª&lt;/li>
&lt;li>Êâ©Â±ïÊÄß&lt;/li>
&lt;li>ÊïÖÈöúÈöîÁ¶ª&lt;/li>
&lt;/ol>
&lt;h4 id="ËÆ∫ÊñáÊû∂ÊûÑ">ËÆ∫ÊñáÊû∂ÊûÑ&lt;/h4>
&lt;p>User, User-Stub, RPC-Runtime, Server-Stub, Server&lt;/p>
&lt;p>&lt;img src="https://loomt.top/img/Implementing-remote-procedure-calls.png" alt="Implementing-remote-procedure-calls">&lt;/p>
&lt;h3 id="ÂÆûÁé∞">ÂÆûÁé∞&lt;/h3>
&lt;p>&lt;img src="https://loomt.top/img/rpc-real.png" alt="rpc-real">&lt;/p>
&lt;h4 id="idl-interface-description-language">IDL (Interface description language)&lt;/h4>
&lt;p>Descript the interface.&lt;/p>
&lt;h5 id="tlv-ÁºñÁ†Å">TLV ÁºñÁ†Å&lt;/h5>
&lt;ul>
&lt;li>TagÔºöÁ±ªÂûã&lt;/li>
&lt;li>LengthÔºöÈïøÂ∫¶&lt;/li>
&lt;li>ValueÔºöÂÄºÔºà‰πüÂèØ‰ª•ÊòØ TLV ÁªìÊûÑÔºâ
&lt;img src="https://loomt.top/img/IDL-TLV.png" alt="IDL-TLV">&lt;/li>
&lt;/ul>
&lt;h4 id="gencode">GenCode&lt;/h4>
&lt;p>Translate the IDL to different programming language.&lt;/p>
&lt;p>Need decode and encode logic.&lt;/p>
&lt;p>ÂÖºÂÆπÊÄß‚Äî‚ÄîÂ¢ûÂä†Êñ∞ÁöÑÂ≠óÊÆµ‰∏çÂΩ±ÂìçÁé∞ÊúâÊúçÂä°&lt;/p>
&lt;p>ÈÄöÁî®ÊÄß‚Äî‚ÄîË∑®Âπ≥Âè∞Ë∑®ËØ≠Ë®Ä&lt;/p>
&lt;p>ÊÄßËÉΩ‚Äî‚ÄîÁ©∫Èó¥Êó∂Èó¥Áª¥Â∫¶ÔºåÁºñÁ†ÅÂêéÁöÑÊï∞ÊçÆÂ§ßÂ∞èÂíåÁºñÁ†ÅÊó∂Èïø&lt;/p>
&lt;h4 id="encode">Encode&lt;/h4>
&lt;p>Conv code to byte.&lt;/p>
&lt;h4 id="protocol">Protocol&lt;/h4>
&lt;p>Necessary data and metadata&lt;/p>
&lt;p>0 1 2 3 4 5 6 7 8 9 a b c d e f 0 1 2 3 4 5 6 7 8 9 a b c d e f
+&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;-+
| 0| LENGTH |
+&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;-+
| 0| HEADER MAGIC | FLAGS |
+&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;-+
| SEQUENCE NUMBER |
+&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;-+
| 0| Header Size(/32) | &amp;hellip;
+&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&lt;/p>
&lt;pre>&lt;code> Header is of variable size:
(and starts at offset 14)
&lt;/code>&lt;/pre>
&lt;p>+&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;-+
| PROTOCOL ID (varint) | NUM TRANSFORMS (varint) |
+&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;-+
| TRANSFORM 0 ID (varint) | TRANSFORM 0 DATA &amp;hellip;
+&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;-+
| &amp;hellip; &amp;hellip; |
+&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;-+
| INFO 0 ID (varint) | INFO 0 DATA &amp;hellip;
+&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;-+
| &amp;hellip; &amp;hellip; |
+&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;-+
| |
| PAYLOAD |
| |
+&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;-+&lt;/p>
&lt;p>LENGTH: Êï∞ÊçÆÂåÖÂ§ßÂ∞èÔºå‰∏çÂåÖÂê´Ëá™Ë∫´&lt;/p>
&lt;p>HEADER MAGIC:Ê†áËØÜÁâàÊú¨‰ø°ÊÅØÔºåÂçèËÆÆËß£ÊûêÊó∂Âø´ÈÄüÊ†°È™å&lt;/p>
&lt;p>SEQUENCE NUMBER:Ë°®Á§∫Êï∞ÊçÆÂåÖÁöÑ seqlDÔºåÂèØÁî®‰∫éÂ§öË∑ØÂ§çÁî®ÔºåÂçïËøûÊé•ÂÜÖÈÄíÂ¢û
HEADER SIZE:Â§¥ÈÉ®ÈïøÂ∫¶Ôºå‰ªéÁ¨¨ 14 ‰∏™Â≠óËäÇÂºÄÂßãËÆ°ÁÆó‰∏ÄÁõ¥Âà∞ PAYLOAD Ââç
PROTOCOL ID:ÁºñËß£Á†ÅÊñπÂºèÔºåÊúâ Binary Âíå Compact ‰∏§Áßç
TRANSFORM ID:ÂéãÁº©ÊñπÂºèÔºåÂ¶Ç zlilb Âíå snappy
INFO ID:‰º†ÈÄí‰∏Ä‰∫õÂÆöÂà∂ÁöÑ meta ‰ø°ÊÅØ
PAYLOAD:Ê∂àÊÅØ‰Ωì&lt;/p>
&lt;h4 id="network-transfer">Network Transfer&lt;/h4>
&lt;pre tabindex="0">&lt;code>Application Layer
Sockets API
TCP/UDP
IP
Driver
Physical Layer
&lt;/code>&lt;/pre>&lt;p>&lt;img src="https://loomt.top/img/socket.png" alt="socket">&lt;/p>
&lt;p>&lt;em>reference&lt;/em>&lt;/p>
&lt;p>&lt;a href="http://ddia.vonng.com/#/ch4?id=%e6%9c%8d%e5%8a%a1%e4%b8%ad%e7%9a%84%e6%95%b0%e6%8d%ae%e6%b5%81%ef%bc%9arest%e4%b8%8erpc">http://ddia.vonng.com/#/ch4?id=%e6%9c%8d%e5%8a%a1%e4%b8%ad%e7%9a%84%e6%95%b0%e6%8d%ae%e6%b5%81%ef%bc%9arest%e4%b8%8erpc&lt;/a>&lt;/p></description><category domain="https://loomt.top/posts/">posts</category></item><item><title>go-zero Âçï‰ΩìÊúçÂä°</title><link>https://loomt.top/posts/go-zero%E5%8D%95%E4%BD%93%E6%9C%8D%E5%8A%A1/</link><guid isPermaLink="true">https://loomt.top/posts/go-zero%E5%8D%95%E4%BD%93%E6%9C%8D%E5%8A%A1/</guid><pubDate>Sun, 08 Jan 2023 09:46:11 +0800</pubDate><author>loomt_@outlook.com (loomt)</author><copyright>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh)</copyright><description>&lt;h2 id="go-zero">go-zero&lt;/h2>
&lt;h3 id="go-zero-ÁÆÄ‰ªã">go-zero ÁÆÄ‰ªã&lt;/h3>
&lt;p>&lt;a href="https://go-zero.dev/cn/docs/introduction">go-zero&lt;/a>ÊòØ‰∏Ä‰∏™ËÉΩÂ§üÂø´ÈÄüÁîüÊàê APIÔºåMODEL Âíå RPC ÁöÑÊ°ÜÊû∂„ÄÇ&lt;/p>
&lt;h3 id="go-zero-È°πÁõÆÁªìÊûÑ‰∏çÂê´-rpc">go-zero È°πÁõÆÁªìÊûÑÔºà‰∏çÂê´ RPCÔºâ&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;span class="lnt">44
&lt;/span>&lt;span class="lnt">45
&lt;/span>&lt;span class="lnt">46
&lt;/span>&lt;span class="lnt">47
&lt;/span>&lt;span class="lnt">48
&lt;/span>&lt;span class="lnt">49
&lt;/span>&lt;span class="lnt">50
&lt;/span>&lt;span class="lnt">51
&lt;/span>&lt;span class="lnt">52
&lt;/span>&lt;span class="lnt">53
&lt;/span>&lt;span class="lnt">54
&lt;/span>&lt;span class="lnt">55
&lt;/span>&lt;span class="lnt">56
&lt;/span>&lt;span class="lnt">57
&lt;/span>&lt;span class="lnt">58
&lt;/span>&lt;span class="lnt">59
&lt;/span>&lt;span class="lnt">60
&lt;/span>&lt;span class="lnt">61
&lt;/span>&lt;span class="lnt">62
&lt;/span>&lt;span class="lnt">63
&lt;/span>&lt;span class="lnt">64
&lt;/span>&lt;span class="lnt">65
&lt;/span>&lt;span class="lnt">66
&lt;/span>&lt;span class="lnt">67
&lt;/span>&lt;span class="lnt">68
&lt;/span>&lt;span class="lnt">69
&lt;/span>&lt;span class="lnt">70
&lt;/span>&lt;span class="lnt">71
&lt;/span>&lt;span class="lnt">72
&lt;/span>&lt;span class="lnt">73
&lt;/span>&lt;span class="lnt">74
&lt;/span>&lt;span class="lnt">75
&lt;/span>&lt;span class="lnt">76
&lt;/span>&lt;span class="lnt">77
&lt;/span>&lt;span class="lnt">78
&lt;/span>&lt;span class="lnt">79
&lt;/span>&lt;span class="lnt">80
&lt;/span>&lt;span class="lnt">81
&lt;/span>&lt;span class="lnt">82
&lt;/span>&lt;span class="lnt">83
&lt;/span>&lt;span class="lnt">84
&lt;/span>&lt;span class="lnt">85
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">.
‚îú‚îÄ‚îÄ api
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ etc
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îî‚îÄ‚îÄ park-api.yaml
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ internal
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îú‚îÄ‚îÄ config
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îÇ¬†¬† ‚îî‚îÄ‚îÄ config.go
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îú‚îÄ‚îÄ handler
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îÇ¬†¬† ‚îú‚îÄ‚îÄ accessHandler.go
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îÇ¬†¬† ‚îú‚îÄ‚îÄ deviceInfoHandler.go
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îÇ¬†¬† ‚îú‚îÄ‚îÄ incomeHandler.go
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îÇ¬†¬† ‚îú‚îÄ‚îÄ parkingLotHandler.go
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îÇ¬†¬† ‚îú‚îÄ‚îÄ routes.go
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îÇ¬†¬† ‚îú‚îÄ‚îÄ siteInfoHandler.go
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îÇ¬†¬† ‚îú‚îÄ‚îÄ touristCarProvinceHandler.go
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îÇ¬†¬† ‚îú‚îÄ‚îÄ touristFlowHandler.go
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îÇ¬†¬† ‚îú‚îÄ‚îÄ userHandler.go
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îÇ¬†¬† ‚îî‚îÄ‚îÄ wechatHandler.go
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îú‚îÄ‚îÄ logic
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îÇ¬†¬† ‚îú‚îÄ‚îÄ accessLogic.go
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îÇ¬†¬† ‚îú‚îÄ‚îÄ deviceInfoLogic.go
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îÇ¬†¬† ‚îú‚îÄ‚îÄ incomeLogic.go
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îÇ¬†¬† ‚îú‚îÄ‚îÄ parkingLotLogic.go
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îÇ¬†¬† ‚îú‚îÄ‚îÄ siteInfoLogic.go
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îÇ¬†¬† ‚îú‚îÄ‚îÄ touristCarProvinceLogic.go
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îÇ¬†¬† ‚îú‚îÄ‚îÄ touristFlowLogic.go
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îÇ¬†¬† ‚îú‚îÄ‚îÄ userLogic.go
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îÇ¬†¬† ‚îî‚îÄ‚îÄ wechatLogic.go
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îú‚îÄ‚îÄ svc
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îÇ¬†¬† ‚îî‚îÄ‚îÄ serviceContext.go
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îî‚îÄ‚îÄ types
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îî‚îÄ‚îÄ types.go
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ park.api
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ park.go
‚îÇ¬†¬† ‚îî‚îÄ‚îÄ park.md
‚îú‚îÄ‚îÄ genModel
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ model
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îú‚îÄ‚îÄ accessModel.go
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îú‚îÄ‚îÄ accessModel_gen.go
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îú‚îÄ‚îÄ deviceInfoModel.go
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îú‚îÄ‚îÄ deviceInfoModel_gen.go
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îú‚îÄ‚îÄ incomeModel.go
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îú‚îÄ‚îÄ incomeModel_gen.go
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îú‚îÄ‚îÄ logErrModel.go
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îú‚îÄ‚îÄ logErrModel_gen.go
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îú‚îÄ‚îÄ parkingLotModel.go
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îú‚îÄ‚îÄ parkingLotModel_gen.go
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îú‚îÄ‚îÄ siteInfoModel.go
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îú‚îÄ‚îÄ siteInfoModel_gen.go
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îú‚îÄ‚îÄ touristCarProvinceModel.go
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îú‚îÄ‚îÄ touristCarProvinceModel_gen.go
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îú‚îÄ‚îÄ touristFlowModel.go
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îú‚îÄ‚îÄ touristFlowModel_gen.go
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îú‚îÄ‚îÄ userModel.go
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îú‚îÄ‚îÄ userModel_gen.go
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îú‚îÄ‚îÄ vars.go
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îú‚îÄ‚îÄ wechatModel.go
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îî‚îÄ‚îÄ wechatModel_gen.go
‚îÇ¬†¬† ‚îî‚îÄ‚îÄ resources
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ genModel.sh
‚îÇ¬†¬† ‚îî‚îÄ‚îÄ park.sql
‚îú‚îÄ‚îÄ go.mod
‚îú‚îÄ‚îÄ go.sum
‚îî‚îÄ‚îÄ model
‚îú‚îÄ‚îÄ accessModel.go
‚îú‚îÄ‚îÄ accessModel_gen.go
‚îú‚îÄ‚îÄ deviceInfoModel.go
‚îú‚îÄ‚îÄ deviceInfoModel_gen.go
‚îú‚îÄ‚îÄ incomeModel.go
‚îú‚îÄ‚îÄ incomeModel_gen.go
‚îú‚îÄ‚îÄ logErrModel.go
‚îú‚îÄ‚îÄ logErrModel_gen.go
‚îú‚îÄ‚îÄ parkingLotModel.go
‚îú‚îÄ‚îÄ parkingLotModel_gen.go
‚îú‚îÄ‚îÄ siteInfoModel.go
‚îú‚îÄ‚îÄ siteInfoModel_gen.go
‚îú‚îÄ‚îÄ touristCarProvinceModel.go
‚îú‚îÄ‚îÄ touristCarProvinceModel_gen.go
‚îú‚îÄ‚îÄ touristFlowModel.go
‚îú‚îÄ‚îÄ touristFlowModel_gen.go
‚îú‚îÄ‚îÄ userModel.go
‚îú‚îÄ‚îÄ userModel_gen.go
‚îú‚îÄ‚îÄ vars.go
‚îú‚îÄ‚îÄ wechatModel.go
‚îî‚îÄ‚îÄ wechatModel_gen.go
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>&lt;code>api&lt;/code> Êñá‰ª∂Â§πÁî®‰∫éÂ≠òÊîæÂ§ñÈÉ®Ë∞ÉÁî®ÔºåÈúÄË¶ÅÊîπÂä®ÁöÑÊòØ &lt;code>*.api&lt;/code>, &lt;code>etc/*.yaml&lt;/code>, &lt;code>svc/serviceContext.go&lt;/code>, &lt;code>logic/*&lt;/code>Ôºå‰ΩúÁî®ÂàÜÂà´ÊòØÁîüÊàê api Ë∞ÉÁî®Ê°ÜÊû∂ÔºåÂÜôÈÖçÁΩÆÊñá‰ª∂ÔºåÂ∞ÜÊï∞ÊçÆÊ∑ªÂä†Âà∞ Context ‰æõÈÄªËæëË∞ÉÁî®ÔºåÈÄªËæëÂÆûÁé∞„ÄÇ&lt;/li>
&lt;li>&lt;code>genModel&lt;/code> Êñá‰ª∂Â§πÁî®‰∫éÁîüÊàêÊï∞ÊçÆÂ∫ìË∞ÉÁî®Áõ∏ÂÖ≥ÂÆûÁé∞ÔºåÈúÄË¶ÅÊîπÂä®ÁöÑÊòØ&lt;code>resources/*.sql&lt;/code>„ÄÇ&lt;/li>
&lt;li>&lt;code>model&lt;/code> Êñá‰ª∂Â§πÁî®‰∫éÊ∑ªÂä†È¢ùÂ§ñÁöÑÊï∞ÊçÆÂ∫ìË∞ÉÁî®ÈÄªËæëÔºàÂ∞Ü&lt;code>genModel/model/*&lt;/code>Â§çÂà∂Âà∞ model ÂêéÂºÄÊîπÔºÅÔºâ&lt;/li>
&lt;/ul>
&lt;h3 id="ÁÆÄÂçï‰ΩøÁî®">ÁÆÄÂçï‰ΩøÁî®&lt;/h3>
&lt;p>ÈÄöËøá goctl ÁîüÊàê‰ª£Á†ÅÊ°ÜÊû∂„ÄÇ&lt;/p>
&lt;h4 id="api-Ê°ÜÊû∂ÈÄöËøá-apiapiÁîüÊàê">API Ê°ÜÊû∂ÈÄöËøá &lt;code>api/*.api&lt;/code>ÁîüÊàê&lt;/h4>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt"> 10
&lt;/span>&lt;span class="lnt"> 11
&lt;/span>&lt;span class="lnt"> 12
&lt;/span>&lt;span class="lnt"> 13
&lt;/span>&lt;span class="lnt"> 14
&lt;/span>&lt;span class="lnt"> 15
&lt;/span>&lt;span class="lnt"> 16
&lt;/span>&lt;span class="lnt"> 17
&lt;/span>&lt;span class="lnt"> 18
&lt;/span>&lt;span class="lnt"> 19
&lt;/span>&lt;span class="lnt"> 20
&lt;/span>&lt;span class="lnt"> 21
&lt;/span>&lt;span class="lnt"> 22
&lt;/span>&lt;span class="lnt"> 23
&lt;/span>&lt;span class="lnt"> 24
&lt;/span>&lt;span class="lnt"> 25
&lt;/span>&lt;span class="lnt"> 26
&lt;/span>&lt;span class="lnt"> 27
&lt;/span>&lt;span class="lnt"> 28
&lt;/span>&lt;span class="lnt"> 29
&lt;/span>&lt;span class="lnt"> 30
&lt;/span>&lt;span class="lnt"> 31
&lt;/span>&lt;span class="lnt"> 32
&lt;/span>&lt;span class="lnt"> 33
&lt;/span>&lt;span class="lnt"> 34
&lt;/span>&lt;span class="lnt"> 35
&lt;/span>&lt;span class="lnt"> 36
&lt;/span>&lt;span class="lnt"> 37
&lt;/span>&lt;span class="lnt"> 38
&lt;/span>&lt;span class="lnt"> 39
&lt;/span>&lt;span class="lnt"> 40
&lt;/span>&lt;span class="lnt"> 41
&lt;/span>&lt;span class="lnt"> 42
&lt;/span>&lt;span class="lnt"> 43
&lt;/span>&lt;span class="lnt"> 44
&lt;/span>&lt;span class="lnt"> 45
&lt;/span>&lt;span class="lnt"> 46
&lt;/span>&lt;span class="lnt"> 47
&lt;/span>&lt;span class="lnt"> 48
&lt;/span>&lt;span class="lnt"> 49
&lt;/span>&lt;span class="lnt"> 50
&lt;/span>&lt;span class="lnt"> 51
&lt;/span>&lt;span class="lnt"> 52
&lt;/span>&lt;span class="lnt"> 53
&lt;/span>&lt;span class="lnt"> 54
&lt;/span>&lt;span class="lnt"> 55
&lt;/span>&lt;span class="lnt"> 56
&lt;/span>&lt;span class="lnt"> 57
&lt;/span>&lt;span class="lnt"> 58
&lt;/span>&lt;span class="lnt"> 59
&lt;/span>&lt;span class="lnt"> 60
&lt;/span>&lt;span class="lnt"> 61
&lt;/span>&lt;span class="lnt"> 62
&lt;/span>&lt;span class="lnt"> 63
&lt;/span>&lt;span class="lnt"> 64
&lt;/span>&lt;span class="lnt"> 65
&lt;/span>&lt;span class="lnt"> 66
&lt;/span>&lt;span class="lnt"> 67
&lt;/span>&lt;span class="lnt"> 68
&lt;/span>&lt;span class="lnt"> 69
&lt;/span>&lt;span class="lnt"> 70
&lt;/span>&lt;span class="lnt"> 71
&lt;/span>&lt;span class="lnt"> 72
&lt;/span>&lt;span class="lnt"> 73
&lt;/span>&lt;span class="lnt"> 74
&lt;/span>&lt;span class="lnt"> 75
&lt;/span>&lt;span class="lnt"> 76
&lt;/span>&lt;span class="lnt"> 77
&lt;/span>&lt;span class="lnt"> 78
&lt;/span>&lt;span class="lnt"> 79
&lt;/span>&lt;span class="lnt"> 80
&lt;/span>&lt;span class="lnt"> 81
&lt;/span>&lt;span class="lnt"> 82
&lt;/span>&lt;span class="lnt"> 83
&lt;/span>&lt;span class="lnt"> 84
&lt;/span>&lt;span class="lnt"> 85
&lt;/span>&lt;span class="lnt"> 86
&lt;/span>&lt;span class="lnt"> 87
&lt;/span>&lt;span class="lnt"> 88
&lt;/span>&lt;span class="lnt"> 89
&lt;/span>&lt;span class="lnt"> 90
&lt;/span>&lt;span class="lnt"> 91
&lt;/span>&lt;span class="lnt"> 92
&lt;/span>&lt;span class="lnt"> 93
&lt;/span>&lt;span class="lnt"> 94
&lt;/span>&lt;span class="lnt"> 95
&lt;/span>&lt;span class="lnt"> 96
&lt;/span>&lt;span class="lnt"> 97
&lt;/span>&lt;span class="lnt"> 98
&lt;/span>&lt;span class="lnt"> 99
&lt;/span>&lt;span class="lnt">100
&lt;/span>&lt;span class="lnt">101
&lt;/span>&lt;span class="lnt">102
&lt;/span>&lt;span class="lnt">103
&lt;/span>&lt;span class="lnt">104
&lt;/span>&lt;span class="lnt">105
&lt;/span>&lt;span class="lnt">106
&lt;/span>&lt;span class="lnt">107
&lt;/span>&lt;span class="lnt">108
&lt;/span>&lt;span class="lnt">109
&lt;/span>&lt;span class="lnt">110
&lt;/span>&lt;span class="lnt">111
&lt;/span>&lt;span class="lnt">112
&lt;/span>&lt;span class="lnt">113
&lt;/span>&lt;span class="lnt">114
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="c1">//park.api
&lt;/span>&lt;span class="c1">&lt;/span>&lt;span class="nx">syntax&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">&amp;#34;v1&amp;#34;&lt;/span>
&lt;span class="nf">info&lt;/span>&lt;span class="p">(&lt;/span>
&lt;span class="nx">title&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s">&amp;#34;parkApi&amp;#34;&lt;/span>
&lt;span class="nx">desc&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s">&amp;#34;parkBackEnd&amp;#34;&lt;/span>
&lt;span class="nx">author&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s">&amp;#34;loomt&amp;#34;&lt;/span>
&lt;span class="nx">email&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s">&amp;#34;loomt_@outlook.com&amp;#34;&lt;/span>
&lt;span class="nx">version&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s">&amp;#34;1.0&amp;#34;&lt;/span>
&lt;span class="p">)&lt;/span>
&lt;span class="kd">type&lt;/span> &lt;span class="p">(&lt;/span>
&lt;span class="nx">accessResp&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">Id&lt;/span> &lt;span class="kt">int64&lt;/span> &lt;span class="s">`json:&amp;#34;id&amp;#34;`&lt;/span>
&lt;span class="nx">Location&lt;/span> &lt;span class="kt">string&lt;/span> &lt;span class="s">`json:&amp;#34;location&amp;#34;`&lt;/span> &lt;span class="c1">// Êé•ÂÖ•Âú∞ÁÇπ
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="nx">Date&lt;/span> &lt;span class="kt">string&lt;/span> &lt;span class="s">`json:&amp;#34;date&amp;#34;`&lt;/span> &lt;span class="c1">// Êé•ÂÖ•Êó•Êúü
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="nx">Num&lt;/span> &lt;span class="kt">int64&lt;/span> &lt;span class="s">`json:&amp;#34;num&amp;#34;`&lt;/span> &lt;span class="c1">// Êé•ÂÖ•Êï∞Èáè
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="nx">incomeResp&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">Id&lt;/span> &lt;span class="kt">int64&lt;/span> &lt;span class="s">`json:&amp;#34;id&amp;#34;`&lt;/span>
&lt;span class="nx">Type&lt;/span> &lt;span class="kt">string&lt;/span> &lt;span class="s">`json:&amp;#34;type&amp;#34;`&lt;/span> &lt;span class="c1">// Êî∂ÂÖ•Á±ªÂûã
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="nx">Date&lt;/span> &lt;span class="kt">string&lt;/span> &lt;span class="s">`json:&amp;#34;date&amp;#34;`&lt;/span> &lt;span class="c1">// Êó•Êúü
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="nx">Num&lt;/span> &lt;span class="kt">int64&lt;/span> &lt;span class="s">`json:&amp;#34;num&amp;#34;`&lt;/span> &lt;span class="c1">// ÂΩìÂ§©Êî∂ÂÖ•
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="nx">parkingLotResp&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">Id&lt;/span> &lt;span class="kt">int64&lt;/span> &lt;span class="s">`json:&amp;#34;id&amp;#34;`&lt;/span>
&lt;span class="nx">Name&lt;/span> &lt;span class="kt">string&lt;/span> &lt;span class="s">`json:&amp;#34;name&amp;#34;`&lt;/span> &lt;span class="c1">// ÂÅúËΩ¶Âú∫ÂêçÂ≠ó
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="nx">Duration&lt;/span> &lt;span class="kt">int64&lt;/span> &lt;span class="s">`json:&amp;#34;duration&amp;#34;`&lt;/span> &lt;span class="c1">// ÂÅúËΩ¶Êó∂Èó¥ÔºàÂ∞èÊó∂Ôºâ
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="nx">Num&lt;/span> &lt;span class="kt">int64&lt;/span> &lt;span class="s">`json:&amp;#34;num&amp;#34;`&lt;/span> &lt;span class="c1">// Ê≥äËΩ¶Êï∞
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="nx">siteInfoResp&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">Id&lt;/span> &lt;span class="kt">int64&lt;/span> &lt;span class="s">`json:&amp;#34;id&amp;#34;`&lt;/span>
&lt;span class="nx">Date&lt;/span> &lt;span class="kt">string&lt;/span> &lt;span class="s">`json:&amp;#34;date&amp;#34;`&lt;/span> &lt;span class="c1">// Êó•Êúü
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="nx">RevisitRate&lt;/span> &lt;span class="kt">int64&lt;/span> &lt;span class="s">`json:&amp;#34;revisit_rate&amp;#34;`&lt;/span> &lt;span class="c1">// ÈáçÂ§çËÆøÈóÆÁéáÔºà%Ôºâ
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="nx">SiteHealth&lt;/span> &lt;span class="kt">int64&lt;/span> &lt;span class="s">`json:&amp;#34;site_health&amp;#34;`&lt;/span> &lt;span class="c1">// Á´ôÁÇπÂÅ•Â∫∑Â∫¶
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="nx">RfHealth&lt;/span> &lt;span class="kt">int64&lt;/span> &lt;span class="s">`json:&amp;#34;rf_health&amp;#34;`&lt;/span> &lt;span class="c1">// Â∞ÑÈ¢ëÂÅ•Â∫∑Â∫¶
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="nx">DeviceHealth&lt;/span> &lt;span class="kt">int64&lt;/span> &lt;span class="s">`json:&amp;#34;device_health&amp;#34;`&lt;/span> &lt;span class="c1">// ËÆæÂ§áÂÅ•Â∫∑Â∫¶
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="nx">Flow&lt;/span> &lt;span class="kt">int64&lt;/span> &lt;span class="s">`json:&amp;#34;flow&amp;#34;`&lt;/span> &lt;span class="c1">// ÂΩìÊó•Á´ôÁÇπÊµÅÈáè
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="nx">touristFlowResp&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">Id&lt;/span> &lt;span class="kt">int64&lt;/span> &lt;span class="s">`json:&amp;#34;id&amp;#34;`&lt;/span>
&lt;span class="nx">Location&lt;/span> &lt;span class="kt">string&lt;/span> &lt;span class="s">`json:&amp;#34;location&amp;#34;`&lt;/span> &lt;span class="c1">// Âõ≠Âå∫Âú∞ÁÇπ
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="nx">Date&lt;/span> &lt;span class="kt">string&lt;/span> &lt;span class="s">`json:&amp;#34;date&amp;#34;`&lt;/span> &lt;span class="c1">// Êó∂Èó¥
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="nx">Num&lt;/span> &lt;span class="kt">int64&lt;/span> &lt;span class="s">`json:&amp;#34;num&amp;#34;`&lt;/span> &lt;span class="c1">// Ê∏∏ÂÆ¢Êï∞Èáè
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="nx">touristCarProvinceResp&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">Id&lt;/span> &lt;span class="kt">int64&lt;/span> &lt;span class="s">`json:&amp;#34;id&amp;#34;`&lt;/span>
&lt;span class="nx">Province&lt;/span> &lt;span class="kt">string&lt;/span> &lt;span class="s">`json:&amp;#34;province&amp;#34;`&lt;/span> &lt;span class="c1">// ÁúÅ‰ªΩ
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="nx">Date&lt;/span> &lt;span class="kt">string&lt;/span> &lt;span class="s">`json:&amp;#34;date&amp;#34;`&lt;/span> &lt;span class="c1">// Êó•Êúü
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="nx">FlowNum&lt;/span> &lt;span class="kt">int64&lt;/span> &lt;span class="s">`json:&amp;#34;flow_num&amp;#34;`&lt;/span> &lt;span class="c1">// ‰∫∫ÊµÅÊï∞Èáè
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="nx">CarNum&lt;/span> &lt;span class="kt">int64&lt;/span> &lt;span class="s">`json:&amp;#34;car_num&amp;#34;`&lt;/span> &lt;span class="c1">// ËΩ¶ËæÜÊï∞
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="nx">userReq&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">Id&lt;/span> &lt;span class="kt">int64&lt;/span> &lt;span class="s">`json:&amp;#34;id&amp;#34;`&lt;/span> &lt;span class="c1">// Áî®Êà∑ id
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="nx">userResp&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">Id&lt;/span> &lt;span class="kt">int64&lt;/span> &lt;span class="s">`json:&amp;#34;id&amp;#34;`&lt;/span> &lt;span class="c1">// Áî®Êà∑ id
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="nx">Username&lt;/span> &lt;span class="kt">string&lt;/span> &lt;span class="s">`json:&amp;#34;username&amp;#34;`&lt;/span> &lt;span class="c1">// Áî®Êà∑Âêç
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="nx">wechatResp&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">Date&lt;/span> &lt;span class="kt">string&lt;/span> &lt;span class="s">`json:&amp;#34;date&amp;#34;`&lt;/span> &lt;span class="c1">// Êó•Êúü
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="nx">Num&lt;/span> &lt;span class="kt">int64&lt;/span> &lt;span class="s">`json:&amp;#34;num&amp;#34;`&lt;/span> &lt;span class="c1">// ÂæÆ‰ø°ÂÖ≥Ê≥®Êï∞Èáè
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="nx">deviceInfoResp&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">Id&lt;/span> &lt;span class="kt">int64&lt;/span> &lt;span class="s">`json:&amp;#34;id&amp;#34;`&lt;/span>
&lt;span class="nx">UplinkRate&lt;/span> &lt;span class="kt">float64&lt;/span> &lt;span class="s">`json:&amp;#34;uplink_rate&amp;#34;`&lt;/span> &lt;span class="c1">// ‰∏äË°åÈÄüÁéá
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="nx">DownlinkRate&lt;/span> &lt;span class="kt">float64&lt;/span> &lt;span class="s">`json:&amp;#34;downlink_rate&amp;#34;`&lt;/span> &lt;span class="c1">// ‰∏ãËΩΩÈÄüÁéá
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="nx">Flow&lt;/span> &lt;span class="kt">float64&lt;/span> &lt;span class="s">`json:&amp;#34;flow&amp;#34;`&lt;/span> &lt;span class="c1">// ÊµÅÈáè
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="nx">CpuRate&lt;/span> &lt;span class="kt">float64&lt;/span> &lt;span class="s">`json:&amp;#34;cpu_rate&amp;#34;`&lt;/span> &lt;span class="c1">// CPU Âç†ÊúâÁéá
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="nx">Longitude&lt;/span> &lt;span class="kt">float64&lt;/span> &lt;span class="s">`json:&amp;#34;longitude&amp;#34;`&lt;/span> &lt;span class="c1">// ÁªèÂ∫¶
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="nx">Latitude&lt;/span> &lt;span class="kt">float64&lt;/span> &lt;span class="s">`json:&amp;#34;latitude&amp;#34;`&lt;/span> &lt;span class="c1">// Á∫¨Â∫¶
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="p">)&lt;/span>
&lt;span class="err">@&lt;/span>&lt;span class="nf">server&lt;/span>&lt;span class="p">(&lt;/span>
&lt;span class="nx">prefix&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">api&lt;/span>
&lt;span class="p">)&lt;/span>
&lt;span class="nx">service&lt;/span> &lt;span class="nx">park&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">api&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="err">@&lt;/span>&lt;span class="nx">doc&lt;/span> &lt;span class="s">&amp;#34;Ëé∑ÂèñÊé•ÂÖ•ËØ¶ÊÉÖ&amp;#34;&lt;/span>
&lt;span class="err">@&lt;/span>&lt;span class="nx">handler&lt;/span> &lt;span class="nx">accessHandler&lt;/span>
&lt;span class="nx">get&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">access&lt;/span> &lt;span class="nf">returns&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">accessResp&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="err">@&lt;/span>&lt;span class="nx">doc&lt;/span> &lt;span class="s">&amp;#34;Ëé∑ÂèñÊó•Êî∂ÂÖ•ËØ¶ÊÉÖ&amp;#34;&lt;/span>
&lt;span class="err">@&lt;/span>&lt;span class="nx">handler&lt;/span> &lt;span class="nx">incomeHandler&lt;/span>
&lt;span class="nx">get&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">income&lt;/span> &lt;span class="nf">returns&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">incomeResp&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="err">@&lt;/span>&lt;span class="nx">doc&lt;/span> &lt;span class="s">&amp;#34;Ëé∑ÂèñÂÅúËΩ¶ËØ¶ÊÉÖ&amp;#34;&lt;/span>
&lt;span class="err">@&lt;/span>&lt;span class="nx">handler&lt;/span> &lt;span class="nx">parkingLotHandler&lt;/span>
&lt;span class="nx">get&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">parkingLot&lt;/span> &lt;span class="nf">returns&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">parkingLotResp&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="err">@&lt;/span>&lt;span class="nx">doc&lt;/span> &lt;span class="s">&amp;#34;Ëé∑ÂèñÁ´ôÁÇπËØ¶ÊÉÖ&amp;#34;&lt;/span>
&lt;span class="err">@&lt;/span>&lt;span class="nx">handler&lt;/span> &lt;span class="nx">siteInfoHandler&lt;/span>
&lt;span class="nx">get&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">siteInfo&lt;/span> &lt;span class="nf">returns&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">siteInfoResp&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="err">@&lt;/span>&lt;span class="nx">doc&lt;/span> &lt;span class="s">&amp;#34;Ëé∑ÂèñÂÆ¢ÊµÅÈáèËØ¶ÊÉÖ&amp;#34;&lt;/span>
&lt;span class="err">@&lt;/span>&lt;span class="nx">handler&lt;/span> &lt;span class="nx">touristFlowHandler&lt;/span>
&lt;span class="nx">get&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">touristFlow&lt;/span> &lt;span class="nf">returns&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">touristFlowResp&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="err">@&lt;/span>&lt;span class="nx">doc&lt;/span> &lt;span class="s">&amp;#34;Ëé∑ÂèñÊ∏∏ÂÆ¢‰∏éËΩ¶ËæÜÊù•Ê∫êÁúÅ‰ªΩ&amp;#34;&lt;/span>
&lt;span class="err">@&lt;/span>&lt;span class="nx">handler&lt;/span> &lt;span class="nx">touristCarProvinceHandler&lt;/span>
&lt;span class="nx">get&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">touristCarProvince&lt;/span> &lt;span class="nf">returns&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">touristCarProvinceResp&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="err">@&lt;/span>&lt;span class="nx">doc&lt;/span> &lt;span class="s">&amp;#34;Ëé∑ÂèñÁî®Êà∑ËØ¶ÊÉÖ&amp;#34;&lt;/span>
&lt;span class="err">@&lt;/span>&lt;span class="nx">handler&lt;/span> &lt;span class="nx">userHandler&lt;/span>
&lt;span class="nx">post&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nf">user&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">userReq&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nf">returns&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">userResp&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="err">@&lt;/span>&lt;span class="nx">doc&lt;/span> &lt;span class="s">&amp;#34;Ëé∑ÂèñÂæÆ‰ø°ÂÖ≥Ê≥®ËØ¶ÊÉÖ&amp;#34;&lt;/span>
&lt;span class="err">@&lt;/span>&lt;span class="nx">handler&lt;/span> &lt;span class="nx">wechatHandler&lt;/span>
&lt;span class="nx">get&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">wechat&lt;/span> &lt;span class="nf">returns&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">wechatResp&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="err">@&lt;/span>&lt;span class="nx">doc&lt;/span> &lt;span class="s">&amp;#34;Ëé∑ÂèñËÆæÂ§á‰ø°ÊÅØ&amp;#34;&lt;/span>
&lt;span class="err">@&lt;/span>&lt;span class="nx">handler&lt;/span> &lt;span class="nx">deviceInfoHandler&lt;/span>
&lt;span class="nx">get&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">deviceInfo&lt;/span> &lt;span class="nf">returns&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">deviceInfoResp&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="c1"># api&lt;/span>
goctl api go -api *.api -dir ./ --style&lt;span class="o">=&lt;/span>goZero
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="model-Ê°ÜÊû∂Êúâ‰∏§ÁßçÁîüÊàêÊñπÂºè">MODEL Ê°ÜÊû∂Êúâ‰∏§ÁßçÁîüÊàêÊñπÂºè&lt;/h4>
&lt;ul>
&lt;li>ËøûÊé•Êï∞ÊçÆÂ∫ìÁîüÊàê model&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-zsh" data-lang="zsh">&lt;span class="cp">#!/usr/bin/env zsh
&lt;/span>&lt;span class="cp">&lt;/span>&lt;span class="c1"># ‰ΩøÁî®ÊñπÊ≥ïÔºö&lt;/span>
&lt;span class="c1"># ./genModel.sh usercenter user&lt;/span>
&lt;span class="c1"># ./genModel.sh usercenter user_auth&lt;/span>
&lt;span class="c1"># ÂÜçÂ∞Ü./genModel‰∏ãÁöÑÊñá‰ª∂Ââ™ÂàáÂà∞ÂØπÂ∫îÊúçÂä°ÁöÑmodelÁõÆÂΩïÈáåÈù¢ÔºåËÆ∞ÂæóÊîπpackage&lt;/span>
&lt;span class="c1">#ÁîüÊàêÁöÑË°®Âêç&lt;/span>
&lt;span class="nv">tables&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nv">$2&lt;/span>
&lt;span class="c1">#Ë°®ÁîüÊàêÁöÑgenmodelÁõÆÂΩï&lt;/span>
&lt;span class="nv">modeldir&lt;/span>&lt;span class="o">=&lt;/span>../model
&lt;span class="c1"># Êï∞ÊçÆÂ∫ìÈÖçÁΩÆ&lt;/span>
&lt;span class="nv">host&lt;/span>&lt;span class="o">=&lt;/span>127.0.0.1
&lt;span class="nv">port&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">3306&lt;/span>
&lt;span class="nv">dbname&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nv">$1&lt;/span>
&lt;span class="nv">username&lt;/span>&lt;span class="o">=&lt;/span>root
&lt;span class="nv">passwd&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">123456&lt;/span>
&lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;ÂºÄÂßãÂàõÂª∫Â∫ìÔºö&lt;/span>&lt;span class="nv">$dbname&lt;/span>&lt;span class="s2"> ÁöÑË°®Ôºö&lt;/span>&lt;span class="nv">$2&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
goctl model mysql datasource -url&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">username&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">:&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">passwd&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">@tcp(&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">host&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">:&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">port&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">)/&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">dbname&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> -table&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">tables&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> -dir&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">modeldir&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> --style&lt;span class="o">=&lt;/span>goZero
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>Áõ¥Êé•Áî® sql Êñá‰ª∂ (&lt;code>genModel/resource/*.sql&lt;/code>) ÁîüÊàê model&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-zsh" data-lang="zsh">&lt;span class="c1"># genModel/resources&lt;/span>
goctl model mysql ddl -src&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;./*.sql&amp;#34;&lt;/span> -dir&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;../model&amp;#34;&lt;/span> --style&lt;span class="o">=&lt;/span>goZero
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="ÁîüÊàêÊñáÊ°£">ÁîüÊàêÊñáÊ°£&lt;/h4>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-zsh" data-lang="zsh">&lt;span class="c1"># ./&lt;/span>
goctl api doc -dir .
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="Âçé‰∏∫‰∫ëÈÉ®ÁΩ≤">Âçé‰∏∫‰∫ëÈÉ®ÁΩ≤&lt;/h2>
&lt;ol>
&lt;li>mysql ÂØºÂÖ•&lt;/li>
&lt;li>&lt;code>nohup go run *.go -f etc/*.yaml 2&amp;gt;&amp;amp;1 &amp;amp;&lt;/code>&lt;/li>
&lt;/ol></description><category domain="https://loomt.top/posts/">posts</category><category domain="https://loomt.top/tags/go-zero/">go-zero</category></item><item><title>Âçé‰∏∫‰∫ëÂÖ¨ÁΩëÈÉ®ÁΩ≤</title><link>https://loomt.top/posts/%E5%8D%8E%E4%B8%BA%E4%BA%91%E5%85%AC%E7%BD%91%E9%83%A8%E7%BD%B2/</link><guid isPermaLink="true">https://loomt.top/posts/%E5%8D%8E%E4%B8%BA%E4%BA%91%E5%85%AC%E7%BD%91%E9%83%A8%E7%BD%B2/</guid><pubDate>Tue, 08 Nov 2022 22:47:51 +0800</pubDate><author>loomt_@outlook.com (loomt)</author><copyright>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh)</copyright><description>&lt;h2 id="ËÆ∞‰∏ÄÊ¨°Âçé‰∏∫‰∫ëËÄÄ‰∫ëÊúçÂä°Âô®ÂÖ¨ÁΩëÈÉ®ÁΩ≤ÈóÆÈ¢ò">ËÆ∞‰∏ÄÊ¨°Âçé‰∏∫‰∫ëËÄÄ‰∫ëÊúçÂä°Âô®ÂÖ¨ÁΩëÈÉ®ÁΩ≤ÈóÆÈ¢ò&lt;/h2>
&lt;p>ÂºÄ‰∫ÜÂÆâÂÖ®ÁªÑÔºåÁî® caddy ÈÉ®ÁΩ≤‰∫Ü‰∏Ä‰∏™Â∞èÁΩëÈ°µÊù•ÊµãËØïÂÖ¨ÁΩëËÆøÈóÆ
&lt;img src="https://loomt.top/img/sky.jpg" alt="sky">&lt;/p>
&lt;p>&lt;img src="https://loomt.top/img/run-caddy.png" alt="run-caddy">&lt;/p>
&lt;p>ÂèØ‰ª•ÁúãÂà∞ÂÜÖÁΩëËÆøÈóÆÊòØÊ≠£Â∏∏ÁöÑ„ÄÇ‰πüÂèØ‰ª• ping ÈÄö&lt;/p>
&lt;p>&lt;img src="https://loomt.top/img/ping-cloud.png" alt="ping-cloud">&lt;/p>
&lt;p>Ê†πÊçÆÂçé‰∏∫‰∫ëÂÆòÁΩëÁªôÂá∫ÁöÑÊåáÂºïÊéíÊü•‰∫ÜÂæà‰πÖÔºåÁªëÂÆö‰∫ÜÂºπÊÄßÂÖ¨ÁΩë ipÔºåËÆæÁΩÆ‰∫ÜÂÆâÂÖ®ÁªÑ Sys-FullAccess„ÄÅACLÔºåÈÉΩÊó†Ê≥ïÁî®ÊµèËßàÂô®ËÆøÈóÆ„ÄÇ&lt;/p>
&lt;p>ÊúÄÂêéÂõûÂà∞ÊúçÂä°Âô® &lt;em>Êü•ËØ¢Èò≤ÁÅ´Â¢ôÁä∂ÊÄÅ&lt;/em>&lt;/p>
&lt;p>ÂÖ≥ÊéâÈò≤ÁÅ´Â¢ôÂ∞±ÂèØ‰ª•‰∫Ü
&lt;img src="https://loomt.top/img/disable-firewall.png" alt="disable-firewall">
ÂØπÁùÄÂçé‰∏∫‰∫ëÁöÑÊéßÂà∂Âè∞Êêû‰∫ÜÂæà‰πÖÂÆâÂÖ®ÁªÑÔºåËøò‰ª•‰∏∫ÂÆâÂÖ®ÁªÑÂì™ÈáåÈÖçÈîô‰∫ÜÔºåÊúÄÂêéÂèëÁé∞ÊòØÊúçÂä°Âô®Èò≤ÁÅ´Â¢ôÁöÑÈóÆÈ¢òüò≠&lt;/p></description><category domain="https://loomt.top/posts/">posts</category><category domain="https://loomt.top/tags/%E4%BA%91%E6%9C%8D%E5%8A%A1%E5%99%A8/">‰∫ëÊúçÂä°Âô®</category></item><item><title>Â∞èÁ±≥ 4A ÂçÉÂÖÜÁâàÂà∑ OpenWrt</title><link>https://loomt.top/posts/%E5%B0%8F%E7%B1%B34a%E5%8D%83%E5%85%86%E7%89%88%E5%88%B7openwrt/</link><guid isPermaLink="true">https://loomt.top/posts/%E5%B0%8F%E7%B1%B34a%E5%8D%83%E5%85%86%E7%89%88%E5%88%B7openwrt/</guid><pubDate>Fri, 12 Aug 2022 15:58:38 +0800</pubDate><author>loomt_@outlook.com (loomt)</author><copyright>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh)</copyright><description>&lt;blockquote>
&lt;p>ÊëÜÁÉÇÔºå‰∫éÊòØÂ∞ÜÁõÆÂÖâÁúãÂêë‰∫ÜÂÆ∂ÈáåÁöÑÂ∞èÁ±≥ 4a ÂçÉÂÖÜÁâàË∑ØÁî±Âô®ÔºåÂáÜÂ§áÂà∑‰∏™ Openwrt Áé©‰∏Ä‰∏ã„ÄÇ&lt;/p>
&lt;/blockquote>
&lt;p>Âéª&lt;a href="https://www.right.com.cn/forum/forum.php">ÊÅ©Â±±ËÆ∫Âùõ&lt;/a>ÈÄõ‰∫ÜÈÄõÔºåÊÑüËßâÂà∑ËΩØË∑ØÁî±ÂíåÂà∑ÊâãÊú∫Â∑Æ‰∏çÂ§™Â§ö„ÄÇ&lt;/p>
&lt;ol>
&lt;li>ÂÆâË£Ö BreedÔºàÈó≠Ê∫êÂÖçË¥πÁöÑ BootLoaderÔºåÂèàÁß∞‚Äú‰∏çÊ≠ªÈ∏ü‚ÄùÔºåÊúâ‰∫ÜÂÆÉÂ∞±ËÉΩËÇÜÊó†ÂøåÊÉÆÂú∞Âà∑ÂêÑÁßçÁ¨¨‰∏âÊñπÂåÖ‰∫Ü&lt;/li>
&lt;/ol>
&lt;p>Â¶ÇÊûú‰Ω†ÁöÑË∑ØÁî±Âô®ÊòØÂ∞èÁ±≥ 4A ÂçÉÂÖÜÁâàÔºåÂèØ‰ª•Áõ¥Êé•Áî®ÊÅ©Â±±ËÆ∫ÂùõÁöÑ&lt;a href="https://pan.loomt.top/Xiaomi4A/R4A.zip">Êó†ËÑëÁõ¥Ë£Ö Breed&lt;/a>ÔºõÂ¶ÇÊûú‰∏çÊòØÔºå‰πüÂèØ‰ª•Âéª&lt;a href="https://breed.hackpascal.net/">Breed ÂÆòÁΩë&lt;/a>‰∏ãËΩΩË∑ØÁî±Âô®ÁöÑÈÄÇÈÖçÂåÖÂπ∂Ëá™Ë°åÊêúÁ¥¢Â¶Ç‰ΩïÈÄöËøá Telnet ËøûÊé•Ë∑ØÁî±Âô®Âπ∂Âà∑ÂÖ• Breed„ÄÇ
&lt;img src="https://loomt.top/img/breed.png" alt="Breed">&lt;/p>
&lt;ol start="2">
&lt;li>Áî® Breed ÂÆâË£Ö OpenWrt&lt;/li>
&lt;/ol>
&lt;p>ËøôÈáåÊîæ‰∏Ä‰∏™&lt;a href="https://pan.loomt.top/Xiaomi4A/openwrt-ramips-mt7621-xiaomi_mi-router-4a-gigabit-squashfs-sysupgrade.bin">Â∞èÁ±≥ 4A ÂçÉÂÖÜÁâà OpenWrt Áõ¥Âà∑ÂåÖ&lt;/a>ÔºåÂÖ∂‰ªñË∑ØÁî±Âô®ÁöÑÂõ∫‰ª∂ÂèØ‰ª•ÂéªÊÅ©Â±±ËÆ∫ÂùõÈÄõÈÄõ„ÄÇ
&lt;style type="text/css">.notice{--root-color:#444;--root-background:#eff;--title-color:#fff;--title-background:#7bd;--warning-title:#c33;--warning-content:#fee;--info-title:#fb7;--info-content:#fec;--note-title:#6be;--note-content:#e7f2fa;--tip-title:#5a5;--tip-content:#efe}@media (prefers-color-scheme:dark){.notice{--root-color:#ddd;--root-background:#eff;--title-color:#fff;--title-background:#7bd;--warning-title:#800;--warning-content:#400;--info-title:#a50;--info-content:#420;--note-title:#069;--note-content:#023;--tip-title:#363;--tip-content:#121}}body.dark .notice{--root-color:#ddd;--root-background:#eff;--title-color:#fff;--title-background:#7bd;--warning-title:#800;--warning-content:#400;--info-title:#a50;--info-content:#420;--note-title:#069;--note-content:#023;--tip-title:#363;--tip-content:#121}.notice{padding:18px;line-height:24px;margin-bottom:24px;border-radius:4px;color:var(--root-color);background:var(--root-background)}.notice p:last-child{margin-bottom:0}.notice-title{margin:-18px -18px 12px;padding:4px 18px;border-radius:4px 4px 0 0;font-weight:700;color:var(--title-color);background:var(--title-background)}.notice.warning .notice-title{background:var(--warning-title)}.notice.warning{background:var(--warning-content)}.notice.info .notice-title{background:var(--info-title)}.notice.info{background:var(--info-content)}.notice.note .notice-title{background:var(--note-title)}.notice.note{background:var(--note-content)}.notice.tip .notice-title{background:var(--tip-title)}.notice.tip{background:var(--tip-content)}.icon-notice{display:inline-flex;align-self:center;margin-right:8px}.icon-notice img,.icon-notice svg{height:1em;width:1em;fill:currentColor}.icon-notice img,.icon-notice.baseline svg{top:.125em;position:relative}&lt;/style>
&lt;div>&lt;svg width="0" height="0" display="none" xmlns="http://www.w3.org/2000/svg">&lt;symbol id="tip-notice" viewBox="0 0 512 512" preserveAspectRatio="xMidYMid meet">&lt;path d="M504 256c0 136.967-111.033 248-248 248S8 392.967 8 256 119.033 8 256 8s248 111.033 248 248zM227.314 387.314l184-184c6.248-6.248 6.248-16.379 0-22.627l-22.627-22.627c-6.248-6.249-16.379-6.249-22.628 0L216 308.118l-70.059-70.059c-6.248-6.248-16.379-6.248-22.628 0l-22.627 22.627c-6.248 6.248-6.248 16.379 0 22.627l104 104c6.249 6.249 16.379 6.249 22.628.001z"/>&lt;/symbol>&lt;symbol id="note-notice" viewBox="0 0 512 512" preserveAspectRatio="xMidYMid meet">&lt;path d="M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"/>&lt;/symbol>&lt;symbol id="warning-notice" viewBox="0 0 576 512" preserveAspectRatio="xMidYMid meet">&lt;path d="M569.517 440.013C587.975 472.007 564.806 512 527.94 512H48.054c-36.937 0-59.999-40.055-41.577-71.987L246.423 23.985c18.467-32.009 64.72-31.951 83.154 0l239.94 416.028zM288 354c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"/>&lt;/symbol>&lt;symbol id="info-notice" viewBox="0 0 512 512" preserveAspectRatio="xMidYMid meet">&lt;path d="M256 8C119.043 8 8 119.083 8 256c0 136.997 111.043 248 248 248s248-111.003 248-248C504 119.083 392.957 8 256 8zm0 110c23.196 0 42 18.804 42 42s-18.804 42-42 42-42-18.804-42-42 18.804-42 42-42zm56 254c0 6.627-5.373 12-12 12h-88c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h12v-64h-12c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h64c6.627 0 12 5.373 12 12v100h12c6.627 0 12 5.373 12 12v24z"/>&lt;/symbol>&lt;/svg>&lt;/div>&lt;div class="notice warning" >
&lt;p class="first notice-title">&lt;span class="icon-notice baseline">&lt;svg>&lt;use href="https://loomt.top/posts/%E5%B0%8F%E7%B1%B34a%E5%8D%83%E5%85%86%E7%89%88%E5%88%B7openwrt/#warning-notice">&lt;/use>&lt;/svg>&lt;/span>Ë≠¶Âëä&lt;/p>&lt;p>Âà∑ OpenWrt ‰πãÂâçÂøÖÈ°ªÁî® Breed Â§á‰ªΩ eepromÔºàÊ≤°ÊúâÂ§á‰ªΩ eeprom Â∞ÜÂØºËá¥ 5G ‰ø°Âè∑Â•áÂ∑ÆÔºâ&lt;/p>&lt;/div>
&lt;/p>
&lt;p>ÁÇπÂáªÂõ∫‰ª∂Êõ¥Êñ∞~&amp;gt;Â∏∏ËßÑÂõ∫‰ª∂~&amp;gt;Âãæ‰∏ä‚ÄúÂõ∫‰ª∂‚ÄùÂíå‚ÄúEEPROM‚ÄùÔºåÈÄâÊã©Â•Ω‰∏äÈù¢ÁöÑÁõ¥Âà∑ÂåÖÂíåÂ§á‰ªΩÁöÑ eeprom.binÔºå‰∏ä‰º†Âç≥ÂèØ„ÄÇ&lt;/p>
&lt;ol start="3">
&lt;li>ÈÖçÁΩÆ OpenWrt ÁöÑÂêÑÈ°πÂèÇÊï∞ÔºàÈöè‰æøÈÖç‰∏Ä‰∏ãÂç≥ÂèØ&lt;/li>
&lt;/ol>
&lt;p>OpenWrt ÂèØË∞ìÁ•ûÈÄöÂπøÂ§ßÔºå‰Ωú‰∏∫‰∏Ä‰∏™Âú®Ë∑ØÁî±Âô®‰∏äË∑ëÁöÑ LinuxÔºåÂÆÉÂèØ‰ª•Ë£Ö‰∏äÂêÑÁßçÊèí‰ª∂ÔºöÈÖ∏ÈÖ∏‰π≥„ÄÅDocker„ÄÅÁΩëÊòì‰∫ëËß£ÈîÅÁÅ∞Ëâ≤Ê≠åÊõ≤‚Ä¶‚Ä¶&lt;/p>
&lt;p>‰ΩÜÊàëÊäòËÖæ‰∫Ü‰∏ÄÈÄöÔºåË∞ÉÊïôÂ•ΩÂü∫Á°ÄÁöÑ‰∏äÁΩëÂäüËÉΩÂêéÔºåÊÑüËßâÁΩëÁªúÁä∂ÂÜµÂ§ß‰∏çÂ¶ÇÂâç„ÄÇ‰Ωú‰∏∫ÁôæÊù•ÂùóÁöÑË∑ØÁî±Âô®ÔºåÊú¨Êù•Â∞±Ê≤°ÊúâÂ§öÂ§ßÁöÑÂÜÖÂ≠òÔºåÊÑüËßâÂéüÂéÇÂõ∫‰ª∂ÁöÑË∞ÉÊïôÂ∑≤ÁªèÂ∞ÜÊÄßËÉΩÈÉΩÁî®Âú®ÂàÄÂàÉ‰∏ä‰∫Ü„ÄÇË£Ö‰∫Ü OpenWrt ÂêéËôΩÁÑ∂‰∏ä‰∏ãË°åÊµÅÈáèÈÄüÂ∫¶Ê≤°ÊúâÂæàÂ§ßÂèòÂåñÔºå‰ΩÜÁ®≥ÂÆöÊÄßÂ∑Æ‰∫ÜÂæàÂ§öÔºå‰æøÊáíÂæóÁªßÁª≠ÊäòËÖæÔºåÂøçÁóõ remake ‰∫Ü„ÄÇ&lt;/p>
&lt;ol start="4">
&lt;li>Âà∑ÂõûÂÆòÊñπÂåÖÔºàÊ≤°Â§á‰ªΩ eeprom ÁöÑÈóÆÈ¢ò &lt;strong>ÊàñËÆ∏&lt;/strong> ‰πüÂèØ‰ª•ÈÄöËøáÂà∑ÂõûÂÆòÊñπÂåÖÁöÑÊñπÊ≥ïËß£ÂÜ≥&lt;/li>
&lt;/ol>
&lt;p>‰∏ãËΩΩ&lt;a href="https://pan.loomt.top/Xiaomi4A/all.bin">Â∞èÁ±≥ 4A ÂçÉÂÖÜÁâàÂÆòÊñπÂåÖ&lt;/a>ÔºåËøõÂÖ• Breed~&amp;gt;Âõ∫‰ª∂Êõ¥Êñ∞~&amp;gt;ÁºñÁ®ãÂô®Âõ∫‰ª∂ (‰ªÖÂãæÈÄâËá™Âä®ÈáçÂêØ)~&amp;gt;‰∏ä‰º† all.bin„ÄÇ&lt;/p></description><category domain="https://loomt.top/posts/">posts</category></item><item><title>Auto7zip</title><link>https://loomt.top/posts/auto7zip/</link><guid isPermaLink="true">https://loomt.top/posts/auto7zip/</guid><pubDate>Wed, 20 Jul 2022 12:12:02 +0800</pubDate><author>loomt_@outlook.com (loomt)</author><copyright>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh)</copyright><description>&lt;h1 id="7-zip-ÂèåÂáªËá™Âä®Ëß£ÂéãÂéãÁº©Êñá‰ª∂">7-Zip ÂèåÂáªËá™Âä®Ëß£ÂéãÂéãÁº©Êñá‰ª∂&lt;/h1>
&lt;blockquote>
&lt;p>Âõ†‰∏∫Èöæ‰ª•ÂøçÂèó 7zip ÁöÑÂè≥ÈîÆËß£ÂéãÊìç‰ΩúÔºåÈÄöËøá‰øÆÊîπÊ≥®ÂÜåË°®‰ª•Ëá™Âä®Ëß£Âéã„ÄÇ&lt;/p>
&lt;/blockquote>
&lt;ol>
&lt;li>ÊõøÊç¢ &lt;code>D:\\000000000000\\7-Zip&lt;/code> ‰∏∫ &lt;code>your\\path\\to\\7-Zip&lt;/code>&lt;/li>
&lt;li>Â∞Ü‰ª£Á†ÅÂ°ûËøõ.reg Êñá‰ª∂ÔºåÂèåÂáªÂç≥ÂèØ„ÄÇ&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt"> 10
&lt;/span>&lt;span class="lnt"> 11
&lt;/span>&lt;span class="lnt"> 12
&lt;/span>&lt;span class="lnt"> 13
&lt;/span>&lt;span class="lnt"> 14
&lt;/span>&lt;span class="lnt"> 15
&lt;/span>&lt;span class="lnt"> 16
&lt;/span>&lt;span class="lnt"> 17
&lt;/span>&lt;span class="lnt"> 18
&lt;/span>&lt;span class="lnt"> 19
&lt;/span>&lt;span class="lnt"> 20
&lt;/span>&lt;span class="lnt"> 21
&lt;/span>&lt;span class="lnt"> 22
&lt;/span>&lt;span class="lnt"> 23
&lt;/span>&lt;span class="lnt"> 24
&lt;/span>&lt;span class="lnt"> 25
&lt;/span>&lt;span class="lnt"> 26
&lt;/span>&lt;span class="lnt"> 27
&lt;/span>&lt;span class="lnt"> 28
&lt;/span>&lt;span class="lnt"> 29
&lt;/span>&lt;span class="lnt"> 30
&lt;/span>&lt;span class="lnt"> 31
&lt;/span>&lt;span class="lnt"> 32
&lt;/span>&lt;span class="lnt"> 33
&lt;/span>&lt;span class="lnt"> 34
&lt;/span>&lt;span class="lnt"> 35
&lt;/span>&lt;span class="lnt"> 36
&lt;/span>&lt;span class="lnt"> 37
&lt;/span>&lt;span class="lnt"> 38
&lt;/span>&lt;span class="lnt"> 39
&lt;/span>&lt;span class="lnt"> 40
&lt;/span>&lt;span class="lnt"> 41
&lt;/span>&lt;span class="lnt"> 42
&lt;/span>&lt;span class="lnt"> 43
&lt;/span>&lt;span class="lnt"> 44
&lt;/span>&lt;span class="lnt"> 45
&lt;/span>&lt;span class="lnt"> 46
&lt;/span>&lt;span class="lnt"> 47
&lt;/span>&lt;span class="lnt"> 48
&lt;/span>&lt;span class="lnt"> 49
&lt;/span>&lt;span class="lnt"> 50
&lt;/span>&lt;span class="lnt"> 51
&lt;/span>&lt;span class="lnt"> 52
&lt;/span>&lt;span class="lnt"> 53
&lt;/span>&lt;span class="lnt"> 54
&lt;/span>&lt;span class="lnt"> 55
&lt;/span>&lt;span class="lnt"> 56
&lt;/span>&lt;span class="lnt"> 57
&lt;/span>&lt;span class="lnt"> 58
&lt;/span>&lt;span class="lnt"> 59
&lt;/span>&lt;span class="lnt"> 60
&lt;/span>&lt;span class="lnt"> 61
&lt;/span>&lt;span class="lnt"> 62
&lt;/span>&lt;span class="lnt"> 63
&lt;/span>&lt;span class="lnt"> 64
&lt;/span>&lt;span class="lnt"> 65
&lt;/span>&lt;span class="lnt"> 66
&lt;/span>&lt;span class="lnt"> 67
&lt;/span>&lt;span class="lnt"> 68
&lt;/span>&lt;span class="lnt"> 69
&lt;/span>&lt;span class="lnt"> 70
&lt;/span>&lt;span class="lnt"> 71
&lt;/span>&lt;span class="lnt"> 72
&lt;/span>&lt;span class="lnt"> 73
&lt;/span>&lt;span class="lnt"> 74
&lt;/span>&lt;span class="lnt"> 75
&lt;/span>&lt;span class="lnt"> 76
&lt;/span>&lt;span class="lnt"> 77
&lt;/span>&lt;span class="lnt"> 78
&lt;/span>&lt;span class="lnt"> 79
&lt;/span>&lt;span class="lnt"> 80
&lt;/span>&lt;span class="lnt"> 81
&lt;/span>&lt;span class="lnt"> 82
&lt;/span>&lt;span class="lnt"> 83
&lt;/span>&lt;span class="lnt"> 84
&lt;/span>&lt;span class="lnt"> 85
&lt;/span>&lt;span class="lnt"> 86
&lt;/span>&lt;span class="lnt"> 87
&lt;/span>&lt;span class="lnt"> 88
&lt;/span>&lt;span class="lnt"> 89
&lt;/span>&lt;span class="lnt"> 90
&lt;/span>&lt;span class="lnt"> 91
&lt;/span>&lt;span class="lnt"> 92
&lt;/span>&lt;span class="lnt"> 93
&lt;/span>&lt;span class="lnt"> 94
&lt;/span>&lt;span class="lnt"> 95
&lt;/span>&lt;span class="lnt"> 96
&lt;/span>&lt;span class="lnt"> 97
&lt;/span>&lt;span class="lnt"> 98
&lt;/span>&lt;span class="lnt"> 99
&lt;/span>&lt;span class="lnt">100
&lt;/span>&lt;span class="lnt">101
&lt;/span>&lt;span class="lnt">102
&lt;/span>&lt;span class="lnt">103
&lt;/span>&lt;span class="lnt">104
&lt;/span>&lt;span class="lnt">105
&lt;/span>&lt;span class="lnt">106
&lt;/span>&lt;span class="lnt">107
&lt;/span>&lt;span class="lnt">108
&lt;/span>&lt;span class="lnt">109
&lt;/span>&lt;span class="lnt">110
&lt;/span>&lt;span class="lnt">111
&lt;/span>&lt;span class="lnt">112
&lt;/span>&lt;span class="lnt">113
&lt;/span>&lt;span class="lnt">114
&lt;/span>&lt;span class="lnt">115
&lt;/span>&lt;span class="lnt">116
&lt;/span>&lt;span class="lnt">117
&lt;/span>&lt;span class="lnt">118
&lt;/span>&lt;span class="lnt">119
&lt;/span>&lt;span class="lnt">120
&lt;/span>&lt;span class="lnt">121
&lt;/span>&lt;span class="lnt">122
&lt;/span>&lt;span class="lnt">123
&lt;/span>&lt;span class="lnt">124
&lt;/span>&lt;span class="lnt">125
&lt;/span>&lt;span class="lnt">126
&lt;/span>&lt;span class="lnt">127
&lt;/span>&lt;span class="lnt">128
&lt;/span>&lt;span class="lnt">129
&lt;/span>&lt;span class="lnt">130
&lt;/span>&lt;span class="lnt">131
&lt;/span>&lt;span class="lnt">132
&lt;/span>&lt;span class="lnt">133
&lt;/span>&lt;span class="lnt">134
&lt;/span>&lt;span class="lnt">135
&lt;/span>&lt;span class="lnt">136
&lt;/span>&lt;span class="lnt">137
&lt;/span>&lt;span class="lnt">138
&lt;/span>&lt;span class="lnt">139
&lt;/span>&lt;span class="lnt">140
&lt;/span>&lt;span class="lnt">141
&lt;/span>&lt;span class="lnt">142
&lt;/span>&lt;span class="lnt">143
&lt;/span>&lt;span class="lnt">144
&lt;/span>&lt;span class="lnt">145
&lt;/span>&lt;span class="lnt">146
&lt;/span>&lt;span class="lnt">147
&lt;/span>&lt;span class="lnt">148
&lt;/span>&lt;span class="lnt">149
&lt;/span>&lt;span class="lnt">150
&lt;/span>&lt;span class="lnt">151
&lt;/span>&lt;span class="lnt">152
&lt;/span>&lt;span class="lnt">153
&lt;/span>&lt;span class="lnt">154
&lt;/span>&lt;span class="lnt">155
&lt;/span>&lt;span class="lnt">156
&lt;/span>&lt;span class="lnt">157
&lt;/span>&lt;span class="lnt">158
&lt;/span>&lt;span class="lnt">159
&lt;/span>&lt;span class="lnt">160
&lt;/span>&lt;span class="lnt">161
&lt;/span>&lt;span class="lnt">162
&lt;/span>&lt;span class="lnt">163
&lt;/span>&lt;span class="lnt">164
&lt;/span>&lt;span class="lnt">165
&lt;/span>&lt;span class="lnt">166
&lt;/span>&lt;span class="lnt">167
&lt;/span>&lt;span class="lnt">168
&lt;/span>&lt;span class="lnt">169
&lt;/span>&lt;span class="lnt">170
&lt;/span>&lt;span class="lnt">171
&lt;/span>&lt;span class="lnt">172
&lt;/span>&lt;span class="lnt">173
&lt;/span>&lt;span class="lnt">174
&lt;/span>&lt;span class="lnt">175
&lt;/span>&lt;span class="lnt">176
&lt;/span>&lt;span class="lnt">177
&lt;/span>&lt;span class="lnt">178
&lt;/span>&lt;span class="lnt">179
&lt;/span>&lt;span class="lnt">180
&lt;/span>&lt;span class="lnt">181
&lt;/span>&lt;span class="lnt">182
&lt;/span>&lt;span class="lnt">183
&lt;/span>&lt;span class="lnt">184
&lt;/span>&lt;span class="lnt">185
&lt;/span>&lt;span class="lnt">186
&lt;/span>&lt;span class="lnt">187
&lt;/span>&lt;span class="lnt">188
&lt;/span>&lt;span class="lnt">189
&lt;/span>&lt;span class="lnt">190
&lt;/span>&lt;span class="lnt">191
&lt;/span>&lt;span class="lnt">192
&lt;/span>&lt;span class="lnt">193
&lt;/span>&lt;span class="lnt">194
&lt;/span>&lt;span class="lnt">195
&lt;/span>&lt;span class="lnt">196
&lt;/span>&lt;span class="lnt">197
&lt;/span>&lt;span class="lnt">198
&lt;/span>&lt;span class="lnt">199
&lt;/span>&lt;span class="lnt">200
&lt;/span>&lt;span class="lnt">201
&lt;/span>&lt;span class="lnt">202
&lt;/span>&lt;span class="lnt">203
&lt;/span>&lt;span class="lnt">204
&lt;/span>&lt;span class="lnt">205
&lt;/span>&lt;span class="lnt">206
&lt;/span>&lt;span class="lnt">207
&lt;/span>&lt;span class="lnt">208
&lt;/span>&lt;span class="lnt">209
&lt;/span>&lt;span class="lnt">210
&lt;/span>&lt;span class="lnt">211
&lt;/span>&lt;span class="lnt">212
&lt;/span>&lt;span class="lnt">213
&lt;/span>&lt;span class="lnt">214
&lt;/span>&lt;span class="lnt">215
&lt;/span>&lt;span class="lnt">216
&lt;/span>&lt;span class="lnt">217
&lt;/span>&lt;span class="lnt">218
&lt;/span>&lt;span class="lnt">219
&lt;/span>&lt;span class="lnt">220
&lt;/span>&lt;span class="lnt">221
&lt;/span>&lt;span class="lnt">222
&lt;/span>&lt;span class="lnt">223
&lt;/span>&lt;span class="lnt">224
&lt;/span>&lt;span class="lnt">225
&lt;/span>&lt;span class="lnt">226
&lt;/span>&lt;span class="lnt">227
&lt;/span>&lt;span class="lnt">228
&lt;/span>&lt;span class="lnt">229
&lt;/span>&lt;span class="lnt">230
&lt;/span>&lt;span class="lnt">231
&lt;/span>&lt;span class="lnt">232
&lt;/span>&lt;span class="lnt">233
&lt;/span>&lt;span class="lnt">234
&lt;/span>&lt;span class="lnt">235
&lt;/span>&lt;span class="lnt">236
&lt;/span>&lt;span class="lnt">237
&lt;/span>&lt;span class="lnt">238
&lt;/span>&lt;span class="lnt">239
&lt;/span>&lt;span class="lnt">240
&lt;/span>&lt;span class="lnt">241
&lt;/span>&lt;span class="lnt">242
&lt;/span>&lt;span class="lnt">243
&lt;/span>&lt;span class="lnt">244
&lt;/span>&lt;span class="lnt">245
&lt;/span>&lt;span class="lnt">246
&lt;/span>&lt;span class="lnt">247
&lt;/span>&lt;span class="lnt">248
&lt;/span>&lt;span class="lnt">249
&lt;/span>&lt;span class="lnt">250
&lt;/span>&lt;span class="lnt">251
&lt;/span>&lt;span class="lnt">252
&lt;/span>&lt;span class="lnt">253
&lt;/span>&lt;span class="lnt">254
&lt;/span>&lt;span class="lnt">255
&lt;/span>&lt;span class="lnt">256
&lt;/span>&lt;span class="lnt">257
&lt;/span>&lt;span class="lnt">258
&lt;/span>&lt;span class="lnt">259
&lt;/span>&lt;span class="lnt">260
&lt;/span>&lt;span class="lnt">261
&lt;/span>&lt;span class="lnt">262
&lt;/span>&lt;span class="lnt">263
&lt;/span>&lt;span class="lnt">264
&lt;/span>&lt;span class="lnt">265
&lt;/span>&lt;span class="lnt">266
&lt;/span>&lt;span class="lnt">267
&lt;/span>&lt;span class="lnt">268
&lt;/span>&lt;span class="lnt">269
&lt;/span>&lt;span class="lnt">270
&lt;/span>&lt;span class="lnt">271
&lt;/span>&lt;span class="lnt">272
&lt;/span>&lt;span class="lnt">273
&lt;/span>&lt;span class="lnt">274
&lt;/span>&lt;span class="lnt">275
&lt;/span>&lt;span class="lnt">276
&lt;/span>&lt;span class="lnt">277
&lt;/span>&lt;span class="lnt">278
&lt;/span>&lt;span class="lnt">279
&lt;/span>&lt;span class="lnt">280
&lt;/span>&lt;span class="lnt">281
&lt;/span>&lt;span class="lnt">282
&lt;/span>&lt;span class="lnt">283
&lt;/span>&lt;span class="lnt">284
&lt;/span>&lt;span class="lnt">285
&lt;/span>&lt;span class="lnt">286
&lt;/span>&lt;span class="lnt">287
&lt;/span>&lt;span class="lnt">288
&lt;/span>&lt;span class="lnt">289
&lt;/span>&lt;span class="lnt">290
&lt;/span>&lt;span class="lnt">291
&lt;/span>&lt;span class="lnt">292
&lt;/span>&lt;span class="lnt">293
&lt;/span>&lt;span class="lnt">294
&lt;/span>&lt;span class="lnt">295
&lt;/span>&lt;span class="lnt">296
&lt;/span>&lt;span class="lnt">297
&lt;/span>&lt;span class="lnt">298
&lt;/span>&lt;span class="lnt">299
&lt;/span>&lt;span class="lnt">300
&lt;/span>&lt;span class="lnt">301
&lt;/span>&lt;span class="lnt">302
&lt;/span>&lt;span class="lnt">303
&lt;/span>&lt;span class="lnt">304
&lt;/span>&lt;span class="lnt">305
&lt;/span>&lt;span class="lnt">306
&lt;/span>&lt;span class="lnt">307
&lt;/span>&lt;span class="lnt">308
&lt;/span>&lt;span class="lnt">309
&lt;/span>&lt;span class="lnt">310
&lt;/span>&lt;span class="lnt">311
&lt;/span>&lt;span class="lnt">312
&lt;/span>&lt;span class="lnt">313
&lt;/span>&lt;span class="lnt">314
&lt;/span>&lt;span class="lnt">315
&lt;/span>&lt;span class="lnt">316
&lt;/span>&lt;span class="lnt">317
&lt;/span>&lt;span class="lnt">318
&lt;/span>&lt;span class="lnt">319
&lt;/span>&lt;span class="lnt">320
&lt;/span>&lt;span class="lnt">321
&lt;/span>&lt;span class="lnt">322
&lt;/span>&lt;span class="lnt">323
&lt;/span>&lt;span class="lnt">324
&lt;/span>&lt;span class="lnt">325
&lt;/span>&lt;span class="lnt">326
&lt;/span>&lt;span class="lnt">327
&lt;/span>&lt;span class="lnt">328
&lt;/span>&lt;span class="lnt">329
&lt;/span>&lt;span class="lnt">330
&lt;/span>&lt;span class="lnt">331
&lt;/span>&lt;span class="lnt">332
&lt;/span>&lt;span class="lnt">333
&lt;/span>&lt;span class="lnt">334
&lt;/span>&lt;span class="lnt">335
&lt;/span>&lt;span class="lnt">336
&lt;/span>&lt;span class="lnt">337
&lt;/span>&lt;span class="lnt">338
&lt;/span>&lt;span class="lnt">339
&lt;/span>&lt;span class="lnt">340
&lt;/span>&lt;span class="lnt">341
&lt;/span>&lt;span class="lnt">342
&lt;/span>&lt;span class="lnt">343
&lt;/span>&lt;span class="lnt">344
&lt;/span>&lt;span class="lnt">345
&lt;/span>&lt;span class="lnt">346
&lt;/span>&lt;span class="lnt">347
&lt;/span>&lt;span class="lnt">348
&lt;/span>&lt;span class="lnt">349
&lt;/span>&lt;span class="lnt">350
&lt;/span>&lt;span class="lnt">351
&lt;/span>&lt;span class="lnt">352
&lt;/span>&lt;span class="lnt">353
&lt;/span>&lt;span class="lnt">354
&lt;/span>&lt;span class="lnt">355
&lt;/span>&lt;span class="lnt">356
&lt;/span>&lt;span class="lnt">357
&lt;/span>&lt;span class="lnt">358
&lt;/span>&lt;span class="lnt">359
&lt;/span>&lt;span class="lnt">360
&lt;/span>&lt;span class="lnt">361
&lt;/span>&lt;span class="lnt">362
&lt;/span>&lt;span class="lnt">363
&lt;/span>&lt;span class="lnt">364
&lt;/span>&lt;span class="lnt">365
&lt;/span>&lt;span class="lnt">366
&lt;/span>&lt;span class="lnt">367
&lt;/span>&lt;span class="lnt">368
&lt;/span>&lt;span class="lnt">369
&lt;/span>&lt;span class="lnt">370
&lt;/span>&lt;span class="lnt">371
&lt;/span>&lt;span class="lnt">372
&lt;/span>&lt;span class="lnt">373
&lt;/span>&lt;span class="lnt">374
&lt;/span>&lt;span class="lnt">375
&lt;/span>&lt;span class="lnt">376
&lt;/span>&lt;span class="lnt">377
&lt;/span>&lt;span class="lnt">378
&lt;/span>&lt;span class="lnt">379
&lt;/span>&lt;span class="lnt">380
&lt;/span>&lt;span class="lnt">381
&lt;/span>&lt;span class="lnt">382
&lt;/span>&lt;span class="lnt">383
&lt;/span>&lt;span class="lnt">384
&lt;/span>&lt;span class="lnt">385
&lt;/span>&lt;span class="lnt">386
&lt;/span>&lt;span class="lnt">387
&lt;/span>&lt;span class="lnt">388
&lt;/span>&lt;span class="lnt">389
&lt;/span>&lt;span class="lnt">390
&lt;/span>&lt;span class="lnt">391
&lt;/span>&lt;span class="lnt">392
&lt;/span>&lt;span class="lnt">393
&lt;/span>&lt;span class="lnt">394
&lt;/span>&lt;span class="lnt">395
&lt;/span>&lt;span class="lnt">396
&lt;/span>&lt;span class="lnt">397
&lt;/span>&lt;span class="lnt">398
&lt;/span>&lt;span class="lnt">399
&lt;/span>&lt;span class="lnt">400
&lt;/span>&lt;span class="lnt">401
&lt;/span>&lt;span class="lnt">402
&lt;/span>&lt;span class="lnt">403
&lt;/span>&lt;span class="lnt">404
&lt;/span>&lt;span class="lnt">405
&lt;/span>&lt;span class="lnt">406
&lt;/span>&lt;span class="lnt">407
&lt;/span>&lt;span class="lnt">408
&lt;/span>&lt;span class="lnt">409
&lt;/span>&lt;span class="lnt">410
&lt;/span>&lt;span class="lnt">411
&lt;/span>&lt;span class="lnt">412
&lt;/span>&lt;span class="lnt">413
&lt;/span>&lt;span class="lnt">414
&lt;/span>&lt;span class="lnt">415
&lt;/span>&lt;span class="lnt">416
&lt;/span>&lt;span class="lnt">417
&lt;/span>&lt;span class="lnt">418
&lt;/span>&lt;span class="lnt">419
&lt;/span>&lt;span class="lnt">420
&lt;/span>&lt;span class="lnt">421
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-reg" data-lang="reg">Windows Registry Editor Version 5.00
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.001\shell]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;extract&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.001\shell\extract]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;Extract to Folder&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.001\shell\extract\command]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;\&amp;#34;D:\\000000000000\\7-Zip\\7zG.exe\&amp;#34; x \&amp;#34;%1\&amp;#34; -o*&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.7z\shell]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;extract&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.7z\shell\extract]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;Extract to Folder&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.7z\shell\extract\command]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;\&amp;#34;D:\\000000000000\\7-Zip\\7zG.exe\&amp;#34; x \&amp;#34;%1\&amp;#34; -o*&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.arj\shell]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;extract&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.arj\shell\extract]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;Extract to Folder&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.arj\shell\extract\command]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;\&amp;#34;D:\\000000000000\\7-Zip\\7zG.exe\&amp;#34; x \&amp;#34;%1\&amp;#34; -o*&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.bz2\shell]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;extract&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.bz2\shell\extract]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;Extract to Folder&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.bz2\shell\extract\command]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;\&amp;#34;D:\\000000000000\\7-Zip\\7zG.exe\&amp;#34; x \&amp;#34;%1\&amp;#34; -o*&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.bzip2\shell]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;extract&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.bzip2\shell\extract]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;Extract to Folder&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.bzip2\shell\extract\command]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;\&amp;#34;D:\\000000000000\\7-Zip\\7zG.exe\&amp;#34; x \&amp;#34;%1\&amp;#34; -o*&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.cab\shell]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;extract&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.cab\shell\extract]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;Extract to Folder&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.cab\shell\extract\command]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;\&amp;#34;D:\\000000000000\\7-Zip\\7zG.exe\&amp;#34; x \&amp;#34;%1\&amp;#34; -o*&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.cpio\shell]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;extract&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.cpio\shell\extract]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;Extract to Folder&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.cpio\shell\extract\command]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;\&amp;#34;D:\\000000000000\\7-Zip\\7zG.exe\&amp;#34; x \&amp;#34;%1\&amp;#34; -o*&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.deb\shell]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;extract&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.deb\shell\extract]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;Extract to Folder&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.deb\shell\extract\command]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;\&amp;#34;D:\\000000000000\\7-Zip\\7zG.exe\&amp;#34; x \&amp;#34;%1\&amp;#34; -o*&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.dmg\shell]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;extract&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.dmg\shell\extract]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;Extract to Folder&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.dmg\shell\extract\command]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;\&amp;#34;D:\\000000000000\\7-Zip\\7zG.exe\&amp;#34; x \&amp;#34;%1\&amp;#34; -o*&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.fat\shell]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;extract&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.fat\shell\extract]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;Extract to Folder&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.fat\shell\extract\command]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;\&amp;#34;D:\\000000000000\\7-Zip\\7zG.exe\&amp;#34; x \&amp;#34;%1\&amp;#34; -o*&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.gz\shell]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;extract&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.gz\shell\extract]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;Extract to Folder&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.gz\shell\extract\command]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;\&amp;#34;D:\\000000000000\\7-Zip\\7zG.exe\&amp;#34; x \&amp;#34;%1\&amp;#34; -o*&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.gzip\shell]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;extract&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.gzip\shell\extract]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;Extract to Folder&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.gzip\shell\extract\command]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;\&amp;#34;D:\\000000000000\\7-Zip\\7zG.exe\&amp;#34; x \&amp;#34;%1\&amp;#34; -o*&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.hfs\shell]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;extract&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.hfs\shell\extract]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;Extract to Folder&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.hfs\shell\extract\command]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;\&amp;#34;D:\\000000000000\\7-Zip\\7zG.exe\&amp;#34; x \&amp;#34;%1\&amp;#34; -o*&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.iso\shell]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;extract&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.iso\shell\extract]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;Extract to Folder&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.iso\shell\extract\command]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;\&amp;#34;D:\\000000000000\\7-Zip\\7zG.exe\&amp;#34; x \&amp;#34;%1\&amp;#34; -o*&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.lha\shell]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;extract&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.lha\shell\extract]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;Extract to Folder&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.lha\shell\extract\command]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;\&amp;#34;D:\\000000000000\\7-Zip\\7zG.exe\&amp;#34; x \&amp;#34;%1\&amp;#34; -o*&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.lzh\shell]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;extract&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.lzh\shell\extract]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;Extract to Folder&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.lzh\shell\extract\command]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;\&amp;#34;D:\\000000000000\\7-Zip\\7zG.exe\&amp;#34; x \&amp;#34;%1\&amp;#34; -o*&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.lzma\shell]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;extract&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.lzma\shell\extract]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;Extract to Folder&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.lzma\shell\extract\command]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;\&amp;#34;D:\\000000000000\\7-Zip\\7zG.exe\&amp;#34; x \&amp;#34;%1\&amp;#34; -o*&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.ntfs\shell]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;extract&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.ntfs\shell\extract]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;Extract to Folder&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.ntfs\shell\extract\command]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;\&amp;#34;D:\\000000000000\\7-Zip\\7zG.exe\&amp;#34; x \&amp;#34;%1\&amp;#34; -o*&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.rar\shell]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;extract&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.rar\shell\extract]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;Extract to Folder&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.rar\shell\extract\command]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;\&amp;#34;D:\\000000000000\\7-Zip\\7zG.exe\&amp;#34; x \&amp;#34;%1\&amp;#34; -o*&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.rpm\shell]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;extract&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.rpm\shell\extract]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;Extract to Folder&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.rpm\shell\extract\command]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;\&amp;#34;D:\\000000000000\\7-Zip\\7zG.exe\&amp;#34; x \&amp;#34;%1\&amp;#34; -o*&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.squashfs\shell]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;extract&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.squashfs\shell\extract]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;Extract to Folder&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.squashfs\shell\extract\command]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;\&amp;#34;D:\\000000000000\\7-Zip\\7zG.exe\&amp;#34; x \&amp;#34;%1\&amp;#34; -o*&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.swm\shell]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;extract&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.swm\shell\extract]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;Extract to Folder&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.swm\shell\extract\command]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;\&amp;#34;D:\\000000000000\\7-Zip\\7zG.exe\&amp;#34; x \&amp;#34;%1\&amp;#34; -o*&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.tar\shell]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;extract&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.tar\shell\extract]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;Extract to Folder&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.tar\shell\extract\command]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;\&amp;#34;D:\\000000000000\\7-Zip\\7zG.exe\&amp;#34; x \&amp;#34;%1\&amp;#34; -o*&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.taz\shell]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;extract&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.taz\shell\extract]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;Extract to Folder&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.taz\shell\extract\command]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;\&amp;#34;D:\\000000000000\\7-Zip\\7zG.exe\&amp;#34; x \&amp;#34;%1\&amp;#34; -o*&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.tbz\shell]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;extract&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.tbz\shell\extract]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;Extract to Folder&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.tbz\shell\extract\command]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;\&amp;#34;D:\\000000000000\\7-Zip\\7zG.exe\&amp;#34; x \&amp;#34;%1\&amp;#34; -o*&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.tbz2\shell]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;extract&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.tbz2\shell\extract]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;Extract to Folder&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.tbz2\shell\extract\command]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;\&amp;#34;D:\\000000000000\\7-Zip\\7zG.exe\&amp;#34; x \&amp;#34;%1\&amp;#34; -o*&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.tgz\shell]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;extract&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.tgz\shell\extract]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;Extract to Folder&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.tgz\shell\extract\command]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;\&amp;#34;D:\\000000000000\\7-Zip\\7zG.exe\&amp;#34; x \&amp;#34;%1\&amp;#34; -o*&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.tpz\shell]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;extract&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.tpz\shell\extract]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;Extract to Folder&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.tpz\shell\extract\command]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;\&amp;#34;D:\\000000000000\\7-Zip\\7zG.exe\&amp;#34; x \&amp;#34;%1\&amp;#34; -o*&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.txz\shell]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;extract&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.txz\shell\extract]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;Extract to Folder&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.txz\shell\extract\command]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;\&amp;#34;D:\\000000000000\\7-Zip\\7zG.exe\&amp;#34; x \&amp;#34;%1\&amp;#34; -o*&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.vhd\shell]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;extract&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.vhd\shell\extract]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;Extract to Folder&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.vhd\shell\extract\command]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;\&amp;#34;D:\\000000000000\\7-Zip\\7zG.exe\&amp;#34; x \&amp;#34;%1\&amp;#34; -o*&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.wim\shell]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;extract&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.wim\shell\extract]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;Extract to Folder&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.wim\shell\extract\command]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;\&amp;#34;D:\\000000000000\\7-Zip\\7zG.exe\&amp;#34; x \&amp;#34;%1\&amp;#34; -o*&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.xar\shell]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;extract&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.xar\shell\extract]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;Extract to Folder&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.xar\shell\extract\command]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;\&amp;#34;D:\\000000000000\\7-Zip\\7zG.exe\&amp;#34; x \&amp;#34;%1\&amp;#34; -o*&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.xz\shell]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;extract&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.xz\shell\extract]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;Extract to Folder&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.xz\shell\extract\command]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;\&amp;#34;D:\\000000000000\\7-Zip\\7zG.exe\&amp;#34; x \&amp;#34;%1\&amp;#34; -o*&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.z\shell]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;extract&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.z\shell\extract]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;Extract to Folder&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.z\shell\extract\command]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;\&amp;#34;D:\\000000000000\\7-Zip\\7zG.exe\&amp;#34; x \&amp;#34;%1\&amp;#34; -o*&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.zip\shell]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;extract&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.zip\shell\extract]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;Extract to Folder&amp;#34;&lt;/span>
&lt;span class="k">[&lt;/span>&lt;span class="nb">HKEY_CLASSES_ROOT&lt;/span>&lt;span class="k">\7-Zip.zip\shell\extract\command]&lt;/span>
&lt;span class="na">@&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;\&amp;#34;D:\\000000000000\\7-Zip\\7zG.exe\&amp;#34; x \&amp;#34;%1\&amp;#34; -o*&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;em>reference&lt;/em>&lt;/p>
&lt;p>&lt;a href="https://gist.github.com/zabbarob/5891200">https://gist.github.com/zabbarob/5891200&lt;/a>&lt;/p></description><category domain="https://loomt.top/posts/">posts</category></item><item><title>Âª∫Á´ô</title><link>https://loomt.top/posts/%E5%BB%BA%E7%AB%99/</link><guid isPermaLink="true">https://loomt.top/posts/%E5%BB%BA%E7%AB%99/</guid><pubDate>Fri, 15 Jul 2022 12:01:10 +0800</pubDate><author>loomt_@outlook.com (loomt)</author><copyright>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh)</copyright><description>&lt;p>&lt;img src="https://loomt.top/img/sky.jpg" alt="sky">&lt;/p>
&lt;blockquote>
&lt;p>ÂâçÊÆµÊó∂Èó¥ÁôΩÂ´ñ‰∫Ü‰∏Ä‰∏™ &lt;a href="https://loomt.eu.org">ÂüüÂêç&lt;/a> ÔºåÊöëÂÅáÊúâÊó∂Èó¥‰∫ÜËµ∂Á¥ßÁâ©Â∞ΩÂÖ∂Áî®Ôºå‰∫éÊòØËä±‰∫Ü‰∏ÄÂ§©ÁöÑÊó∂Èó¥ÈáçÊñ∞Âª∫‰∫Ü‰∏™Á´ôÔºàÂÖ∂ÂÆûÊàëÂæà‰πÖ‰πãÂâçÂ∞±Áî®Ëøá hexo Êó†ËÑëÂª∫Á´ôÔºå‰ΩÜÊúÄËøëÂèëÁé∞‰∫Ü‰∏Ä‰∏™ÁâπÂà´ÂñúÊ¨¢ÁöÑ&lt;a href="https://gohugo.io/">Hugo&lt;/a>‰∏ªÈ¢ò &lt;a href="https://github.com/reuixiy/hugo-theme-meme">MemE&lt;/a> Ôºâ&lt;/p>
&lt;/blockquote>
&lt;h1 id="ÁÆÄÁï•Ê≠•È™§">ÁÆÄÁï•Ê≠•È™§&lt;/h1>
&lt;h2 id="hugo-quick-start">Hugo Quick Start&lt;/h2>
&lt;ol>
&lt;li>Âú® wsl ‰∏ãË£Ö Hugo&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">$ sudo apt install hugo
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ol start="2">
&lt;li>TL;DR ‰∏Ä‰∏ã Hugo ÁöÑÂü∫Á°ÄÂëΩ‰ª§&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">$ tldr hugo
hugo
Template-based static site generator. Uses modules, components, and themes.More information: https://gohugo.io.
- Create a new Hugo site:
hugo new site &lt;span class="o">{{&lt;/span>path/to/site&lt;span class="o">}}&lt;/span>
- Create a new Hugo theme &lt;span class="o">(&lt;/span>themes may also be downloaded from https://themes.gohugo.io/&lt;span class="o">)&lt;/span>:
hugo new theme &lt;span class="o">{{&lt;/span>theme_name&lt;span class="o">}}&lt;/span>
- Create a new page:
hugo new &lt;span class="o">{{&lt;/span>section_name&lt;span class="o">}}&lt;/span>/&lt;span class="o">{{&lt;/span>filename&lt;span class="o">}}&lt;/span>
- Build a site to the ./public/ directory:
hugo
- Build a site including pages that are marked as a &lt;span class="s2">&amp;#34;draft&amp;#34;&lt;/span>:
hugo --buildDrafts
- Build a site to a given directory:
hugo --destination &lt;span class="o">{{&lt;/span>path/to/destination&lt;span class="o">}}&lt;/span>
- Build a site, start up a webserver to serve it, and automatically reload when pages are edited:
hugo server
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ol start="3">
&lt;li>Êñ∞Âª∫Á´ôÁÇπ&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">$ hugo new site loomt
Congratulations! Your new Hugo site is created in /home/loomt/temp/loomt.
Just a few more steps and you are ready to go:
1. Download a theme into the same-named folder.
¬†Choose a theme from https://themes.gohugo.io/ or
¬†create your own with the &lt;span class="s2">&amp;#34;hugo new theme &amp;lt;THEMENAME&amp;gt;&amp;#34;&lt;/span> command.
2. Perhaps you want to add some content. You can add single files
¬†with &lt;span class="s2">&amp;#34;hugo new &amp;lt;SECTIONNAME&amp;gt;/&amp;lt;FILENAME&amp;gt;.&amp;lt;FORMAT&amp;gt;&amp;#34;&lt;/span>.
3. Start the built-in live server via &lt;span class="s2">&amp;#34;hugo server&amp;#34;&lt;/span>.
Visit https://gohugo.io/ &lt;span class="k">for&lt;/span> quickstart guide and full documentation.
$ &lt;span class="nb">cd&lt;/span> loomt
$ tree
.
‚îú‚îÄ‚îÄ archetypes
‚îÇ ¬† ‚îî‚îÄ‚îÄ default.md
‚îú‚îÄ‚îÄ config.toml
‚îú‚îÄ‚îÄ content
‚îú‚îÄ‚îÄ data
‚îú‚îÄ‚îÄ layouts
‚îú‚îÄ‚îÄ static
‚îî‚îÄ‚îÄ themes
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ol start="4">
&lt;li>ÈÖçÁΩÆ‰∏ªÈ¢ò&lt;/li>
&lt;/ol>
&lt;pre tabindex="0">&lt;code>$ git init
# Â∞ÜÁöÆËÇ§‰Ωú‰∏∫submoduleÊ∑ªÂä†Ôºå‰ª•‰æøÊõ¥Êñ∞
$ git submodule add https://github.com/reuixiy/hugo-theme-meme.git themes/meme # MeMEÔºåÂæàÂñúÊ¨¢ÁöÑ‰∏Ä‰∏™‰∏ªÈ¢ò
$ git submodule add https://github.com/martignoni/hugo-notice.git themes/hugo-notice # hugo-noticeÔºåÊèí‰ª∂‰∏ªÈ¢òÔºàÂæàËΩªÔºåÂºÄÁÆ±Âç≥Áî®Ôºâ
$ rm config.toml &amp;amp;&amp;amp; cp themes/meme/config-examples/zh-cn/config.toml config.toml #Ë¶ÜÁõñÈÖçÁΩÆÊñá‰ª∂
&lt;/code>&lt;/pre>&lt;ol start="5">
&lt;li>ÂèëÂ∏ÉÊñáÁ´†&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">$ hugo new posts/HelloWorld.md &lt;span class="c1">#‰ºöÂú®centent‰∏ãÈù¢ÂàõÂª∫markdownÊñá‰ª∂ÔºåÂèØ‰ª•Áõ¥Êé•ÂéªÁºñËæë&lt;/span>
Content &lt;span class="s2">&amp;#34;/home/loomt/temp/loomt/content/posts/HelloWorld.md&amp;#34;&lt;/span> created
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ol start="6">
&lt;li>ËøêË°åÊú¨Âú∞ÊúçÂä°&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">$ hugo server -D --verbose &lt;span class="c1"># Âú®Êú¨Âú∞ËøêË°å -DÊòØÊ∏≤ÊüìËçâÁ®ø --verboseÊòæÁ§∫ËØ¶ÁªÜËæìÂá∫&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ÁõÆÂâçÂ∑≤ÁªèÂÆåÊàêÂü∫Êú¨ÈÖçÁΩÆÔºåÂèØ‰ª•ËÆøÈóÆËøêË°åÂú®Êú¨Êú∫ÁöÑÁ´ôÁÇπ‰∫Ü ü•≥&lt;/p>
&lt;p>Êé•‰∏ãÊù•ËøòÂèØ‰ª•Â∞ÜÁΩëÁ´ôÈÉ®ÁΩ≤Âà∞ Github PageÔºåVercel ÊàñËÄÖ Netlify Á≠âÂÖçË¥πÁöÑÈùôÊÄÅËµÑÊ∫êÊâòÁÆ°ÂïÜ„ÄÇ&lt;/p>
&lt;h2 id="hugo-ÈÉ®ÁΩ≤Âà∞-github-page">Hugo ÈÉ®ÁΩ≤Âà∞ Github Page&lt;/h2>
&lt;p>Hugo ÊòØ‰∏Ä‰∏™ÁΩëÁ´ôÊûÑÂª∫Â∑•ÂÖ∑Ôºå&lt;code>hugo&lt;/code>ÂëΩ‰ª§ÁîüÊàêÁöÑ public Êñá‰ª∂Â§πÂ≠òÊîæÁöÑÊòØÈùôÊÄÅÁöÑÈÉ®ÁΩ≤È°µÈù¢ÔºåÊàë‰ª¨Âè™ÈúÄË¶ÅÂ∞ÜÂÖ∂ÊîæÂú® Github Page ‰∏≠Âç≥ÂèØ„ÄÇÂª∫ËÆÆÂºÄ‰∏§‰∏™‰ªìÂ∫ìÔºå‰∏Ä‰∏™‰ªìÂ∫ìÁî®‰∫éÂ≠òÊîæÊ†πÁõÆÂΩïÔºåÂè¶‰∏Ä‰∏™Áî®‰∫éÂ≠òÊîæ./public Êñá‰ª∂Â§πÁöÑÂÜÖÂÆπÔºå‰ª•‰æøË¢´ Github Page ÈÉ®ÁΩ≤„ÄÇ&lt;/p>
&lt;blockquote>
&lt;p>Âõ†‰∏∫Ê†πÁõÆÂΩïÂèØËÉΩÊúâÊïèÊÑü‰ø°ÊÅØÂíåÊöÇÊó∂‰∏çÂ∏åÊúõÂÖ¨ÂºÄÁöÑËçâÁ®øÔºåÂèà‰∏∫‰∫ÜËÆ©ÂÖ∂ÂæóÂà∞ÊúâÊïàÁöÑÁâàÊú¨ÊéßÂà∂ÔºåÂèØ‰ª•ÂºÄ‰∏Ä‰∏™ÁßÅÊúâ‰ªìÂ∫ìÂ≠òÊîæÊ†πÁõÆÂΩïÔºå&lt;/p>
&lt;p>ËÄå publishDir(./pubic) ‰Ωú‰∏∫ËæìÂá∫ÁöÑÈùôÊÄÅÈ°µÈù¢ÔºåÂàôÈÄÇÂêàÊîæÂú®ÂÖ¨ÂºÄÁöÑ‰ªìÂ∫ì &lt;del>ËÄå‰∏î Github Page ‰∏çÂÖ¨ÂºÄÊ≤°Ê≥ïÁôΩÂ´ñ&lt;/del>&lt;/p>
&lt;/blockquote>
&lt;p>ÈªòËÆ§ÁúãÂà∞ËøôÈáåÁöÑÂêåÂ≠¶Â∑≤ÁªèÂª∫Â•Ω‰∫Ü‰ªìÂ∫ìÔºåÂπ∂ÂÆåÊàê‰∫Ü‰ªìÂ∫ìÁöÑÂàùÂßãÂåñÂíåÈÖçÁΩÆ ü§ó&lt;/p>
&lt;p>‰∏ãÈù¢ÂÅáËÆæÊõ¥Êñ∞‰∫ÜÊñáÁ´†ÔºåÈúÄË¶ÅÂêåÊ≠•Âà∞‰∏§‰∏™‰ªìÂ∫ì„ÄÇ&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">$ hugo --gc --cleanDestinationDir &lt;span class="c1"># ÁîüÊàêÈùôÊÄÅÁ´ôÁÇπÂà∞./publicÁöÑÂêåÊó∂ Ê∏ÖÈô§ÁºìÂ≠òÂíåÈùôÊÄÅÁ´ôÁÇπÁî®‰∏çÁùÄÁöÑÊñá‰ª∂&lt;/span>
$ git add .
$ git commit -m &lt;span class="s2">&amp;#34;update source code&amp;#34;&lt;/span>
$ git push
$ &lt;span class="nb">cd&lt;/span> public
$ git add .
$ git commit -m &lt;span class="s2">&amp;#34;update Github Page&amp;#34;&lt;/span>
$ git push
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ÊòØ‰∏çÊòØÊÑüËßâË¶Å push ‰∏§Ê¨°ÈùûÂ∏∏È∫ªÁÉ¶ÔºåÂèØ‰ª•ÂÜô‰∏Ä‰∏™ push.sh Êù•ÁÆÄÂåñÊìç‰ΩúÔºåËøòÂèØ‰ª•Âä†‰∏™ Github ActionsÔºåÁÆÄÂåñÊØèÊ¨°Êõ¥Êñ∞Á´ôÁÇπÁöÑÊ≠•È™§ÔºåÂÖ∑‰ΩìÂèØÈòÖËØª &lt;a href="https://docs.github.com/cn/actions/learn-github-actions/understanding-github-actions">GitHub Actions ÂÆòÊñπÊñáÊ°£&lt;/a>Ôºå&lt;a href="https://github.com/peaceiris/actions-gh-pages">actions-gh-pages&lt;/a> ‰ª•Âèä &lt;a href="https://io-oi.me/tech/deploy-hugo-to-github-pages-via-github-actions/">reuixiy ÁöÑÂçöÂÆ¢&lt;/a> „ÄÇ&lt;/p>
&lt;h3 id="Ëá™Âä®ÂåñÈÉ®ÁΩ≤">Ëá™Âä®ÂåñÈÉ®ÁΩ≤&lt;/h3>
&lt;ul>
&lt;li>
&lt;p>Â¶ÇÊûúÊ∫êÁ†Å‰ªìÂ∫ìÂíå Github Page ‰ªìÂ∫ìÈÉΩÊòØÂÖ¨ÊúâÁöÑËØùÂèØ‰ª•ÈòÖËØª &lt;a href="https://github.com/peaceiris/actions-gh-pages">actions-gh-pages&lt;/a> ËøõË°åÁÆÄÂçïÁöÑÈÖçÁΩÆ„ÄÇ&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Â¶ÇÊûúÊ∫êÁ†Å‰ªìÂ∫ìÊòØÁßÅÊúâÁöÑÔºåGithub Page ‰ªìÂ∫ìÊòØÂÖ¨ÂºÄÁöÑËØùÔºåÂèØ‰ª•ÂèÇËÄÉ‰ª•‰∏ãÈÖçÁΩÆÊñπÊ°à„ÄÇ&lt;/p>
&lt;/li>
&lt;/ul>
&lt;ol>
&lt;li>ÈÖçÁΩÆÂÖ¨Èí•ÂíåÁßÅÈí•Âà∞‰ªìÂ∫ì&lt;/li>
&lt;/ol>
&lt;p>ÈúÄË¶ÅÁîüÊàê SSH key pair ‰ª•Ëé∑ÂèñÊ∫êÁ†Å‰ªìÂ∫ìÂØπ Github Page ‰ªìÂ∫ì‰øÆÊîπÁöÑÊùÉÈôê„ÄÇ&lt;/p>
&lt;pre tabindex="0">&lt;code>$ mkdir -p ~/.ssh/blog
$ cd ~/.ssh/blog
$ ssh-keygen -t rsa -b 4096 -C &amp;quot;yourname@users.noreply.github.com&amp;quot;
# Ê≥®ÊÑèÔºö‰∏çË¶ÅÊó†ËÑëÂõûËΩ¶ÔºåÊúÄÂ•ΩÂºÄ‰∏Ä‰∏™Êñá‰ª∂Â§πÂ≠òÂÖ¨Èí•ÁßÅÈí•Ôºå‰∏çÁÑ∂‰ºöË¶ÜÁõñÊéâ‰ª•ÂâçÁöÑ
&lt;/code>&lt;/pre>&lt;ul>
&lt;li>id_rsaÔºàÁßÅÈí•Ôºâ&lt;/li>
&lt;/ul>
&lt;p>ÂâçÂæÄ Github Page ‰ªìÂ∫ìÔºåSettings &amp;gt; Deploy Keys &amp;gt; Add deploy key„ÄÇ&lt;/p>
&lt;p>ÈúÄË¶ÅÂãæÈÄâ Allow write access„ÄÇ&lt;/p>
&lt;ul>
&lt;li>id_rsa.pubÔºàÂÖ¨Èí•Ôºâ&lt;/li>
&lt;/ul>
&lt;p>ÂâçÂæÄÊ∫êÁ†Å‰ªìÂ∫ìÔºåSettings &amp;gt; Secrets &amp;gt; Actions &amp;gt; New repository secret„ÄÇ&lt;/p>
&lt;p>Name ÈúÄË¶ÅËÆæ‰∏∫ ACTIONS_DEPLOY_KEY&lt;/p>
&lt;ol start="2">
&lt;li>Êñ∞Âª∫ Workflow ÈÖçÁΩÆÊñá‰ª∂&lt;/li>
&lt;/ol>
&lt;p>‰∏ãÈù¢Á≤ò‰∏Ä‰∏ãÊàëÁöÑÈÖçÁΩÆÊñπÊ°à&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;span class="lnt">44
&lt;/span>&lt;span class="lnt">45
&lt;/span>&lt;span class="lnt">46
&lt;/span>&lt;span class="lnt">47
&lt;/span>&lt;span class="lnt">48
&lt;/span>&lt;span class="lnt">49
&lt;/span>&lt;span class="lnt">50
&lt;/span>&lt;span class="lnt">51
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yml" data-lang="yml">&lt;span class="c"># .github/workflows/build.yml&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">&lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Hugo automated deployment&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">&lt;/span>&lt;span class="nt">on&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">&lt;/span>&lt;span class="nt">push&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">¬† &lt;/span>&lt;span class="nt">branches&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">¬† ¬† &lt;/span>- &lt;span class="l">main ¬†# Set a branch name to trigger deployment&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">&lt;/span>&lt;span class="nt">jobs&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">&lt;/span>&lt;span class="nt">deploy&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">¬† &lt;/span>&lt;span class="nt">runs-on&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">ubuntu-latest&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">¬† &lt;/span>&lt;span class="nt">permissions&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">¬† ¬† &lt;/span>&lt;span class="nt">contents&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">write&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">¬† &lt;/span>&lt;span class="nt">concurrency&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">¬† ¬† &lt;/span>&lt;span class="nt">group&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">${{ github.workflow }}-${{ github.ref }}&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">¬† &lt;/span>&lt;span class="nt">steps&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">¬† ¬† &lt;/span>- &lt;span class="nt">uses&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">actions/checkout@v3&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">¬† ¬† ¬† &lt;/span>&lt;span class="nt">with&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">¬† ¬† ¬† ¬† &lt;/span>&lt;span class="nt">submodules&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kc">true&lt;/span>&lt;span class="w"> ¬†&lt;/span>&lt;span class="c"># Fetch Hugo themes (true OR recursive)&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">¬† ¬† ¬† ¬† &lt;/span>&lt;span class="nt">fetch-depth&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">0&lt;/span>&lt;span class="w"> ¬† ¬†&lt;/span>&lt;span class="c"># Fetch all history for .GitInfo and .Lastmod&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">¬† ¬† &lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Setup Hugo&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">¬† ¬† ¬† &lt;/span>&lt;span class="nt">uses&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">peaceiris/actions-hugo@v2&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">¬† ¬† ¬† &lt;/span>&lt;span class="nt">with&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">¬† ¬† ¬† ¬† &lt;/span>&lt;span class="nt">hugo-version&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s1">&amp;#39;0.92.2&amp;#39;&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">¬† ¬† ¬† ¬† &lt;/span>&lt;span class="nt">extended&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kc">true&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">¬† ¬† &lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Build&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">¬† ¬† ¬† &lt;/span>&lt;span class="nt">run&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">hugo --gc --minify&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">¬† ¬† &lt;/span>&lt;span class="c"># - name: Deploy&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">¬† ¬† &lt;/span>&lt;span class="c"># ¬† uses: peaceiris/actions-gh-pages@v3&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">¬† ¬† &lt;/span>&lt;span class="c"># ¬† # If you&amp;#39;re changing the branch from main,&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">¬† ¬† &lt;/span>&lt;span class="c"># ¬† # also change the `main` in `refs/heads/main`&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">¬† ¬† &lt;/span>&lt;span class="c"># ¬† # below accordingly.&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">¬† ¬† &lt;/span>&lt;span class="c"># ¬† if: ${{ github.ref == &amp;#39;refs/heads/main&amp;#39; }}&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">¬† ¬† &lt;/span>&lt;span class="c"># ¬† with:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">¬† ¬† &lt;/span>&lt;span class="c"># ¬† ¬† github_token: ${{ secrets.GITHUB_TOKEN }}&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">¬† ¬† &lt;/span>&lt;span class="c"># ¬† ¬† publish_dir: ./public&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">¬† ¬† &lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Deploy ¬†# Ê≠§Â§ÑÈúÄË¶ÅÊåâÁÖßËá™Â∑±ÂÆûÈôÖ‰øÆÊîπ&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">¬† ¬† ¬† &lt;/span>&lt;span class="nt">uses&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">peaceiris/actions-gh-pages@v3&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">¬† ¬† ¬† &lt;/span>&lt;span class="nt">with&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">¬† ¬† ¬† ¬† &lt;/span>&lt;span class="nt">deploy_key&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">${{ secrets.ACTIONS_DEPLOY_KEY }}&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">¬† ¬† ¬† ¬† &lt;/span>&lt;span class="nt">external_repository&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">loomts/loomts.github.io&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">¬† ¬† ¬† ¬† &lt;/span>&lt;span class="nt">publish_branch: main ¬†# default&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">gh-pages&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">¬† ¬† ¬† ¬† &lt;/span>&lt;span class="nt">publish_dir&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">./public&lt;/span>&lt;span class="w">
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ol start="3">
&lt;li>Êé®ÈÄÅÂà∞ Github&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">$ git add .
$ git commit -m &lt;span class="s2">&amp;#34;setup auto deploy&amp;#34;&lt;/span>
$ git push
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ÊâìÂºÄ‰Ω†ÁöÑÊ∫êÁ†Å‰ªìÂ∫ìÈ°µÈù¢ÔºåÁÇπÂáª Actions Êü•ÁúãÊó•ÂøóÔºåÈ°∫Âà©ÁöÑËØùÂ∑≤ÁªèÊêûÂÆö‰∫ÜÔºå‰ª•ÂêéÊØèÊ¨° &lt;code>git push&lt;/code> Github Workflow ÈÉΩ‰ºöËá™Âä®Â∏Æ‰Ω†Êõ¥Êñ∞ÁΩëÁ´ô‰∫Ü„ÄÇ&lt;/p>
&lt;h2 id="github-page-ÁªëÂÆöËá™ÂÆö‰πâÂüüÂêç">Github Page ÁªëÂÆöËá™ÂÆö‰πâÂüüÂêç&lt;/h2>
&lt;p>ÂÅáËÆæÂ∑≤ÁªèÊúâ‰∫ÜÂüüÂêçÔºåËøòÈúÄË¶ÅÂú®ÂüüÂêçÁöÑ DNS ÊúçÂä°ÂïÜÈÇ£ÈáåÂä†‰∏Ä‰∏™ CNAMEÔºàÁî®‰∫é dns Ë∑≥ËΩ¨Ôºâ„ÄÇ&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>name&lt;/th>
&lt;th>type&lt;/th>
&lt;th>value&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>www&lt;/td>
&lt;td>CNAME&lt;/td>
&lt;td>loomts.github.io&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>‰∏ÄÊÆµÊó∂Èó¥ÂêéÔºåÂõûÂà∞ Github Page ‰ªìÂ∫ìÔºåÂú® Settings &amp;gt; Pages &amp;gt; Custom domain Â§ÑÂ°´‰∏äËá™Â∑±ÁöÑÂüüÂêçÔºåÁ≠âÂæÖÂá†Â∞èÊó∂ÁîüÊàêËØÅ‰π¶ÔºåÁÑ∂ÂêéÂãæÈÄâ ¬†&lt;code>Enforce HTTPS&lt;/code>„ÄÇ&lt;/p>
&lt;p>ËøòË¶ÅËÆ∞ÂæóÊ∑ªÂä† &lt;code>your domain&lt;/code>Âà∞ static/CNAMEÔºå‰ª•ÁîüÊàêÂà∞ÈùôÊÄÅÊñá‰ª∂„ÄÇ„ÄÇ&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">$ &lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;your domain&amp;#34;&lt;/span> &amp;gt; static/CNAME
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;blockquote>
&lt;p>Custom domains are stored in a¬†&lt;em>CNAME&lt;/em>¬†file in the root of your publishing source. You can add or update this file through your repository settings or manually. For more information, see &amp;quot; &lt;a href="https://docs.github.com/en/articles/managing-a-custom-domain-for-your-github-pages-site">Managing a custom domain for your GitHub Pages site&lt;/a> .&amp;quot; ‚Äî‚ÄîGithub Docs&lt;/p>
&lt;/blockquote>
&lt;h2 id="hugo-ÈÉ®ÁΩ≤Âà∞-vercel">Hugo ÈÉ®ÁΩ≤Âà∞ Vercel&lt;/h2>
&lt;p>&lt;a href="https://vercel.com">Vercel&lt;/a> ÂèØ‰ª•Áúã‰ΩúÊòØÁªìÂêà‰∫Ü Github Page ËøòÊúâ Github Actions ÁöÑÁî®‰∫éÂâçÁ´ØÊ°ÜÊû∂ÂíåÈùôÊÄÅÁ´ôÁÇπÁÆ°ÁöÑÂπ≥Âè∞ÔºåÁõ¥Êé•ÂØºÂÖ• Github ‰ªìÂ∫ìÂç≥ÂèØÈÉ®ÁΩ≤ÔºåÊÑüËßâÈÖçÁΩÆËµ∑Êù•ÊØî Github Action Êó†ËÑëÂæàÂ§öÔºåÂæàÈÄÇÂêàÊàëÔºåÊâÄ‰ª•ÊàëÂ∑≤ÁªèÊîæÂºÉ Github ActionÔºåÂÖ®Èù¢ËΩ¨‰∏∫ Vercel ‰∫Ü„ÄÇÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÊ≥®ÂÜåÂüüÂêçÁöÑÊó∂ÂÄôË¶ÅÂéªÂüüÂêçÊ≥®ÂÜåÂïÜÊîπ‰∏Ä‰∏ã DNS ÊúçÂä°Âô®ÔºåÊàñËÄÖÊØè‰∏™Á´ôÁÇπÈÉΩÊ∑ªÂä†‰∏ÄÊ¨° A ËÆ∞ÂΩï„ÄÇ&lt;/p>
&lt;h2 id="hugo-‰∏™ÊÄßÂåñÈÖçÁΩÆ">Hugo ‰∏™ÊÄßÂåñÈÖçÁΩÆ&lt;/h2>
&lt;h3 id="ÁöÆËÇ§ÈÖçÁΩÆ">ÁöÆËÇ§ÈÖçÁΩÆ&lt;/h3>
&lt;p>ÂèØ‰ª•Ê†πÊçÆÁöÆËÇ§‰ΩúËÄÖÁöÑÊñáÊ°£ÊîπÂèòÁöÆËÇ§ÁöÑÂêÑÁßç featureÔºåÂ¶Ç MeME ÁöÑ config.toml &lt;a href="https://github.com/reuixiy/hugo-theme-meme/blob/master/config-examples/zh-cn/config.toml">example&lt;/a>&lt;/p>
&lt;style type="text/css">.notice{--root-color:#444;--root-background:#eff;--title-color:#fff;--title-background:#7bd;--warning-title:#c33;--warning-content:#fee;--info-title:#fb7;--info-content:#fec;--note-title:#6be;--note-content:#e7f2fa;--tip-title:#5a5;--tip-content:#efe}@media (prefers-color-scheme:dark){.notice{--root-color:#ddd;--root-background:#eff;--title-color:#fff;--title-background:#7bd;--warning-title:#800;--warning-content:#400;--info-title:#a50;--info-content:#420;--note-title:#069;--note-content:#023;--tip-title:#363;--tip-content:#121}}body.dark .notice{--root-color:#ddd;--root-background:#eff;--title-color:#fff;--title-background:#7bd;--warning-title:#800;--warning-content:#400;--info-title:#a50;--info-content:#420;--note-title:#069;--note-content:#023;--tip-title:#363;--tip-content:#121}.notice{padding:18px;line-height:24px;margin-bottom:24px;border-radius:4px;color:var(--root-color);background:var(--root-background)}.notice p:last-child{margin-bottom:0}.notice-title{margin:-18px -18px 12px;padding:4px 18px;border-radius:4px 4px 0 0;font-weight:700;color:var(--title-color);background:var(--title-background)}.notice.warning .notice-title{background:var(--warning-title)}.notice.warning{background:var(--warning-content)}.notice.info .notice-title{background:var(--info-title)}.notice.info{background:var(--info-content)}.notice.note .notice-title{background:var(--note-title)}.notice.note{background:var(--note-content)}.notice.tip .notice-title{background:var(--tip-title)}.notice.tip{background:var(--tip-content)}.icon-notice{display:inline-flex;align-self:center;margin-right:8px}.icon-notice img,.icon-notice svg{height:1em;width:1em;fill:currentColor}.icon-notice img,.icon-notice.baseline svg{top:.125em;position:relative}&lt;/style>
&lt;div>&lt;svg width="0" height="0" display="none" xmlns="http://www.w3.org/2000/svg">&lt;symbol id="tip-notice" viewBox="0 0 512 512" preserveAspectRatio="xMidYMid meet">&lt;path d="M504 256c0 136.967-111.033 248-248 248S8 392.967 8 256 119.033 8 256 8s248 111.033 248 248zM227.314 387.314l184-184c6.248-6.248 6.248-16.379 0-22.627l-22.627-22.627c-6.248-6.249-16.379-6.249-22.628 0L216 308.118l-70.059-70.059c-6.248-6.248-16.379-6.248-22.628 0l-22.627 22.627c-6.248 6.248-6.248 16.379 0 22.627l104 104c6.249 6.249 16.379 6.249 22.628.001z"/>&lt;/symbol>&lt;symbol id="note-notice" viewBox="0 0 512 512" preserveAspectRatio="xMidYMid meet">&lt;path d="M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"/>&lt;/symbol>&lt;symbol id="warning-notice" viewBox="0 0 576 512" preserveAspectRatio="xMidYMid meet">&lt;path d="M569.517 440.013C587.975 472.007 564.806 512 527.94 512H48.054c-36.937 0-59.999-40.055-41.577-71.987L246.423 23.985c18.467-32.009 64.72-31.951 83.154 0l239.94 416.028zM288 354c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"/>&lt;/symbol>&lt;symbol id="info-notice" viewBox="0 0 512 512" preserveAspectRatio="xMidYMid meet">&lt;path d="M256 8C119.043 8 8 119.083 8 256c0 136.997 111.043 248 248 248s248-111.003 248-248C504 119.083 392.957 8 256 8zm0 110c23.196 0 42 18.804 42 42s-18.804 42-42 42-42-18.804-42-42 18.804-42 42-42zm56 254c0 6.627-5.373 12-12 12h-88c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h12v-64h-12c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h64c6.627 0 12 5.373 12 12v100h12c6.627 0 12 5.373 12 12v24z"/>&lt;/symbol>&lt;/svg>&lt;/div>&lt;div class="notice tip" >
&lt;p class="first notice-title">&lt;span class="icon-notice baseline">&lt;svg>&lt;use href="https://loomt.top/posts/%E5%BB%BA%E7%AB%99/#tip-notice">&lt;/use>&lt;/svg>&lt;/span>ÊèêÁ§∫&lt;/p>&lt;p>config.toml ÁöÑ baseURL Ë¶ÅÂä† &lt;code>https://&lt;/code> ÔºåÂê¶ÂàôÁîüÊàêÁöÑÈùôÊÄÅÈ°µÈù¢ css Âíå js Âä†ËΩΩ‰ºöÂá∫ÈóÆÈ¢ò„ÄÇ&lt;/p>&lt;/div>
&lt;h3 id="Ëá™ÂÆö‰πâ-css-Âíå-js">Ëá™ÂÆö‰πâ CSS Âíå JS&lt;/h3>
&lt;ol>
&lt;li>Âà©Áî® hugo ÁöÑ&lt;a href="https://gohugo.io/templates/lookup-order/#hugo-layouts-lookup-rules-with-theme">ÊõøÊç¢ËßÑÂàô&lt;/a>&lt;/li>
&lt;/ol>
&lt;p>ÂΩì‰Ω†ÈúÄË¶ÅÊõ¥ÊîπÊüê‰∏™È°µÈù¢ÁöÑÁîüÊàêËßÑÂàôÔºàÂåÖÊã¨ CSS Âíå JSÔºâÔºå‰Ω†ÂèØ‰ª•Â∞Ü themes/your-theme ÈáåÈù¢ÁöÑ‰∏úË•øÂ§çÂà∂‰∏Ä‰ªΩÂà∞‰Ω†ÁöÑÊ†πÁõÆÂΩïÔºåÁÑ∂ÂêéÁàΩÊîπÈÄªËæëÔºåhugo ÁîüÊàêÈùôÊÄÅÈ°µÈù¢Êó∂Âú®ÂêåÁ≠âÊÉÖÂÜµ‰∏ã‰ºö‰ºòÂÖàÁî®‰Ω†Ê†πÁõÆÂΩï‰∏ãÁöÑÊñá‰ª∂„ÄÇ&lt;/p>
&lt;ol start="2">
&lt;li>Â¶ÇÊûú‰Ω†ÊÉ≥Ë¶ÅËá™Â∑±Êñ∞Âª∫‰∏Ä‰∏™ js ÊàñËÄÖ css Êñá‰ª∂ÔºåÂèØ‰ª•Áúã&lt;a href="https://gohugo.io/hugo-pipes">hugo-pipes&lt;/a>Ôºå‰ΩÜÂ¶ÇÊûú‰Ω†‰∏çÊâìÁÆóÂÅö‰∏Ä‰∏™ÂºÄÊ∫ê‰∏ªÈ¢òÔºåÊó†ËÑëÂú® html Êñá‰ª∂ÈáåÈù¢Â†Ü style Âíå script ÊòØËÉΩË∑ëÁöÑÈÄâÊã©ÔºÅ&lt;/li>
&lt;/ol>
&lt;p>ÊØîÂ¶ÇÔºåÊàëÊúâËøôÊ†∑‰∏Ä‰∏™ÈúÄÊ±ÇÔºöÂú® Wiki È°µÈù¢ÂàÜÂ±ÇÊ¨°ÊòæÁ§∫ÊàëÁöÑÁ¨îËÆ∞Ôºå‰ΩÜÂèà‰∏çËÆ©Á¨îËÆ∞ÂÜÖÂÆπÂú®‰∏ªÈ°µÈù¢ÊòæÁ§∫ÔºåÂπ∂‰∏î Wiki È°µÈúÄË¶ÅÊåâÁÖßÊñá‰ª∂Â§πÁöÑÂÜÖÈÉ®ÁªìÊûÑÂ±ïÁ§∫ÔºåÈÇ£Â∞±Áî®&lt;a href="https://gohugo.io/content-management/taxonomies/#default-taxonomies">categories&lt;/a>ÁöÑÊñπÂºèÁªÑÁªá content/wiki ÁöÑÂÜÖÂÆπÔºå‰ªÖÈúÄË¶ÅÊîπ‰∏Ä‰∏ã MeME ‰∏ªÈ¢ò tree-sections ÁöÑÂÜÖÂÆπÔºåÂπ∂ÈÖçÁΩÆ‰∏Ä‰∏ã config.toml Âç≥ÂèØ„ÄÇ&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;span class="lnt">44
&lt;/span>&lt;span class="lnt">45
&lt;/span>&lt;span class="lnt">46
&lt;/span>&lt;span class="lnt">47
&lt;/span>&lt;span class="lnt">48
&lt;/span>&lt;span class="lnt">49
&lt;/span>&lt;span class="lnt">50
&lt;/span>&lt;span class="lnt">51
&lt;/span>&lt;span class="lnt">52
&lt;/span>&lt;span class="lnt">53
&lt;/span>&lt;span class="lnt">54
&lt;/span>&lt;span class="lnt">55
&lt;/span>&lt;span class="lnt">56
&lt;/span>&lt;span class="lnt">57
&lt;/span>&lt;span class="lnt">58
&lt;/span>&lt;span class="lnt">59
&lt;/span>&lt;span class="lnt">60
&lt;/span>&lt;span class="lnt">61
&lt;/span>&lt;span class="lnt">62
&lt;/span>&lt;span class="lnt">63
&lt;/span>&lt;span class="lnt">64
&lt;/span>&lt;span class="lnt">65
&lt;/span>&lt;span class="lnt">66
&lt;/span>&lt;span class="lnt">67
&lt;/span>&lt;span class="lnt">68
&lt;/span>&lt;span class="lnt">69
&lt;/span>&lt;span class="lnt">70
&lt;/span>&lt;span class="lnt">71
&lt;/span>&lt;span class="lnt">72
&lt;/span>&lt;span class="lnt">73
&lt;/span>&lt;span class="lnt">74
&lt;/span>&lt;span class="lnt">75
&lt;/span>&lt;span class="lnt">76
&lt;/span>&lt;span class="lnt">77
&lt;/span>&lt;span class="lnt">78
&lt;/span>&lt;span class="lnt">79
&lt;/span>&lt;span class="lnt">80
&lt;/span>&lt;span class="lnt">81
&lt;/span>&lt;span class="lnt">82
&lt;/span>&lt;span class="lnt">83
&lt;/span>&lt;span class="lnt">84
&lt;/span>&lt;span class="lnt">85
&lt;/span>&lt;span class="lnt">86
&lt;/span>&lt;span class="lnt">87
&lt;/span>&lt;span class="lnt">88
&lt;/span>&lt;span class="lnt">89
&lt;/span>&lt;span class="lnt">90
&lt;/span>&lt;span class="lnt">91
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-html" data-lang="html">&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">main&lt;/span> &lt;span class="na">class&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;main list&amp;#34;&lt;/span> &lt;span class="na">id&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;main&amp;#34;&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">div&lt;/span> &lt;span class="na">class&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;main-inner&amp;#34;&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">div&lt;/span> &lt;span class="na">class&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;content categories&amp;#34;&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
{{ if .Site.Params.displayListTitle }}
&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">h1&lt;/span> &lt;span class="na">class&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;list-title&amp;#34;&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
{{ &amp;#34;Wiki&amp;#34;}}
&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">h1&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">div&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
Â≠òÁÇπÁ¨îËÆ∞Ôºå‰ªÖ‰ΩúÂèÇËÄÉüò∂‚Äçüå´Ô∏è
&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">div&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
{{ end }}
&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">div&lt;/span> &lt;span class="na">class&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;tree&amp;#34;&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">ul&lt;/span> &lt;span class="na">class&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;list-categories&amp;#34;&lt;/span> &lt;span class="na">style&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;display: block;&amp;#34;&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
{{ partial &amp;#34;utils/tree-sections.html&amp;#34; . }}
{{ $sections := .Scratch.Get &amp;#34;sections&amp;#34; }}
{{ $pages := .Scratch.Get &amp;#34;pages&amp;#34; }}
{{ range $index, $page := $pages }}
{{ $depth := (len (split (strings.TrimPrefix &amp;#34;/&amp;#34; $page) &amp;#34;/&amp;#34;)) }}
{{ with $.Site.GetPage $page }}
{{ $linkTarget := .}}
{{ $depthPrev := 0 }}
{{ if ge $index 1 }}
{{ $pagePrev := index $pages (sub $index 1) }}
{{ $depthPrev = len (split (strings.TrimPrefix &amp;#34;/&amp;#34; $pagePrev) &amp;#34;/&amp;#34;) }}
{{ end }}
{{ $depthNext := 0 }}
{{ if lt $index (sub (len $pages) 1) }}
{{ $pageNext := index $pages (add $index 1) }}
{{ $depthNext = len (split (strings.TrimPrefix &amp;#34;/&amp;#34; $pageNext) &amp;#34;/&amp;#34;) }}
{{ end }}
{{ if or (le $depth $depthPrev) (eq $index 0) }}
&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">li&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
{{ end }}
{{ if and (gt $depth $depthPrev) (ne $index 0) }}
&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">ul&lt;/span> &lt;span class="na">class&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;list-categories&amp;#34;&lt;/span> &lt;span class="na">style&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;display: block;&amp;#34;&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">li&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
{{ end }} {{ $name := index $sections $index }}
&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">div&lt;/span> &lt;span class="na">class&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;category-item&amp;#34;&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
{{ .LinkTitle | default $name}}
{{ if $.Site.Params.displayPostsCount }}
{{ $sectionPage := .CurrentSection }}
{{$.Scratch.Delete &amp;#34;pages&amp;#34; }}
{{ range $.Site.RegularPages }}
{{ if (.IsDescendant $sectionPage)}}
{{ $.Scratch.Add &amp;#34;pages&amp;#34; (slice .) }}
{{ end}} {{ end }}
{{ $pages := $.Scratch.Get &amp;#34;pages&amp;#34;}}
&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">span&lt;/span> &lt;span class="na">class&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;category-count&amp;#34;&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
{{printf &amp;#34;(%d)&amp;#34; (len $pages)}}
&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">span&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
{{ end }}
&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">div&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
{{ if $.Site.Params.displayPosts }}
{{ $sectionPage := .CurrentSection }}
{{ $.Scratch.Delete &amp;#34;pages&amp;#34;}}
{{ range $.Site.RegularPages }}
{{ if (.InSection $sectionPage)}}
{{ $.Scratch.Add &amp;#34;pages&amp;#34; (slice .) }}
{{ end }} {{ end }}
{{ $pages := $.Scratch.Get &amp;#34;pages&amp;#34; }}
{{ partial &amp;#34;utils/limit-tree-posts.html&amp;#34; (dict &amp;#34;$&amp;#34; $ &amp;#34;pages&amp;#34; $pages
&amp;#34;linkTarget&amp;#34; $linkTarget) }}
{{ end }}
{{ if and (gt $depth $depthNext) (ne $index (sub (len $pages) 1)) }}
{{ range seq (sub $depth $depthNext) }}
{{ if le . (sub $depth $depthNext) }}
&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">li&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">ul&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
{{ end }} {{ end }} {{ end }} {{ if ge $depth $depthNext
}}
&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">li&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
{{ end }} {{ end }} {{ end }}
&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">ul&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">div&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">div&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">div&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">main&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">script&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;span class="kd">let&lt;/span> &lt;span class="nx">lis&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nb">document&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">querySelectorAll&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;ul.list-categories &amp;gt; li&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;span class="nx">lis&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">forEach&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">li&lt;/span> &lt;span class="p">=&amp;gt;&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">li&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">querySelector&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;.category-item&amp;#34;&lt;/span>&lt;span class="p">).&lt;/span>&lt;span class="nx">addEventListener&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;click&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">event&lt;/span> &lt;span class="p">=&amp;gt;&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">event&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">stopPropagation&lt;/span>&lt;span class="p">();&lt;/span> &lt;span class="c1">// ÈòªÊ≠¢‰∫ã‰ª∂ÂÜíÊ≥°
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="kd">let&lt;/span> &lt;span class="nx">sonul&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nx">li&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">querySelector&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;ul&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;span class="nx">sonul&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">style&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">display&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nx">sonul&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">style&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">display&lt;/span> &lt;span class="o">===&lt;/span> &lt;span class="s2">&amp;#34;block&amp;#34;&lt;/span> &lt;span class="o">?&lt;/span> &lt;span class="s2">&amp;#34;none&amp;#34;&lt;/span> &lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;block&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">sonul&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">nextElementSibling&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">sonul&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">nextElementSibling&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">style&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">display&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nx">sonul&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">nextElementSibling&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">style&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">display&lt;/span> &lt;span class="o">===&lt;/span> &lt;span class="s2">&amp;#34;block&amp;#34;&lt;/span> &lt;span class="o">?&lt;/span> &lt;span class="s2">&amp;#34;none&amp;#34;&lt;/span> &lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;block&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="p">});&lt;/span>
&lt;span class="p">})&lt;/span>
&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">script&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-toml" data-lang="toml">
&lt;span class="p">[&lt;/span>&lt;span class="nx">menu&lt;/span>&lt;span class="p">]&lt;/span>
&lt;span class="c">## ËèúÂçïÊ†è&lt;/span>
&lt;span class="p">[[&lt;/span>&lt;span class="nx">menu&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">main&lt;/span>&lt;span class="p">]]&lt;/span>
&lt;span class="nx">pageref&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;/posts/&amp;#34;&lt;/span>
&lt;span class="nx">name&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;Posts&amp;#34;&lt;/span>
&lt;span class="nx">weight&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mi">2&lt;/span>
&lt;span class="nx">pre&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;internal&amp;#34;&lt;/span>
&lt;span class="nx">post&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;archive&amp;#34;&lt;/span>
&lt;span class="p">[[&lt;/span>&lt;span class="nx">menu&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">main&lt;/span>&lt;span class="p">]]&lt;/span>
&lt;span class="nx">pageref&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;/tags/&amp;#34;&lt;/span>
&lt;span class="nx">name&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;Tags&amp;#34;&lt;/span>
&lt;span class="nx">weight&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mi">4&lt;/span>
&lt;span class="nx">pre&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;internal&amp;#34;&lt;/span>
&lt;span class="nx">post&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;tags&amp;#34;&lt;/span>
&lt;span class="p">[[&lt;/span>&lt;span class="nx">menu&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">main&lt;/span>&lt;span class="p">]]&lt;/span>
&lt;span class="nx">pageref&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;/about/&amp;#34;&lt;/span>
&lt;span class="nx">name&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;About&amp;#34;&lt;/span>
&lt;span class="nx">weight&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mi">5&lt;/span>
&lt;span class="nx">pre&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;internal&amp;#34;&lt;/span>
&lt;span class="nx">post&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;user-circle&amp;#34;&lt;/span>
&lt;span class="p">[[&lt;/span>&lt;span class="nx">menu&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">main&lt;/span>&lt;span class="p">]]&lt;/span> &lt;span class="c"># add wiki page&lt;/span>
&lt;span class="nx">pageref&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;/wiki/&amp;#34;&lt;/span>
&lt;span class="nx">name&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;Wiki&amp;#34;&lt;/span>
&lt;span class="nx">weight&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mi">6&lt;/span>
&lt;span class="nx">pre&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;internal&amp;#34;&lt;/span>
&lt;span class="nx">post&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;wiki&amp;#34;&lt;/span>
&lt;span class="p">[[&lt;/span>&lt;span class="nx">menu&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">main&lt;/span>&lt;span class="p">]]&lt;/span>
&lt;span class="nx">weight&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mi">7&lt;/span>
&lt;span class="nx">identifier&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;theme-switcher&amp;#34;&lt;/span>
&lt;span class="p">[[&lt;/span>&lt;span class="nx">menu&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">main&lt;/span>&lt;span class="p">]]&lt;/span>
&lt;span class="nx">weight&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mi">8&lt;/span>
&lt;span class="nx">identifier&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;lang-switcher&amp;#34;&lt;/span>
&lt;span class="p">[[&lt;/span>&lt;span class="nx">menu&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">main&lt;/span>&lt;span class="p">]]&lt;/span>
&lt;span class="nx">weight&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mi">9&lt;/span>
&lt;span class="nx">identifier&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;search&amp;#34;&lt;/span>
&lt;span class="nx">post&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;search&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="hugo--algolia-search">Hugo + Algolia search&lt;/h3>
&lt;p>Algolia ÂèØ‰ª•Êèê‰æõ AI ÊêúÁ¥¢ÊúçÂä°Ôºå‰ΩÜÈúÄË¶ÅÂú®Êõ¥Êñ∞Á´ôÁÇπÊó∂Áî® POST ËØ∑Ê±Ç‰∏ä‰º† algolia.json(Á´ôÁÇπ‰ø°ÊÅØ) Áªô AlgoliaÔºå‰ª•Â∏ÆÂä© Algolia ÂÆûÁé∞ÊêúÁ¥¢ÊúçÂä°„ÄÇÊåâÁÖßË¶ÅÊ±ÇÊñ∞Âª∫Á´ôÁÇπ‰ª•ÂèäÈÖçÁΩÆ api Âç≥ÂèØÔºå‰∏ä‰º† algolia.json ÂèØ‰ª•‰ΩøÁî®&lt;a href="https://github.com/replicatedhq/hugo-algolia">hugo-algolia&lt;/a>„ÄÇÂõ†‰∏∫ MeME ‰∏ªÈ¢òÊúâ‰∏ÄÂÆöÁöÑ algolia search ÊîØÊåÅÔºå‰∏ãÈù¢‰ªÖÁªôÂá∫‰∏ä‰º† algolia.json ÊñπÈù¢ÁöÑÈÖçÁΩÆ„ÄÇ&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">$ npm install hugo-algolia
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>‰ΩÜ hugo-algolia ÁöÑ toml Ëß£ÊûêÂú®ÊàëËøôÈáåÂ•ΩÂÉèÊúâÁÇπÈóÆÈ¢òÔºåÂèØËÉΩÊòØ config.toml ÁöÑÈÖçÁΩÆÂ∑≤ÁªèÂ§™‰π±‰∫ÜÔºåÊó†Ê≥ï‰ºòÈõÖÂú∞Ëß£ÂÜ≥&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">$ hugo-algolia -s -t --config config.toml
JSON index file was created in public/algolia.json
/usr/local/lib/node_modules/hugo-algolia/node_modules/algoliasearch/src/AlgoliaSearchCore.js:50
throw new errors.AlgoliaSearchError&lt;span class="o">(&lt;/span>&lt;span class="s1">&amp;#39;Please provide an application ID. &amp;#39;&lt;/span> + usage&lt;span class="o">)&lt;/span>&lt;span class="p">;&lt;/span>
^
AlgoliaSearchError: Please provide an application ID. Usage: algoliasearch&lt;span class="o">(&lt;/span>applicationID, apiKey, opts&lt;span class="o">)&lt;/span>
at AlgoliaSearchNodeJS.AlgoliaSearchCore &lt;span class="o">(&lt;/span>/usr/local/lib/node_modules/hugo-algolia/node_modules/algoliasearch/src/AlgoliaSearchCore.js:50:11&lt;span class="o">)&lt;/span>
at AlgoliaSearchNodeJS.AlgoliaSearch &lt;span class="o">(&lt;/span>/usr/local/lib/node_modules/hugo-algolia/node_modules/algoliasearch/src/AlgoliaSearch.js:11:21&lt;span class="o">)&lt;/span>
at AlgoliaSearchNodeJS.AlgoliaSearchServer &lt;span class="o">(&lt;/span>/usr/local/lib/node_modules/hugo-algolia/node_modules/algoliasearch/src/server/builds/AlgoliaSearchServer.js:17:17&lt;span class="o">)&lt;/span>
at new AlgoliaSearchNodeJS &lt;span class="o">(&lt;/span>/usr/local/lib/node_modules/hugo-algolia/node_modules/algoliasearch/src/server/builds/node.js:83:23&lt;span class="o">)&lt;/span>
at algoliasearch &lt;span class="o">(&lt;/span>/usr/local/lib/node_modules/hugo-algolia/node_modules/algoliasearch/src/server/builds/node.js:68:10&lt;span class="o">)&lt;/span>
at HugoAlgolia.HugoAlgolia.sendIndex &lt;span class="o">(&lt;/span>/usr/local/lib/node_modules/hugo-algolia/lib/index.js:184:20&lt;span class="o">)&lt;/span>
at HugoAlgolia.HugoAlgolia.index &lt;span class="o">(&lt;/span>/usr/local/lib/node_modules/hugo-algolia/lib/index.js:122:12&lt;span class="o">)&lt;/span>
at Object.&amp;lt;anonymous&amp;gt; &lt;span class="o">(&lt;/span>/usr/local/lib/node_modules/hugo-algolia/bin/index.js:23:26&lt;span class="o">)&lt;/span>
at Module._compile &lt;span class="o">(&lt;/span>internal/modules/cjs/loader.js:999:30&lt;span class="o">)&lt;/span>
at Object.Module._extensions..js &lt;span class="o">(&lt;/span>internal/modules/cjs/loader.js:1027:10&lt;span class="o">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Êó†Â•à‰πã‰∏ãÊñ∞Âª∫‰∫Ü‰∏Ä‰∏™ config.yaml&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="nn">---&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">&lt;/span>&lt;span class="nt">baseurl&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;/&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">&lt;/span>&lt;span class="nt">DefaultContentLanguage&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;zh-cn&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">&lt;/span>&lt;span class="nt">hasCJKLanguage&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kc">true&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">&lt;/span>&lt;span class="nt">languageCode&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;zh-cn&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">&lt;/span>&lt;span class="nt">title&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;loomt&amp;#39;s Blog&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">&lt;/span>&lt;span class="nt">theme&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;MeME&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">&lt;/span>&lt;span class="nt">metaDataFormat&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;yaml&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">&lt;/span>&lt;span class="nt">algolia&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">¬† &lt;/span>&lt;span class="nt">index&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;your index&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">¬† &lt;/span>&lt;span class="nt">key&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;your admin key&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">¬† &lt;/span>&lt;span class="nt">appID&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;your appID&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">&lt;/span>&lt;span class="nn">---&lt;/span>&lt;span class="w">
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">$ hugo-algolia -s
JSON index file was created in public/algolia.json
&lt;span class="o">{&lt;/span> updatedAt: &lt;span class="s1">&amp;#39;2023-01-12T14:40:31.454Z&amp;#39;&lt;/span>, taskID: &lt;span class="m">173970040001&lt;/span> &lt;span class="o">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;blockquote>
&lt;p>Áî® Vercel ËøòÊúâ‰∏Ä‰∏™ÂéüÂõ†ÊòØÁôΩÂ´ñÂõΩÂ§ñÁöÑÊúçÂä°Âô®‰∏çÁî®Â§áÊ°àüò≠&lt;/p>
&lt;/blockquote>
&lt;p>&lt;em>reference&lt;/em>&lt;/p>
&lt;p>&lt;a href="https://gohugo.io/getting-started">https://gohugo.io/getting-started&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://blog.aozaki.cc/blog/hugo-deployment-debugging">https://blog.aozaki.cc/blog/hugo-deployment-debugging&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://io-oi.me/tech/hugo-vs-hexo">https://io-oi.me/tech/hugo-vs-hexo&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://github.com/MunifTanjim/minimo/issues/189">https://github.com/MunifTanjim/minimo/issues/189&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://zenlian.github.io/posts/tools/github-actions-hugo">https://zenlian.github.io/posts/tools/github-actions-hugo&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://github.com/peaceiris/actions-gh-pages">https://github.com/peaceiris/actions-gh-pages&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://gohugo.io/content-management/sections">https://gohugo.io/content-management/sections&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://gohugo.io/templates">https://gohugo.io/templates&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://gohugo.io/hugo-pipes">https://gohugo.io/hugo-pipes&lt;/a>&lt;/p></description><category domain="https://loomt.top/posts/">posts</category><category domain="https://loomt.top/tags/github-page/">Github Page</category><category domain="https://loomt.top/tags/%E5%BB%BA%E7%AB%99/">Âª∫Á´ô</category></item></channel></rss>